<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="OpenGLå›¾å½¢å­¦ç¼–ç¨‹åŸºç¡€å­¦ä¹ è®°å½•" />
    <meta name="hexo-theme-A4" content="v1.8.3" />
    <link rel="alternate icon" type="image/webp" href="/images/icon1.webp">
    <title>Fingsinz&#39;s space | é£ä¿¡æ¢“</title>

    
        
<link rel="stylesheet" href="/css/a11y-dark.min.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    
    

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
    
    <style>
        :root {
            --waline-theme-color: #000000; 
            --waline-color: #000000; 
            --waline-border-color: #000000; 
            --waline-white: #000000; 
            --waline-bgcolor-light: white;  
        }
        body {
            color: #000000;
            background: #bed2bb;
        }
        .post-md code {
            background: #e7f7f3;
            color: #7f688d; 
        }
        .year-font-color {
            color: #000000 !important;
        }
        .wl-card span.wl-nick {
            color: #000000; 
        }
        .wl-card .wl-badge {
            border: 1px solid #000000;
            color: #000000; 
        }
        .wl-btn {
            border: 1px solid #000000; 
            color:  #000000;  
        }
        .wl-btn.primary {
            color: white; 
        }
        .wl-header label {
            color: #000000;
        }
        a {
            color: #6b798e;
        }

        .post-md a {
            color: #6b798e;
        }

        .nav li a {
            color: #6b798e;
        }

        .archive-main a:link {
            color: #6b798e;
        }
        .archive-main a:visited {
            color: #6b798e; 
        }

        .archive li span {
            color: #000000;
        }

        .post-main-title {
            color: #000000;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #000000;
        }

        [data-waline] p {
            color: #000000;
        }
        [data-waline] a {
            color: #000000;
        } 
        .wl-sort li.active {
            color: #000000;
        }

        .wl-card .wl-meta>span {
            background: white;
        }

        .paper {
            background: #bed2bb;
        }

        .index-main {
            background: white;
        }

        .paper-main {
            background: white;
        }

        .wl-panel {
            background: white;
        }

        .archive li:nth-child(odd) {
            background: white;
            ;
        }

        .archive li:nth-child(even) {
            background: white;
        }

        .post-md>table tr:nth-child(odd) td {
            background: white;
        }

        .post-md>table tr:nth-child(even) td {
            background: white;
        }

    
        .progress-wrap::after {
            color: #000000; /* ç®­å¤´çš„é¢œè‰² */
        }
        .progress-wrap svg.progress-circle path {
	        stroke: #000000; /* è¾¹æ¡†çš„é¢œè‰² */
        }
        .progress-wrap::before {
	        background-image: linear-gradient(298deg, #6b798e, #6b798e); /* é¼ æ ‡æ»‘è¿‡çš„ç®­å¤´é¢œè‰² */
         }

         .left-toc-container::-webkit-scrollbar-thumb {
            background-color: #000000; /* è®¾ç½®æ»šåŠ¨æ¡æ‹–åŠ¨å—çš„é¢œè‰² */
        }

        .bs-docs-sidebar .nav>.active>a,
        .bs-docs-sidebar .nav>li>a:hover,
        .bs-docs-sidebar .nav>li>a:focus {
            color: #6b798e;
            border-left-color: #6b798e;
        }
        .bs-docs-sidebar .nav>li>a {
            color:  #000000;
        }
    </style>

    
    <body>
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Fingsinz&#39;s space</a> 
            <span class="description">ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆ</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µğŸšï¸</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« ğŸ“„</a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»ğŸ—‚ï¸</a></li>
            
        
            
                <li><a href="/about/">å…³äºğŸ§‘</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            OpenGLå›¾å½¢å­¦ç¼–ç¨‹åŸºç¡€å­¦ä¹ è®°å½•
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%80-opengl%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="post-toc-text">ä¸€ã€OpenGLå®‰è£…ä¸ä½¿ç”¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-1-%E8%AE%A4%E8%AF%86opengl"><span class="post-toc-text">1.1 è®¤è¯†OpenGL</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-2-%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AEopengl"><span class="post-toc-text">1.2 å®‰è£…å’Œé…ç½®OpenGL</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-1-%E5%87%86%E5%A4%87opengl-glsl"><span class="post-toc-text">1.2.1 å‡†å¤‡OpenGL&#x2F;GLSL</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-2-%E5%87%86%E5%A4%87glfw"><span class="post-toc-text">1.2.2 å‡†å¤‡GLFW</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-3-%E5%87%86%E5%A4%87glew"><span class="post-toc-text">1.2.3 å‡†å¤‡GLEW</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-4-%E5%87%86%E5%A4%87glm"><span class="post-toc-text">1.2.4 å‡†å¤‡GLM</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-5-%E5%87%86%E5%A4%87soil2"><span class="post-toc-text">1.2.5 å‡†å¤‡SOIL2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-6-%E5%87%86%E5%A4%87%E5%85%B1%E4%BA%AB%E7%9A%84lib%E5%92%8Cinclude"><span class="post-toc-text">1.2.6 å‡†å¤‡å…±äº«çš„libå’Œinclude</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-3-%E5%9C%A8vs%E4%B8%AD%E9%85%8D%E7%BD%AEopengl%E9%A1%B9%E7%9B%AE"><span class="post-toc-text">1.3 åœ¨VSä¸­é…ç½®OpenGLé¡¹ç›®</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AA%97%E5%8F%A3"><span class="post-toc-text">1.4 åˆ›å»ºä¸€ä¸ªçª—å£</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8C-opengl%E5%9B%BE%E5%83%8F%E7%AE%A1%E7%BA%BF"><span class="post-toc-text">äºŒã€OpenGLå›¾åƒç®¡çº¿</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-%E7%AE%A1%E7%BA%BF"><span class="post-toc-text">2.1 ç®¡çº¿</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-1-1-%E7%AC%AC%E4%B8%80%E4%B8%AAc-opengl%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="post-toc-text">2.1.1 ç¬¬ä¸€ä¸ªC++&#x2F;OpenGLåº”ç”¨ç¨‹åº</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-2-%E9%A1%B6%E7%82%B9%E7%9D%80%E8%89%B2%E5%99%A8%E5%92%8C%E7%89%87%E6%AE%B5%E7%9D%80%E8%89%B2%E5%99%A8"><span class="post-toc-text">2.2 é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-glsl%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5"><span class="post-toc-text">2.3 GLSLä»£ç æ£€æŸ¥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-4-%E8%AE%A9%E5%9B%BE%E5%83%8F%E5%8A%A8%E8%B5%B7%E6%9D%A5"><span class="post-toc-text">2.4 è®©å›¾åƒåŠ¨èµ·æ¥</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%89-opengl%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80"><span class="post-toc-text">ä¸‰ã€OpenGLæ•°å­¦åŸºç¡€</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-1-%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="post-toc-text">3.1 åæ ‡ç³»</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-2-%E7%82%B9"><span class="post-toc-text">3.2 ç‚¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-3-%E5%90%91%E9%87%8F"><span class="post-toc-text">3.3 å‘é‡</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-3-1-%E7%82%B9%E7%A7%AF%E7%9A%84%E5%BA%94%E7%94%A8"><span class="post-toc-text">3.3.1 ç‚¹ç§¯çš„åº”ç”¨</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-3-2-%E5%8F%89%E7%A7%AF%E7%9A%84%E5%BA%94%E7%94%A8"><span class="post-toc-text">3.3.2 å‰ç§¯çš„åº”ç”¨</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-4-%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.4 çŸ©é˜µ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-5-%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.5 å˜æ¢çŸ©é˜µ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-5-1-%E5%B9%B3%E7%A7%BB%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.5.1 å¹³ç§»çŸ©é˜µ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-5-2-%E7%BC%A9%E6%94%BE%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.5.2 ç¼©æ”¾çŸ©é˜µ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-5-3-%E6%97%8B%E8%BD%AC%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.5.3 æ—‹è½¬çŸ©é˜µ</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-6-%E8%A7%86%E8%A7%89%E7%A9%BA%E9%97%B4%E5%92%8C%E5%90%88%E6%88%90%E7%9B%B8%E6%9C%BA"><span class="post-toc-text">3.6 è§†è§‰ç©ºé—´å’Œåˆæˆç›¸æœº</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-7-%E6%8A%95%E5%BD%B1%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.7 æŠ•å½±çŸ©é˜µ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-7-1-%E9%80%8F%E8%A7%86%E6%8A%95%E5%BD%B1%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.7.1 é€è§†æŠ•å½±çŸ©é˜µ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-7-2-%E6%AD%A3%E5%B0%84%E6%8A%95%E5%BD%B1%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.7.2 æ­£å°„æŠ•å½±çŸ©é˜µ</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-8-lookat%E7%9F%A9%E9%98%B5"><span class="post-toc-text">3.8 LookAtçŸ©é˜µ</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%9B%9B-opengl%E7%AE%A1%E7%90%863d%E5%9B%BE%E5%BD%A2%E6%95%B0%E6%8D%AE"><span class="post-toc-text">å››ã€OpenGLç®¡ç†3Då›¾å½¢æ•°æ®</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-1-%E7%BC%93%E5%86%B2%E5%8C%BA%E5%92%8C%E9%A1%B6%E7%82%B9%E5%B1%9E%E6%80%A7"><span class="post-toc-text">4.1 ç¼“å†²åŒºå’Œé¡¶ç‚¹å±æ€§</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-2-%E7%BB%9F%E4%B8%80%E5%8F%98%E9%87%8F"><span class="post-toc-text">4.2 ç»Ÿä¸€å˜é‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-3-%E9%A1%B6%E7%82%B9%E5%B1%9E%E6%80%A7%E6%8F%92%E5%80%BC"><span class="post-toc-text">4.3 é¡¶ç‚¹å±æ€§æ’å€¼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-4-mv-%E7%9F%A9%E9%98%B5%E5%92%8C%E9%80%8F%E8%A7%86%E7%9F%A9%E9%98%B5"><span class="post-toc-text">4.4 MV çŸ©é˜µå’Œé€è§†çŸ©é˜µ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-5-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA-3d-%E7%AB%8B%E6%96%B9%E4%BD%93"><span class="post-toc-text">4.5 æ„å»ºä¸€ä¸ª 3D ç«‹æ–¹ä½“</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-6-%E6%B8%B2%E6%9F%93%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%9A%E4%B8%AA%E5%89%AF%E6%9C%AC"><span class="post-toc-text">4.6 æ¸²æŸ“ä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå‰¯æœ¬</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-7-%E5%90%8C%E4%B8%80%E5%9C%BA%E6%99%AF%E6%B8%B2%E6%9F%93%E5%A4%9A%E4%B8%AA%E5%AF%B9%E8%B1%A1"><span class="post-toc-text">4.7 åŒä¸€åœºæ™¯æ¸²æŸ“å¤šä¸ªå¯¹è±¡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-8-%E7%9F%A9%E9%98%B5%E6%A0%88"><span class="post-toc-text">4.8 çŸ©é˜µæ ˆ</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-9-%E5%BA%94%E5%AF%B9-z%E5%86%B2%E7%AA%81-%E4%BC%AA%E5%BD%B1"><span class="post-toc-text">4.9 åº”å¯¹â€œZå†²çªâ€ä¼ªå½±</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-10-%E5%85%B6%E4%BB%96%E5%9B%BE%E5%85%83"><span class="post-toc-text">4.10 å…¶ä»–å›¾å…ƒ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-10-1-%E4%B8%89%E8%A7%92%E5%BD%A2%E5%9B%BE%E5%85%83"><span class="post-toc-text">4.10.1 ä¸‰è§’å½¢å›¾å…ƒ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-10-2-%E7%BA%BF%E5%9B%BE%E5%85%83"><span class="post-toc-text">4.10.2 çº¿å›¾å…ƒ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-10-3-%E7%82%B9%E5%9B%BE%E5%85%83"><span class="post-toc-text">4.10.3 ç‚¹å›¾å…ƒ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%A1%A5%E4%B8%81%E5%9B%BE%E5%85%83"><span class="post-toc-text">è¡¥ä¸å›¾å…ƒ</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-11-%E6%80%A7%E8%83%BD%E4%BC%98%E5%85%88%E7%BC%96%E7%A8%8B"><span class="post-toc-text">4.11 æ€§èƒ½ä¼˜å…ˆç¼–ç¨‹</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%94-%E7%BA%B9%E7%90%86%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">äº”ã€çº¹ç†è´´å›¾</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-1-%E5%8A%A0%E8%BD%BD%E7%BA%B9%E7%90%86%E5%9B%BE%E5%83%8F%E6%96%87%E4%BB%B6"><span class="post-toc-text">5.1 åŠ è½½çº¹ç†å›¾åƒæ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-2-%E7%BA%B9%E7%90%86%E5%9D%90%E6%A0%87"><span class="post-toc-text">5.2 çº¹ç†åæ ‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-3-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B8%A6%E7%BA%B9%E7%90%86%E7%9A%84%E5%9B%9B%E6%A3%B1%E9%94%A5"><span class="post-toc-text">5.3 æ„å»ºä¸€ä¸ªå¸¦çº¹ç†çš„å››æ£±é”¥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-4-%E5%A4%9A%E7%BA%A7%E6%B8%90%E8%BF%9C%E7%BA%B9%E7%90%86%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">5.4 å¤šçº§æ¸è¿œçº¹ç†è´´å›¾</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-5-%E5%90%84%E5%90%91%E5%BC%82%E6%80%A7%E8%BF%87%E6%BB%A4"><span class="post-toc-text">5.5 å„å‘å¼‚æ€§è¿‡æ»¤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-6-%E7%8E%AF%E7%BB%95%E5%92%8C%E5%B9%B3%E9%93%BA"><span class="post-toc-text">5.6 ç¯ç»•å’Œå¹³é“º</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-7-%E9%80%8F%E8%A7%86%E5%8F%98%E5%BD%A2"><span class="post-toc-text">5.7 é€è§†å˜å½¢</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-8-%E6%9D%90%E8%B4%A8%E7%9A%84%E6%9B%B4%E5%A4%9A%E7%BB%86%E8%8A%82"><span class="post-toc-text">5.8 æè´¨çš„æ›´å¤šç»†èŠ‚</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%85%AD-3d%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">å…­ã€3Dæ¨¡å‹</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6-1-%E7%A8%8B%E5%BA%8F%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">6.1 ç¨‹åºæ„å»ºæ¨¡å‹</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6-1-1-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%90%83%E4%BD%93"><span class="post-toc-text">6.1.1 æ„å»ºä¸€ä¸ªçƒä½“</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6-1-2-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%8E%AF%E9%9D%A2"><span class="post-toc-text">6.1.2 æ„å»ºä¸€ä¸ªç¯é¢</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6-2-%E5%8A%A0%E8%BD%BD%E5%A4%96%E9%83%A8%E6%9E%84%E5%BB%BA%E7%9A%84%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">6.2 åŠ è½½å¤–éƒ¨æ„å»ºçš„æ¨¡å‹</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%83-%E5%85%89%E7%85%A7"><span class="post-toc-text">ä¸ƒã€å…‰ç…§</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-1-%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B"><span class="post-toc-text">7.1 å…‰ç…§æ¨¡å‹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-2-%E5%85%89%E6%BA%90"><span class="post-toc-text">7.2 å…‰æº</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-3-%E6%9D%90%E8%B4%A8"><span class="post-toc-text">7.3 æè´¨</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-4-ads%E5%85%89%E7%85%A7%E8%AE%A1%E7%AE%97"><span class="post-toc-text">7.4 ADSå…‰ç…§è®¡ç®—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-5-%E5%AE%9E%E7%8E%B0ads%E5%85%89%E7%85%A7"><span class="post-toc-text">7.5 å®ç°ADSå…‰ç…§</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#7-5-1-gouraud-%E7%9D%80%E8%89%B2"><span class="post-toc-text">7.5.1 Gouraud ç€è‰²</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#7-5-2-phong-%E7%9D%80%E8%89%B2"><span class="post-toc-text">7.5.2 Phong ç€è‰²</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-6-%E7%BB%93%E5%90%88%E5%85%89%E7%85%A7%E5%92%8C%E7%BA%B9%E7%90%86"><span class="post-toc-text">7.6 ç»“åˆå…‰ç…§å’Œçº¹ç†</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%85%AB-%E9%98%B4%E5%BD%B1"><span class="post-toc-text">å…«ã€é˜´å½±</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8-1-%E6%8A%95%E5%BD%B1%E9%98%B4%E5%BD%B1"><span class="post-toc-text">8.1 æŠ•å½±é˜´å½±</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8-2-%E9%98%B4%E5%BD%B1%E4%BD%93"><span class="post-toc-text">8.2 é˜´å½±ä½“</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8-3-%E9%98%B4%E5%BD%B1%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">8.3 é˜´å½±è´´å›¾</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#8-3-1-%E7%AC%AC%E4%B8%80%E8%BD%AE-%E4%BB%8E%E5%85%89%E6%BA%90%E4%BD%8D%E7%BD%AE%E7%BB%98%E5%88%B6"><span class="post-toc-text">8.3.1 ç¬¬ä¸€è½®â€”â€”ä»å…‰æºä½ç½®ç»˜åˆ¶</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#8-3-2-%E5%B0%86%E6%B7%B1%E5%BA%A6%E7%BC%93%E5%86%B2%E5%8C%BA%E5%A4%8D%E5%88%B6%E5%88%B0%E7%BA%B9%E7%90%86"><span class="post-toc-text">8.3.2 å°†æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°çº¹ç†</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#8-3-3-%E7%AC%AC%E4%BA%8C%E8%BD%AE-%E4%BB%8E%E7%9B%B8%E6%9C%BA%E4%BD%8D%E7%BD%AE%E7%BB%98%E5%88%B6"><span class="post-toc-text">8.3.3 ç¬¬äºŒè½®â€”â€”ä»ç›¸æœºä½ç½®ç»˜åˆ¶</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8-4-%E6%9F%94%E5%92%8C%E9%98%B4%E5%BD%B1"><span class="post-toc-text">8.4 æŸ”å’Œé˜´å½±</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B9%9D-%E5%A4%A9%E7%A9%BA%E5%92%8C%E8%83%8C%E6%99%AF"><span class="post-toc-text">ä¹ã€å¤©ç©ºå’ŒèƒŒæ™¯</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#9-1-%E5%A4%A9%E7%A9%BA%E7%9B%92"><span class="post-toc-text">9.1 å¤©ç©ºç›’</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#9-2-%E7%A9%B9%E9%A1%B6"><span class="post-toc-text">9.2 ç©¹é¡¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#9-3-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E7%A9%BA%E7%9B%92"><span class="post-toc-text">9.3 å®ç°å¤©ç©ºç›’</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#9-3-1-%E4%BB%8E%E5%A4%B4%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA%E5%A4%A9%E7%A9%BA%E7%9B%92"><span class="post-toc-text">9.3.1 ä»å¤´å¼€å§‹æ„å»ºå¤©ç©ºç›’</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#9-3-2-%E4%BD%BF%E7%94%A8opengl%E7%AB%8B%E6%96%B9%E4%BD%93%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">9.3.2 ä½¿ç”¨OpenGLç«‹æ–¹ä½“è´´å›¾</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#9-4-%E7%8E%AF%E5%A2%83%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">9.4 ç¯å¢ƒè´´å›¾</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8D%81-%E5%A2%9E%E5%BC%BA%E8%A1%A8%E9%9D%A2%E7%BB%86%E8%8A%82"><span class="post-toc-text">åã€å¢å¼ºè¡¨é¢ç»†èŠ‚</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#10-1-%E5%87%B9%E5%87%B8%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">10.1 å‡¹å‡¸è´´å›¾</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#10-2-%E6%B3%95%E7%BA%BF%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">10.2 æ³•çº¿è´´å›¾</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#10-3-%E9%AB%98%E5%BA%A6%E8%B4%B4%E5%9B%BE"><span class="post-toc-text">10.3 é«˜åº¦è´´å›¾</span></a></li></ol></li></ol>
            
        
        <p>å…³é”®è¯ï¼šC++ã€OpenGL</p>
<span id="more"></span>
<hr>
<h2 id="ä¸€-openglå®‰è£…ä¸ä½¿ç”¨">ä¸€ã€OpenGLå®‰è£…ä¸ä½¿ç”¨</h2>
<p><em>Referenceï¼šè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆä½¿ç”¨OpenGLå’ŒC++ï¼‰ï¼ˆç¬¬2ç‰ˆï¼‰</em></p>
<h3 id="1-1-è®¤è¯†opengl">1.1 è®¤è¯†OpenGL</h3>
<p>åœ¨ C++ä¸­ä½¿ç”¨ OpenGL éœ€è¦é…ç½®å¤šä¸ªåº“ã€‚æ­¤å¤„ï¼Œä½¿ç”¨åˆ°ï¼š</p>
<ul>
<li>
<p>C++å¼€å‘ç¯å¢ƒï¼›</p>
</li>
<li>
<p>OpenGL / GLSLï¼š2004 å¹´ï¼Œ2.0 ç‰ˆæœ¬ä¸­å¼•å…¥äº† OpenGL ç€è‰²è¯­è¨€ GLSLï¼Œä½¿å¾—â€œç€è‰²å™¨ç¨‹åºâ€å¯ä»¥è¢«ç›´æ¥å®‰è£…åˆ°å›¾å½¢ç®¡çº¿çš„å„ä¸ªé˜¶æ®µå¹¶æ‰§è¡Œï¼›</p>
</li>
<li>
<p>çª—å£ç®¡ç†åº“ï¼šOpenGLä¼šå°†å›¾åƒæ¸²æŸ“åˆ°ä¸€ä¸ªå¸§ç¼“å†²åŒºï¼Œç„¶åç”±è®¡ç®—æœºå°†å¸§ç¼“å†²åŒºçš„å†…å®¹ç»˜åˆ¶åˆ°å±å¹•çš„çª—å£ä¸­ï¼ŒGLFW åº“æ˜¯æœ€æµè¡Œçš„é€‰æ‹©ä¹‹ä¸€ã€‚</p>
</li>
<li>
<p>æ‰©å±•åº“ï¼šå¸¸ç”¨å¦‚ GLEW åº“ï¼›</p>
</li>
<li>
<p>æ•°å­¦åº“ï¼š3D å›¾å½¢ç¼–ç¨‹ä¼šå¤§é‡ä½¿ç”¨å‘é‡å’ŒçŸ©é˜µä»£æ•°ï¼Œå¯ä½¿ç”¨ OpenGL Mathematicsï¼ˆGLMï¼‰åº“ã€ Eigen åº“æˆ– vmath åº“ï¼›</p>
</li>
<li>
<p>çº¹ç†å›¾åƒåŠ è½½åº“ï¼šæ¯”å¦‚ FreeImageã€DevILã€GLIã€Glraw å’Œ SOILã€‚</p>
</li>
</ul>
<h3 id="1-2-å®‰è£…å’Œé…ç½®opengl">1.2 å®‰è£…å’Œé…ç½®OpenGL</h3>
<p><em>åŸºäºVisual Studio 2022è¿›è¡Œ</em></p>
<h4 id="1-2-1-å‡†å¤‡opengl-glsl">1.2.1 å‡†å¤‡OpenGL/GLSL</h4>
<ul>
<li>äº†è§£è®¡ç®—æœºæ”¯æŒä»€ä¹ˆç‰ˆæœ¬çš„OpenGLï¼Œå¯ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://www.realtech-vr.com/home/?page_id=1402">GLView</a> æŸ¥çœ‹ã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_OpenGLversion.jpg" alt="OpenGLç‰ˆæœ¬"></p>
<h4 id="1-2-2-å‡†å¤‡glfw">1.2.2 å‡†å¤‡GLFW</h4>
<ol>
<li>ä¸‹è½½ GLFW æºä»£ç ï¼Œ<a target="_blank" rel="noopener" href="https://www.glfw.org/">ä¸‹è½½åœ°å€</a></li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_glfwfiles.jpg" alt="GLFWæ–‡ä»¶"></p>
<ol start="2">
<li>ä½¿ç”¨ CMake è¿›è¡Œç¼–è¯‘æºç </li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_glfwbuild.jpg" alt="ç¼–è¯‘GLFW"></p>
<p>æ¥ç€æ‰¾åˆ° GLFW.slnï¼Œä½¿ç”¨VSæ‰“å¼€å¹¶ç¼–è¯‘ä¸º64ä½åº”ç”¨ç¨‹åºã€‚</p>
<ol start="3">
<li>æ„å»ºå®Œæˆåå¾—åˆ°ä¸‹é¢ä¸¤ä¸ªå†…å®¹ï¼šlibé™æ€åº“æ–‡ä»¶å’Œincludeæ–‡ä»¶å¤¹</li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs%2Fopengl_glfwlib.jpg" alt="é™æ€åº“"></p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs%2Fopengl_glfwinclude.jpg" alt="include"></p>
<h4 id="1-2-3-å‡†å¤‡glew">1.2.3 å‡†å¤‡GLEW</h4>
<p>ä¸‹è½½ GLEW çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œ<a target="_blank" rel="noopener" href="https://glew.sourceforge.net/">ä¸‹è½½åœ°å€</a>ã€‚è§£å‹åå†…æœ‰åº“æ–‡ä»¶å’Œå¤´æ–‡ä»¶ç­‰ã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_glew.jpg" alt="GLEWæ–‡ä»¶å¤¹"></p>
<h4 id="1-2-4-å‡†å¤‡glm">1.2.4 å‡†å¤‡GLM</h4>
<p>ä¸‹è½½ GLM å‹ç¼©åŒ…ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/g-truc/glm/releases">ä¸‹è½½åœ°å€</a>ï¼Œè§£å‹åå³å¯ã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_glm.jpg" alt="GLM"></p>
<h4 id="1-2-5-å‡†å¤‡soil2">1.2.5 å‡†å¤‡SOIL2</h4>
<ol>
<li>
<p>ä¸‹è½½å¹¶è§£å‹ <a target="_blank" rel="noopener" href="https://premake.github.io/">premake</a>ï¼ŒåŒ…å« premake5.exeã€‚</p>
</li>
<li>
<p>ä¸‹è½½ SOIL2 çš„æºç ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/SpartanJ/SOIL2/tags">ä¸‹è½½åœ°å€</a>ï¼Œè§£å‹ã€‚</p>
</li>
<li>
<p>å°† premake5.exe å¤åˆ¶åˆ° soil2 ç›®å½•ä¸‹ã€‚</p>
</li>
<li>
<p>åœ¨ soil2 ç›®å½•ä¸‹ä½¿ç”¨cmdï¼Œè¿è¡Œå‘½ä»¤ï¼š</p>
</li>
</ol>
<pre><code class="language-cmd">premake5 vs2022
</code></pre>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_premake.jpg" alt="è¿è¡Œå‘½ä»¤"></p>
<ol start="5">
<li>æ‰“å¼€ make/windows æ–‡ä»¶å¤¹çš„ SOIL2.sln æ–‡ä»¶ï¼Œå³é”® soil2-static-lib åœ¨ x64 ä¸‹é€‰æ‹©è¿›è¡Œç”Ÿæˆã€‚</li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_soil2.jpg" alt="ç”Ÿæˆæ–‡ä»¶"></p>
<h4 id="1-2-6-å‡†å¤‡å…±äº«çš„libå’Œinclude">1.2.6 å‡†å¤‡å…±äº«çš„libå’Œinclude</h4>
<p>é€‰æ‹©åˆé€‚çš„ä½ç½®åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶è®¾ç½® lib å’Œ include å­æ–‡ä»¶å¤¹ã€‚</p>
<ul>
<li>
<p>åœ¨ lib æ–‡ä»¶å¤¹ä¸­æ”¾å…¥ glew32.libã€glfw3.lib å’Œ soil2-debug.libã€‚</p>
</li>
<li>
<p>åœ¨ include æ–‡ä»¶å¤¹ä¸­æ”¾å…¥ GLEW çš„ GL æ–‡ä»¶å¤¹ã€GLFW æ–‡ä»¶å¤¹ã€glm æ–‡ä»¶å¤¹ å’Œ SOIL2-1.3.0/src çš„ SOIL2 æ–‡ä»¶å¤¹ã€‚</p>
</li>
<li>
<p>åœ¨å½“å‰æ–‡ä»¶å¤¹æ”¾å…¥ glew32.dll</p>
</li>
</ul>
<p>æ–‡ä»¶ç»“æ„å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_openglstructure.jpg" alt="å…±äº«æ–‡ä»¶å¤¹ç»“æ„"></p>
<h3 id="1-3-åœ¨vsä¸­é…ç½®openglé¡¹ç›®">1.3 åœ¨VSä¸­é…ç½®OpenGLé¡¹ç›®</h3>
<p><em>åˆ›å»º VS è‡ªå®šä¹‰é¡¹ç›®æ¨¡æ¿</em></p>
<ol>
<li>
<p>å¯åŠ¨ VSï¼Œ åˆ›å»ºç©ºç™½é¡¹ç›®ï¼Œé€‰æ‹© x64ã€‚</p>
</li>
<li>
<p>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œè¿›å…¥â€œé¡¹ç›®å±æ€§â€ï¼Œåœ¨â€œVC++â€ç›®å½•ä¸‹çš„åŒ…å«ç›®å½•æ·»åŠ ä¸Šå…±äº«æ–‡ä»¶å¤¹çš„ include æ–‡ä»¶å¤¹ï¼›åœ¨â€œé“¾æ¥å™¨â€ä¸‹ï¼Œâ€œå¸¸è§„-&gt;é™„åŠ åº“ç›®å½•â€ï¼ˆæˆ–â€œVC+Â±&gt;åº“ç›®å½•â€ï¼‰æ·»åŠ ä¸Šå…±äº«æ–‡ä»¶å¤¹çš„ lib æ–‡ä»¶å¤¹ï¼Œâ€œè¾“å…¥-&gt;é™„åŠ ä¾èµ–é¡¹â€æ·»åŠ ä»¥ä¸‹æ–‡ä»¶åï¼š <code>glfw3.lib</code>ã€<code>glew32.lib</code>ã€<code>soil2-debug.lib</code> å’Œ <code>opengl32.lib</code>ã€‚</p>
</li>
<li>
<p>åœ¨ Release æ¨¡å¼ä¸‹ï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ã€‚</p>
</li>
<li>
<p>â€œé¡¹ç›®-&gt;å¯¼å‡ºæ¨¡æ¿â€ï¼Œé€‰æ‹©é¡¹ç›®æ¨¡æ¿ï¼Œå‘½åè‡ªå®šä¹‰ï¼Œæ­¤å¤„ä¸ºâ€œOpenGL projectâ€ã€‚</p>
</li>
</ol>
<p>åˆ›å»º OpenGL C++ é¡¹ç›®æ—¶ï¼Œå¯åŠ¨ VS æ—¶ï¼Œç‚¹å‡»â€œæ–°å»ºé¡¹ç›®â€ï¼Œåœ¨å·¦ä¸Šæ–¹é€‰æ‹© OpenGL æ¨¡æ¿å³å¯ä½¿ç”¨ã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_template.jpg" alt="ä½¿ç”¨æ¨¡æ¿åˆ›å»ºé¡¹ç›®"></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ–°å»ºOpenGL C++é¡¹ç›®æ—¶ï¼Œéœ€è¦æŠŠ <code>glew32.dll</code> æ”¾åˆ°é¡¹ç›®ç›®å½•ä¸‹ã€‚</p>
<h3 id="1-4-åˆ›å»ºä¸€ä¸ªçª—å£">1.4 åˆ›å»ºä¸€ä¸ªçª—å£</h3>
<p>è¿™éƒ¨åˆ†å¯ä»¥ç”¨æ¥æµ‹è¯•ä¸Šé¢çš„é…ç½®æ˜¯å¦æˆåŠŸã€‚ä¸‹é¢ç»™å‡ºä¸€ä¸ª OpenGL C++ åˆ›å»ºçª—å£çš„ä»£ç ï¼š</p>
<details><summary>å±•å¼€ä»£ç </summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;

// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

GLFWwindow *window;
using namespace glm;

int main()
{
    // åˆå§‹åŒ– GLFW
    if (!glfwInit())
    {
        return -1;
    }

    glfwWindowHint(GLFW_SAMPLES, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);
    glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE); // MacOS ä¸éœ€è¦
    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);

    // æ‰“å¼€ä¸€ä¸ªçª—å£å¹¶åˆ›å»ºå®ƒçš„OpenGLä¸Šä¸‹æ–‡
    window = glfwCreateWindow(1024, 768, "New Window", NULL, NULL);
    if (window == NULL)
    {
        glfwTerminate();
        return -1;
    }
    glfwMakeContextCurrent(window);

    // åˆå§‹åŒ– GLEW
    if (glewInit() != GLEW_OK)
    {
        glfwTerminate();
        return -1;
    }

    // ç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä¸‹é¢æŒ‰ä¸‹çš„è½¬ä¹‰é”®
    glfwSetInputMode(window, GLFW_STICKY_KEYS, GL_TRUE);

    // è“è‰²èƒŒæ™¯
    glClearColor(0.0f, 1.0f, 0.0f, 0.0f);

    do
    {
        // æ¸…é™¤å±å¹•
        glClear(GL_COLOR_BUFFER_BIT);

        // äº¤æ¢ç¼“å†²åŒº
        glfwSwapBuffers(window);
        glfwPollEvents();
    } while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS &amp;&amp; glfwWindowShouldClose(window) == 0); // æ£€æŸ¥æ˜¯å¦æŒ‰ä¸‹äº†ESCé”®æˆ–çª—å£å·²å…³é—­

    // å…³é—­OpenGLçª—å£å¹¶ç»ˆæ­¢GLFW
    glfwTerminate();
    return 0;
}
</code></pre>
</details>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/opengl_newwindow.jpg" alt="è¿è¡Œç»“æœ"></p>
<h2 id="äºŒ-openglå›¾åƒç®¡çº¿">äºŒã€OpenGLå›¾åƒç®¡çº¿</h2>
<p>C++/OpenGL åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªé‡è¦ä»»åŠ¡æ˜¯è®©ç¨‹åºå‘˜çš„ GLSL ä»£ç è¿è¡Œäº GPU ä¸Šã€‚</p>
<p>OpenGL æä¾›äº†ä¸€ä¸ªå¤šçº§å›¾å½¢ç®¡çº¿ï¼Œå¯ä»¥ä½¿ç”¨ GLSL è¯­è¨€è¿›è¡Œéƒ¨åˆ†ç¼–ç¨‹ã€‚GLSL æ˜¯ä¸€ç§ç€è‰²å™¨è¯­è¨€ã€‚ç€è‰²å™¨è¯­è¨€ä¸»è¦è¿è¡Œäº GPU ä¸Šï¼Œåœ¨å›¾å½¢ç®¡çº¿ä¸Šä¸‹æ–‡ä¸­ã€‚</p>
<h3 id="2-1-ç®¡çº¿">2.1 ç®¡çº¿</h3>
<p>OpenGL å›¾åƒç®¡çº¿æ˜¯ OpenGL çš„æ ¸å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªå›¾åƒå¤„ç†çš„ç®¡çº¿ã€‚å›¾åƒç®¡çº¿çš„å·¥ä½œåŸç†æ˜¯å°†å›¾åƒæ•°æ®ä»åŸå§‹çš„çº¹ç†ä¸­æ¸²æŸ“åˆ°å±å¹•ä¸Šã€‚</p>
<p>3D å›¾å½¢ç¼–ç¨‹ä¼šä½¿ç”¨ç®¡çº¿çš„æ¦‚å¿µï¼Œåœ¨ç®¡çº¿ä¸­ï¼Œå°† 3D åœºæ™¯è½¬æ¢æˆ  2D å›¾å½¢çš„è¿‡ç¨‹è¢«åˆ†å‰²æˆè®¸å¤šæ­¥éª¤ã€‚</p>
<p>C++/OpenGL åº”ç”¨ç¨‹åºå‘é€å›¾å½¢æ•°æ®åˆ°é¡¶ç‚¹ç€è‰²å™¨ï¼Œéšç€ç®¡çº¿å¤„ç†ï¼Œæœ€ç»ˆç”Ÿæˆåœ¨æ˜¾ç¤ºå™¨ä¸Šæ˜¾ç¤ºçš„åƒç´ ç‚¹ã€‚</p>
<h4 id="2-1-1-ç¬¬ä¸€ä¸ªc-openglåº”ç”¨ç¨‹åº">2.1.1 ç¬¬ä¸€ä¸ªC++/OpenGLåº”ç”¨ç¨‹åº</h4>
<p><em>å³è¯¦ç»†è§£é‡Šä¹‹å‰çš„åˆ›å»ºçª—å£ä»£ç </em></p>
<p>è¯¥ç¨‹åºå°†ä¼šä½¿ç”¨ä¸€äº›æ‰©å±•åº“ï¼šGLEWã€GLMã€SOIL2 å’Œ GLFWã€‚</p>
<ul>
<li>GLFW åº“æä¾›äº† GLFWwindow ç±»ï¼Œå¯åœ¨å…¶ä¸Šè¿›è¡Œ3Dåœºæ™¯ç»˜åˆ¶ã€‚</li>
</ul>
<p>è¯¥ç¨‹åºçš„å¤§æ¦‚æ“ä½œæœ‰ï¼š</p>
<ol>
<li>åˆå§‹åŒ– GLFW</li>
</ol>
<pre><code class="language-cpp">// åˆå§‹åŒ– GLFW
if (!glfwInit())
{
    return -1;
}
</code></pre>
<ol start="2">
<li>åˆ›å»ºçª—å£çš„è®¾ç½®</li>
</ol>
<pre><code class="language-cpp">glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
// WindowHint æŒ‡å®šäº†è®¡ç®—æœºå¿…é¡»ä¸ OpenGL ç‰ˆæœ¬ 4.6 å…¼å®¹ï¼ˆä¸»ç‰ˆæœ¬å·ä¸º 4ï¼Œæ¬¡ç‰ˆæœ¬å·ä¸º 6ï¼‰ã€‚
</code></pre>
<ol start="3">
<li>åˆ›å»ºä¸€ä¸ª GLFWwindow å®ä¾‹å¹¶åˆ›å»ºçª—å£</li>
</ol>
<pre><code class="language-cpp">GLFWwindow *window = glfwCreateWindow(1024, 768, "New Window", NULL, NULL);
if (window == NULL)
{
    glfwTerminate();
    return -1;
}
// glfwCreateWindow å‘½ä»¤çš„å‚æ•°æŒ‡å®šäº†çª—å£çš„å®½ã€é«˜ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ä»¥åŠçª—å£é¡¶éƒ¨çš„æ ‡é¢˜ï¼Œåä¸¤ä¸ªNULLåˆ†åˆ«ç”¨æ¥æ§åˆ¶å…¨å±æ˜¾ç¤ºå’Œèµ„æºå…±äº«ï¼‰
// åˆ›å»ºä¸€ä¸ªæ–°çª—å£ï¼Œå¤§å°ä¸º1024Ã—768ï¼Œçª—å£åä¸ºâ€œNew Windowâ€

glfwMakeContextCurrent(window);
// åˆ›å»º GLFW çª—å£å¹¶ä¸ä¼šè‡ªåŠ¨å°†å®ƒä¸å½“å‰ OpenGL ä¸Šä¸‹æ–‡å…³è”èµ·æ¥ï¼Œå› æ­¤éœ€è¦è°ƒç”¨ glfwMakeContextCurrent()ã€‚
</code></pre>
<ol start="4">
<li>è®¾ç½®çª—å£å±æ€§</li>
</ol>
<pre><code class="language-cpp">// ç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä¸‹é¢æŒ‰ä¸‹çš„è½¬ä¹‰é”®
glfwSetInputMode(window, GLFW_STICKY_KEYS, GL_TRUE);

// è®¾ç½®ç»¿è‰²èƒŒæ™¯ï¼Œå››ä¸ªå‚æ•°åˆ†åˆ«ä¸ºRGBAã€‚
// glClearColor()èƒ½å¤ŸæŒ‡å®šé¢œè‰²ç¼“å†²åŒºæ¸…é™¤åå¡«å……çš„å€¼
glClearColor(0.0f, 1.0f, 0.0f, 0.0f);
</code></pre>
<ol start="5">
<li>åˆå§‹åŒ– GLEW åº“</li>
</ol>
<pre><code class="language-cpp">// åˆå§‹åŒ– GLEW
if (glewInit() != GLEW_OK)
{
    glfwTerminate();
    return -1;
}
</code></pre>
<ol start="6">
<li>å¾ªç¯æ˜¾ç¤ºçª—å£</li>
</ol>
<pre><code class="language-cpp">do
{
    // æ¸…é™¤å±å¹•ï¼Œé‡ç½®ç¼“å†²åŒºæ—¶å¡«å……çš„é¢œè‰²
    glClear(GL_COLOR_BUFFER_BIT);

    // äº¤æ¢ç¼“å†²åŒºï¼Œç»˜åˆ¶å±å¹•
    glfwSwapBuffers(window);
    // å¤„ç†çª—å£ç›¸å…³äº‹ä»¶ï¼ˆå¦‚æŒ‰é”®äº‹ä»¶ï¼‰
    glfwPollEvents();
} while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS &amp;&amp; glfwWindowShouldClose(window) == 0); // æ£€æŸ¥æ˜¯å¦æŒ‰ä¸‹äº†ESCé”®æˆ–çª—å£å·²å…³é—­
</code></pre>
<ol start="7">
<li>é€€å‡ºç¨‹åº</li>
</ol>
<pre><code class="language-cpp">// å…³é—­OpenGLçª—å£å¹¶ç»ˆæ­¢GLFW
glfwDestroyWindow(window);
glfwTerminate();
</code></pre>
<details><summary>å®Œæ•´ç¨‹åº</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;

// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

using namespace glm;

int main()
{
    // åˆå§‹åŒ– GLFW
    if (!glfwInit())
    {
        return -1;
    }

    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);

    // æ‰“å¼€ä¸€ä¸ªçª—å£å¹¶åˆ›å»ºå®ƒçš„OpenGLä¸Šä¸‹æ–‡
    GLFWwindow *window = glfwCreateWindow(1024, 768, "New Window", NULL, NULL);
    if (window == NULL)
    {
        glfwTerminate();
        return -1;
    }

    glfwMakeContextCurrent(window);

    // ç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä¸‹é¢æŒ‰ä¸‹çš„è½¬ä¹‰é”®
    glfwSetInputMode(window, GLFW_STICKY_KEYS, GL_TRUE);

    // ç»¿è‰²èƒŒæ™¯
    glClearColor(0.0f, 1.0f, 0.0f, 0.0f);

    // åˆå§‹åŒ– GLEW
    if (glewInit() != GLEW_OK)
    {
        glfwTerminate();
        return -1;
    }

    do
    {
        // æ¸…é™¤å±å¹•
        glClear(GL_COLOR_BUFFER_BIT);

        // äº¤æ¢ç¼“å†²åŒº
        glfwSwapBuffers(window);
        glfwPollEvents();
    } while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS &amp;&amp; glfwWindowShouldClose(window) == 0); // æ£€æŸ¥æ˜¯å¦æŒ‰ä¸‹äº†ESCé”®æˆ–çª—å£å·²å…³é—­

    // å…³é—­OpenGLçª—å£å¹¶ç»ˆæ­¢GLFW
    glfwDestroyWindow(window);
    glfwTerminate();
    return 0;
}
</code></pre>
</details>
<h3 id="2-2-é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨">2.2 é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</h3>
<p>å¤šæ•° 3D æ¨¡å‹é€šå¸¸ç”±å¤šä¸ªä¸‰è§’å½¢å›¾å…ƒæ„æˆã€‚å¦‚ç‚¹ã€çº¿ã€ä¸‰è§’å½¢è¿™äº›ç®€å•çš„å›¾å½¢ç§°ä½œå›¾å…ƒã€‚</p>
<p>å›¾å…ƒç”±é¡¶ç‚¹ç»„æˆã€‚</p>
<p>åœ¨åŠ è½½é¡¶ç‚¹ä¹‹å‰ï¼ŒC++/OpenGL åº”ç”¨ç¨‹åºå¿…é¡»ç¼–è¯‘å¹¶é“¾æ¥åˆé€‚çš„ GLSL é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨ç¨‹åºï¼Œä¹‹åå°†å®ƒä»¬è½½å…¥ç®¡çº¿ã€‚</p>
<p>æ¯”å¦‚ç»˜ç”»ä¸‰è§’å½¢æ—¶ï¼Œå¯ä»¥é€šè¿‡è¯¥å‡½æ•°å®ç°ï¼š</p>
<pre><code class="language-cpp">glDrawArrays(GLenum mode, Glint first, Glsizei count);
</code></pre>
<ul>
<li>
<p>modeï¼šè¡¨ç¤ºå›¾å…ƒçš„ç±»å‹ï¼›</p>
</li>
<li>
<p>firstï¼šè¡¨ç¤ºä»å“ªä¸ªé¡¶ç‚¹å¼€å§‹ç»˜åˆ¶ï¼›</p>
</li>
<li>
<p>countï¼šè¡¨ç¤ºç»˜åˆ¶çš„é¡¶ç‚¹æ•°ã€‚</p>
</li>
</ul>
<p>ä»¥ç»˜ç”»ä¸‰è§’å½¢ä¸ºä¾‹å­ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p><em>æ³¨ï¼š <code>GLuint</code> æ˜¯ OpenGL æä¾›çš„ <code>unsigned int</code></em></p>
<ol>
<li>
<p>åˆå§‹åŒ–é˜¶æ®µï¼Œå¯¹ GLFW å’Œ GLEW åº“è¿›è¡Œåˆå§‹åŒ–ï¼ŒåŒæ—¶åˆ›å»ºçª—å£ï¼›</p>
</li>
<li>
<p>åˆ›å»ºé¡¶ç‚¹æ•°ç»„å¯¹è±¡VAOå’Œç¼“å­˜åŒºï¼›</p>
</li>
</ol>
<pre><code class="language-cpp">// åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼Œå¹¶å°†å®ƒè®¾ä¸ºå½“å‰å¯¹è±¡
GLuint VertexArrayID;
glGenVertexArrays(1, &amp;VertexArrayID);
glBindVertexArray(VertexArrayID);

// ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼š(-1,-1,0),(1,-1,0),(0,1,0)
static const GLfloat g_vertex_buffer_data[] = {
    -1.0f, -1.0f, 0.0f,
     1.0f, -1.0f, 0.0f,
     0.0f,  1.0f, 0.0f };

// åˆ›å»ºç¼“å­˜åŒº
GLuint vertexbuffer; // é¡¶ç‚¹ç¼“å†²åŒºæ ‡è¯†
glGenBuffers(1, &amp;vertexbuffer); // ç”Ÿæˆ1ä¸ªç¼“å†²åŒºï¼Œå°†ç”Ÿæˆçš„æ ‡è¯†ç¬¦æ”¾å…¥é¡¶ç‚¹ç¼“å†²
glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW); // æŠŠè¿™ä¸ªä¸‰è§’å½¢ä¼ ç»™OpenGL
</code></pre>
<ol start="3">
<li>å¾ªç¯ä¸­ç»˜ç”»ä¸‰è§’å½¢</li>
</ol>
<pre><code class="language-cpp">do
{
    glClear(GL_COLOR_BUFFER_BIT);

    glEnableVertexAttribArray(0);    // å¯ç”¨é¡¶ç‚¹æ•°ç»„
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);

    glDrawArrays(GL_TRIANGLES, 0, 3);    // ç»˜åˆ¶ä¸‰è§’å½¢

    glDisableVertexAttribArray(0);    // ç¦ç”¨é¡¶ç‚¹æ•°ç»„

    glfwSwapBuffers(window);    // äº¤æ¢ç¼“å†²åŒºï¼Œæ›´æ–°å±å¹•
    glfwPollEvents();            // ç›‘å¬äº‹ä»¶
} while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS and glfwWindowShouldClose(window) == 0);
</code></pre>
<ol start="4">
<li>åå¤„ç†ï¼Œåˆ é™¤ç”³è¯·çš„èµ„æº</li>
</ol>
<pre><code class="language-cpp">// åå¤„ç†ï¼Œåˆ é™¤èµ„æº
glDeleteBuffers(1, &amp;vertexbuffer);
glDeleteVertexArrays(1, &amp;VertexArrayID);
glfwTerminate();
</code></pre>
<details><summary>å®Œæ•´ä»£ç </summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

int main()
{
    // åˆå§‹åŒ– GLFW
    if (!glfwInit())
    {
        return -1;
    }

    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);

    // æ‰“å¼€ä¸€ä¸ªçª—å£å¹¶åˆ›å»ºå®ƒçš„OpenGLä¸Šä¸‹æ–‡
    GLFWwindow *window = glfwCreateWindow(1024, 768, "triangle", NULL, NULL);
    if (window == NULL)
    {
        glfwTerminate();
        return -1;
    }
    glfwMakeContextCurrent(window);

    // ç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä¸‹é¢æŒ‰ä¸‹çš„è½¬ä¹‰é”®
    glfwSetInputMode(window, GLFW_STICKY_KEYS, GL_TRUE);

    // ç»¿è‰²èƒŒæ™¯
    glClearColor(0.0f, 1.0f, 0.0f, 0.0f);

    // åˆå§‹åŒ– GLEW
    if (glewInit() != GLEW_OK)
    {
        glfwTerminate();
        return -1;
    }

    // åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼Œå¹¶å°†å®ƒè®¾ä¸ºå½“å‰å¯¹è±¡
    GLuint VertexArrayID; // é¡¶ç‚¹æ•°ç»„æ ‡è¯†
    glGenVertexArrays(1, &amp;VertexArrayID);
    glBindVertexArray(VertexArrayID);

    // ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼š(-1,-1,0),(1,-1,0),(0,1,0)
    static const GLfloat g_vertex_buffer_data[] = {
        -1.0f, -1.0f, 0.0f,
         1.0f, -1.0f, 0.0f,
         0.0f,  1.0f, 0.0f };

    // åˆ›å»ºç¼“å­˜åŒº
    GLuint vertexbuffer; // é¡¶ç‚¹ç¼“å†²åŒºæ ‡è¯†
    glGenBuffers(1, &amp;vertexbuffer); // ç”Ÿæˆ1ä¸ªç¼“å†²åŒºï¼Œå°†ç”Ÿæˆçš„æ ‡è¯†ç¬¦æ”¾å…¥é¡¶ç‚¹ç¼“å†²
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW); // æŠŠè¿™ä¸ªä¸‰è§’å½¢ä¼ ç»™OpenGL

    do
    {
        glClear(GL_COLOR_BUFFER_BIT);

        glEnableVertexAttribArray(0);    // å¯ç”¨é¡¶ç‚¹æ•°ç»„å±æ€§
        glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);

        glDrawArrays(GL_TRIANGLES, 0, 3);    // ç»˜åˆ¶ä¸‰è§’å½¢

        glDisableVertexAttribArray(0);    // ç¦ç”¨é¡¶ç‚¹æ•°ç»„å±æ€§

        glfwSwapBuffers(window);    // äº¤æ¢ç¼“å†²åŒºï¼Œæ›´æ–°å±å¹•
        glfwPollEvents();            // ç›‘å¬äº‹ä»¶
    } while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS and glfwWindowShouldClose(window) == 0);

    // åå¤„ç†ï¼Œåˆ é™¤èµ„æº
    glDeleteBuffers(1, &amp;vertexbuffer);
    glDeleteVertexArrays(1, &amp;VertexArrayID);

    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_triangle.jpg" alt="ç»˜ç”»ä¸‰è§’å½¢"></p>
<p>è¿™ä¸ªä¸‰è§’å½¢æ˜¯ç™½è‰²çš„ï¼Œå› ä¸ºå…¶å¹¶æ²¡æœ‰è¿›è¡Œä»»ä½•ç€è‰²ã€‚</p>
<p>ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨å¯ä»¥è¿›è¡Œç€è‰²ã€‚</p>
<details><summary>å®Œæ•´ä»£ç </summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

GLuint createShadeProgram()
{
    // é¡¶ç‚¹ç€è‰²å™¨
    const char *vshaderSource =
        "#version 460 core\n"
        "layout(location = 0) in vec3 vertexPosition_modelspace;\n"
        "void main()\n"
        "{ gl_Position.xyz = vertexPosition_modelspace; gl_Position.w = 1.0; }";

    // ç‰‡æ®µç€è‰²å™¨
    const char *fshaderSource =
        "#version 460 core\n"
        "out vec3 color;\n"
        "void main()\n"
        "{ color = vec3(0, 0, 0.3); }";

    // OpenGL åˆ›å»ºæ¯ä¸ªç€è‰²å™¨å¯¹è±¡ï¼ˆåˆå§‹å€¼ä¸ºç©ºï¼‰çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ªæ•´æ•° ID ä½œä¸ºåé¢å¼•ç”¨å®ƒçš„åºå·
    // åˆ†åˆ«å­˜å…¥ vShader å’Œ fShader å˜é‡
    GLuint vShader = glCreateShader(GL_VERTEX_SHADER); // åˆ›å»ºäº†ç±»å‹ä¸ºGL_VERTEX_SHADER çš„ç€è‰²å™¨ï¼Œå³é¡¶ç‚¹ç€è‰²å™¨
    GLuint fShader = glCreateShader(GL_FRAGMENT_SHADER); // åˆ›å»ºäº†ç±»å‹ä¸ºGL_FRAGMENT_SHADER çš„ç€è‰²å™¨ï¼Œå³ç‰‡æ®µç€è‰²å™¨

    // å°† GLSL ä»£ç ä»å­—ç¬¦ä¸²è½½å…¥ç©ºç€è‰²å™¨å¯¹è±¡ä¸­
    glShaderSource(vShader, 1, &amp;vshaderSource, NULL);
    glShaderSource(fShader, 1, &amp;fshaderSource, NULL);

    // ç¼–è¯‘ç€è‰²å™¨
    glCompileShader(vShader);
    glCompileShader(fShader);

    // åˆ›å»ºäº†ä¸€ä¸ªå«ä½œ vfProgram çš„ç¨‹åºå¯¹è±¡å¹¶è®°å½•å…¶ID
    GLuint vProgram = glCreateProgram();
    // å°†ç€è‰²å™¨åŠ å…¥ç¨‹åºå¯¹è±¡
    glAttachShader(vProgram, vShader);
    glAttachShader(vProgram, fShader);
    // è¯·æ±‚ GLSL ç¼–è¯‘å™¨ï¼Œä»¥ç¡®ä¿å®ƒä»¬çš„å…¼å®¹æ€§
    glLinkProgram(vProgram);

    return vProgram; // è¿”å›ç€è‰²å™¨ç¨‹åºID
}

int main()
{
    // åˆå§‹åŒ– GLFW
    if (!glfwInit())
    {
        return -1;
    }

    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);

    // æ‰“å¼€ä¸€ä¸ªçª—å£å¹¶åˆ›å»ºå®ƒçš„OpenGLä¸Šä¸‹æ–‡
    GLFWwindow *window = glfwCreateWindow(1024, 768, "triangle", NULL, NULL);
    if (window == NULL)
    {
        glfwTerminate();
        return -1;
    }
    glfwMakeContextCurrent(window);

    // ç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä¸‹é¢æŒ‰ä¸‹çš„è½¬ä¹‰é”®
    glfwSetInputMode(window, GLFW_STICKY_KEYS, GL_TRUE);

    // ç»¿è‰²èƒŒæ™¯
    glClearColor(0.0f, 1.0f, 0.0f, 0.0f);

    // åˆå§‹åŒ– GLEW
    if (glewInit() != GLEW_OK)
    {
        glfwTerminate();
        return -1;
    }

    // åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼Œå¹¶å°†å®ƒè®¾ä¸ºå½“å‰å¯¹è±¡
    GLuint VertexArrayID; // é¡¶ç‚¹æ•°ç»„æ ‡è¯†
    glGenVertexArrays(1, &amp;VertexArrayID);
    glBindVertexArray(VertexArrayID);

    // ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼š(-1,-1,0),(1,-1,0),(0,1,0)
    static const GLfloat g_vertex_buffer_data[] = {
        -1.0f, -1.0f, 0.0f,
         1.0f, -1.0f, 0.0f,
         0.0f,  1.0f, 0.0f };

    // åˆ›å»ºç¼“å­˜åŒº
    GLuint vertexbuffer; // é¡¶ç‚¹ç¼“å†²åŒºæ ‡è¯†
    glGenBuffers(1, &amp;vertexbuffer); // ç”Ÿæˆ1ä¸ªç¼“å†²åŒºï¼Œå°†ç”Ÿæˆçš„æ ‡è¯†ç¬¦æ”¾å…¥é¡¶ç‚¹ç¼“å†²
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW); // æŠŠè¿™ä¸ªä¸‰è§’å½¢ä¼ ç»™OpenGL

    GLuint programID = createShadeProgram(); // åˆ›å»ºç€è‰²å™¨

    do
    {
        glClear(GL_COLOR_BUFFER_BIT);

        glUseProgram(programID);    // ä½¿ç”¨ç€è‰²å™¨

        glEnableVertexAttribArray(0);    // å¯ç”¨é¡¶ç‚¹æ•°ç»„å±æ€§
        glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);

        glDrawArrays(GL_TRIANGLES, 0, 3);    // ç»˜åˆ¶ä¸‰è§’å½¢

        glDisableVertexAttribArray(0);    // ç¦ç”¨é¡¶ç‚¹æ•°ç»„å±æ€§

        glfwSwapBuffers(window);    // äº¤æ¢ç¼“å†²åŒºï¼Œæ›´æ–°å±å¹•
        glfwPollEvents();            // ç›‘å¬äº‹ä»¶
    } while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS and glfwWindowShouldClose(window) == 0);

    // åå¤„ç†ï¼Œåˆ é™¤èµ„æº
    glDeleteBuffers(1, &amp;vertexbuffer);
    glDeleteVertexArrays(1, &amp;VertexArrayID);
    glDeleteProgram(programID);

    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_triangle1.jpg" alt="ç€è‰²åçš„ä¸‰è§’å½¢"></p>
<p>è§‚å¯Ÿç€è‰²å™¨éƒ¨åˆ†çš„ä»£ç ï¼š</p>
<p>é¡¶ç‚¹ç€è‰²å™¨ï¼šæ‰€æœ‰é¡¶ç‚¹ç€è‰²å™¨çš„ä¸»è¦ç›®æ ‡éƒ½æ˜¯å°†é¡¶ç‚¹å‘é€ç»™ç®¡çº¿ã€‚</p>
<pre><code class="language-cpp">"#version 460 core\n"
"layout(location = 0) in vec3 vertexPosition_modelspace;\n"
"void main()\n"
"{ gl_Position.xyz = vertexPosition_modelspace; gl_Position.w = 1.0; }"
</code></pre>
<ol>
<li>
<p>ç¬¬ä¸€è¡Œè¡¨ç¤ºOpenGLç‰ˆæœ¬ï¼ŒåŒæ—¶ä¹Ÿä½¿ç”¨è¯¥ç‰ˆæœ¬çš„è¯­æ³•ï¼Œæˆ‘è¿™é‡Œæ˜¯4.6.0ï¼›</p>
</li>
<li>
<p>ç¬¬äºŒè¡Œ</p>
<ul>
<li><code>layout(location = 0)</code> æŒ‡ç”¨æ¥èµ‹ç»™ <code>vertexPosition_modelspace</code> è¿™ä¸ªå±æ€§çš„ç¼“å†²åŒºã€‚æ¯ä¸ªé¡¶ç‚¹èƒ½æœ‰å¤šç§å±æ€§ï¼šä½ç½®ï¼Œä¸€ç§æˆ–å¤šç§é¢œè‰²ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªçº¹ç†åæ ‡ï¼Œç­‰ç­‰ï¼›é€šè¿‡å°† <code>glvertexAttribPointer</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å€¼èµ‹ç»™layoutï¼Œå°±å®Œæˆäº†è¿™ä¸€ç‚¹ã€‚å‚æ•°å€¼â€œ0â€å¹¶ä¸é‡è¦ï¼Œå®ƒå¯ä»¥æ˜¯12ï¼ˆä½†æ˜¯ä¸å¤§äº <code>glGetIntegerv(GL_MAX_VERTEX_ATTRIBS, &amp;v)</code> ï¼‰ï¼›é‡è¦çš„æ˜¯ä¸¤è¾¹å‚æ•°å€¼ä¿æŒä¸€è‡´</li>
<li><code>in</code> è¡¨ç¤ºè¡¨æ˜å˜é‡æ˜¯è¾“å…¥å˜é‡ï¼›</li>
<li><code>vec3</code> åœ¨GLSLä¸­æ˜¯ä¸€ä¸ªä¸‰ç»´å‘é‡ï¼›</li>
<li><code>vertexPosition_modelspace</code> æ˜¯å˜é‡åï¼Œå°†åŒ…å«æ¯ä¸ªé¡¶ç‚¹ç€è‰²å™¨è¿è¡Œæ‰€éœ€çš„é¡¶ç‚¹ä½ç½®å€¼ã€‚</li>
</ul>
</li>
<li>
<p>ç¬¬ä¸‰è¡Œè¡¨ç¤ºä¸»å‡½æ•°ï¼Œä¸C++è¯­æ³•ç›¸ä¼¼ï¼›</p>
</li>
<li>
<p>ç¬¬å››è¡Œå†…ç½®å˜é‡ gl_Position ç”¨æ¥è®¾ç½®é¡¶ç‚¹åœ¨ 3D ç©ºé—´ä¸­çš„åæ ‡ä½ç½®ï¼Œå¹¶å°†å…¶å‘é€è‡³ä¸‹ä¸€ä¸ªç®¡çº¿é˜¶æ®µã€‚</p>
</li>
</ol>
<p>ç‰‡æ®µç€è‰²å™¨ï¼šæ‰€æœ‰ç‰‡æ®µç€è‰²å™¨çš„ç›®çš„éƒ½æ˜¯ç»™ä¸ºè¦å±•ç¤ºçš„åƒç´ èµ‹äºˆé¢œè‰²ã€‚</p>
<pre><code class="language-cpp">"#version 460 core\n" 
"out vec3 color;\n"
"void main()\n"
"{ color = vec3(0, 0, 0.3); }"
</code></pre>
<ol>
<li>
<p>ç¬¬ä¸€è¡Œè¡¨ç¤ºOpenGLç‰ˆæœ¬ï¼ŒåŒæ—¶ä¹Ÿä½¿ç”¨è¯¥ç‰ˆæœ¬çš„è¯­æ³•ï¼Œæˆ‘è¿™é‡Œæ˜¯4.6.0ï¼›</p>
</li>
<li>
<p>ç¬¬äºŒè¡Œ out æ ‡ç­¾è¡¨æ˜ color å˜é‡æ˜¯è¾“å‡ºå˜é‡ï¼›</p>
</li>
<li>
<p>ç¬¬ä¸‰è¡Œè¡¨ç¤ºä¸»å‡½æ•°ï¼Œä¸C++è¯­æ³•ç›¸ä¼¼ï¼›</p>
</li>
<li>
<p>ç¬¬å››è¡Œè¡¨ç¤ºè®¾ç½®é¢œè‰²RGBå€¼ã€‚</p>
</li>
</ol>
<p>è§£é‡Š <code>glvertexAttribPointer</code> å‡½æ•°ï¼Œå‡½æ•°ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<pre><code class="language-cpp">glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);
</code></pre>
<ol>
<li>
<p>ç¬¬ä¸€å‚æ•°ï¼šæŒ‡å®šè¦é…ç½®çš„é¡¶ç‚¹å±æ€§ã€‚åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ä½¿ç”¨ <code>layout(location = 0)</code> å®šä¹‰äº†é¡¶ç‚¹å±æ€§çš„ä½ç½®å€¼ï¼Œå®ƒå¯ä»¥æŠŠé¡¶ç‚¹å±æ€§çš„ä½ç½®å€¼è®¾ç½®ä¸º0ï¼Œæ‰€ä»¥è¿™é‡Œä¼ å…¥0ï¼›</p>
</li>
<li>
<p>ç¬¬äºŒå‚æ•°ï¼šæŒ‡å®šé¡¶ç‚¹å±æ€§çš„å¤§å°ï¼›</p>
</li>
<li>
<p>ç¬¬ä¸‰å‚æ•°ï¼šæŒ‡å®šæ•°æ®çš„ç±»å‹ï¼›</p>
</li>
<li>
<p>ç¬¬å››å‚æ•°ï¼šæ˜¯å¦å¸Œæœ›æ•°æ®è¢«æ ‡å‡†åŒ–ï¼ˆNormalizeï¼‰ï¼›</p>
</li>
<li>
<p>ç¬¬äº”å‚æ•°ï¼šæ­¥é•¿ï¼Œå‘Šè¯‰åœ¨è¿ç»­çš„é¡¶ç‚¹å±æ€§ç»„ä¹‹é—´çš„é—´éš”ï¼›</p>
</li>
<li>
<p>ç¬¬å…­å‚æ•°ï¼šæ•°ç»„ç¼“å†²åŒºåç§»é‡ã€‚</p>
</li>
</ol>
<p>æ­¤ç¤ºä¾‹ä¸­ç€è‰²å™¨ä»£ç è¾ƒçŸ­ï¼Œå¯ä»¥ç›´æ¥ç¼–å†™åˆ°ç¨‹åºä¸­ã€‚ä½†å½“ç€è‰²å™¨ä»£ç è¾ƒä¸ºå¤æ‚æ—¶ï¼Œå¸Œæœ›èƒ½æ–‡ä»¶åˆ†å¼€ï¼Œä»æ–‡ä»¶ä¸­è¯»å…¥ç€è‰²å™¨ä»£ç ã€‚</p>
<pre><code class="language-cpp">// è¯»ä»£ç å‡½æ•°
std::string readShaderSource(const char *filePath)
{
    std::string content = "";
    std::ifstream fileStream(filePath, std::ios::in);
    std::string line = "";
    while (!fileStream.eof())
    {
        getline(fileStream, line);
        content.append(line + "\n");
    }
    fileStream.close();
    return content;
}
</code></pre>
<p>ç›¸åº”åœ° <code>createShadeProgram()</code> æ”¹æˆï¼š</p>
<pre><code class="language-cpp">std::string vs = readShaderSource("vertex.glsl");
std::string fs = readShaderSource("fragment.glsl");
const char *vshaderSource = vs.c_str();
const char *fshaderSource = fs.c_str();
</code></pre>
<h3 id="2-3-glslä»£ç æ£€æŸ¥">2.3 GLSLä»£ç æ£€æŸ¥</h3>
<p>ç¼–è¯‘å’Œè¿è¡Œ GLSL ä»£ç çš„è¿‡ç¨‹ä¸æ™®é€šä»£ç çš„ä¸åŒï¼ŒGLSL çš„ç¼–è¯‘å‘ç”Ÿåœ¨ C++è¿è¡Œæ—¶ã€‚å¦å¤–ä¸€ä¸ªå¤æ‚çš„ç‚¹æ˜¯ GLSL ä»£ç å¹¶æ²¡æœ‰è¿è¡Œåœ¨ CPU ä¸­ï¼ˆå®ƒè¿è¡Œåœ¨ GPU ä¸­ï¼‰ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿå¹¶ä¸æ€»èƒ½æ•è· OpenGL è¿è¡Œæ—¶çš„é”™è¯¯ã€‚ç€è‰²å™¨è¿è¡Œæ—¶é”™è¯¯çš„å¸¸è§ç»“æœæ˜¯è¾“å‡ºå±å¹•ä¸Šå®Œå…¨ç©ºç™½ï¼Œæ ¹æœ¬æ²¡æœ‰è¾“å‡ºã€‚</p>
<p>ä½†æ˜¯ GLSL å‡½æ•° <code>glGetShaderiv()</code> å’Œ <code>glGetProgramiv()</code> å¯æä¾›æœ‰å…³ç¼–è¯‘è¿‡çš„ GLSL ç€è‰²å™¨å’Œç¨‹åºçš„ä¿¡æ¯ã€‚</p>
<p>è®¾è®¡ä¸‰ä¸ªå‡½æ•°ï¼š</p>
<ul>
<li>
<p><code>checkOpenGLError()</code>ï¼šæ—¢ç”¨äºæ£€æµ‹ GLSL ä»£ç ç¼–è¯‘é”™è¯¯ï¼Œåˆç”¨äºæ£€æµ‹ OpenGL è¿è¡Œæ—¶çš„é”™è¯¯ã€‚</p>
</li>
<li>
<p><code>printShaderLog()</code>ï¼šå½“ GLSL ä»£ç ç¼–è¯‘å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹ã€‚</p>
</li>
<li>
<p><code>printProgramLog()</code>ï¼šå½“ GLSL é“¾æ¥å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹ã€‚</p>
</li>
</ul>
<details><summary>è¯¦ç»†ä»£ç </summary>
<pre><code class="language-cpp">/*
* å½“ GLSL ä»£ç ç¼–è¯‘å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param shader ç€è‰²å™¨æ ‡è¯†
*/
void printShaderLog(GLuint shader)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetShaderInfoLog(shader, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Shader Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* å½“ GLSL é“¾æ¥å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param program ç€è‰²å™¨ç¨‹åºæ ‡è¯†
*/
void printProgramLog(GLuint program)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetProgramiv(program, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetProgramInfoLog(program, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Program Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* æ£€æŸ¥ OpenGL é”™è¯¯æ ‡å¿—ï¼Œå³æ˜¯å¦å‘ç”Ÿ OpenGL é”™è¯¯
*/
bool checkOpenGLerror()
{
    bool err = false;
    int glErr = glGetError();
    while (glErr != GL_NO_ERROR)
    {
        std::cout &lt;&lt; "glError: " &lt;&lt; glErr &lt;&lt; "\n";
        err = true;
        glErr = glGetError();
    }
    return err;
}
</code></pre>
</details>
<p>åŠ å…¥é”™è¯¯æ£€æŸ¥ï¼Œåˆ›å»ºç€è‰²å™¨ç¨‹åºä»£ç æ›´æ”¹ä¸ºï¼š</p>
<details><summary>å±•å¼€ä»£ç </summary>
<pre><code class="language-cpp">GLuint createShadeProgram()
{
    // è®°å½•é”™è¯¯ä¿¡æ¯
    GLint vertCompiled, fragCompiled, linked;

    // é¡¶ç‚¹ç€è‰²å™¨
    std::string vs = readShaderSource("vertex.glsl");
    // ç‰‡æ®µç€è‰²å™¨
    std::string fs = readShaderSource("fragment.glsl");
    const char *vshaderSource = vs.c_str();
    const char *fshaderSource = fs.c_str();

    // OpenGL åˆ›å»ºæ¯ä¸ªç€è‰²å™¨å¯¹è±¡ï¼ˆåˆå§‹å€¼ä¸ºç©ºï¼‰çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ªæ•´æ•° ID ä½œä¸ºåé¢å¼•ç”¨å®ƒçš„åºå·
    // åˆ†åˆ«å­˜å…¥ vShader å’Œ fShader å˜é‡
    GLuint vShader = glCreateShader(GL_VERTEX_SHADER); // åˆ›å»ºäº†ç±»å‹ä¸ºGL_VERTEX_SHADER çš„ç€è‰²å™¨ï¼Œå³é¡¶ç‚¹ç€è‰²å™¨
    GLuint fShader = glCreateShader(GL_FRAGMENT_SHADER); // åˆ›å»ºäº†ç±»å‹ä¸ºGL_FRAGMENT_SHADER çš„ç€è‰²å™¨ï¼Œå³ç‰‡æ®µç€è‰²å™¨

    // å°† GLSL ä»£ç ä»å­—ç¬¦ä¸²è½½å…¥ç©ºç€è‰²å™¨å¯¹è±¡ä¸­
    glShaderSource(vShader, 1, &amp;vshaderSource, NULL);
    glShaderSource(fShader, 1, &amp;fshaderSource, NULL);

    // ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨
    glCompileShader(vShader);
    checkOpenGLerror();
    glGetShaderiv(vShader, GL_COMPILE_STATUS, &amp;vertCompiled);
    if (vertCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "vertex compilation failed\n";
        printShaderLog(vShader);
    }
    // ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨
    glCompileShader(fShader);
    checkOpenGLerror();
    glGetShaderiv(fShader, GL_COMPILE_STATUS, &amp;fragCompiled);
    if (fragCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "fragment compilation failed\n";
        printShaderLog(fShader);
    }

    // åˆ›å»ºäº†ä¸€ä¸ªå«ä½œ vfProgram çš„ç¨‹åºå¯¹è±¡å¹¶è®°å½•å…¶ID
    GLuint vProgram = glCreateProgram();
    // å°†ç€è‰²å™¨åŠ å…¥ç¨‹åºå¯¹è±¡
    glAttachShader(vProgram, vShader);
    glAttachShader(vProgram, fShader);
    // è¯·æ±‚ GLSL ç¼–è¯‘å™¨ï¼Œä»¥ç¡®ä¿å®ƒä»¬çš„å…¼å®¹æ€§
    glLinkProgram(vProgram);
    checkOpenGLerror();
    glGetProgramiv(vProgram, GL_LINK_STATUS, &amp;linked);
    if (linked == GL_FALSE)
    {
        std::cout &lt;&lt; "linking failed\n";
        printProgramLog(vProgram);
    }

    return vProgram; // è¿”å›ç€è‰²å™¨ç¨‹åºID
}
</code></pre>
</details>
<h3 id="2-4-è®©å›¾åƒåŠ¨èµ·æ¥">2.4 è®©å›¾åƒåŠ¨èµ·æ¥</h3>
<p>å®é™…ä¸Šï¼Œåœ¨ä¸»å‡½æ•°çš„å¾ªç¯ä¸­ï¼Œæ¯ä¸€æ¬¡å¾ªç¯éƒ½ä¼šåˆ·æ–°ä¸€æ¬¡æ˜¾ç¤ºã€‚ä½†ç”±äºæ˜¾ç¤ºå†…å®¹ç›¸åŒï¼Œæ•…çœ‹èµ·æ¥æ˜¯é™æ€çš„ã€‚</p>
<p>å¯¹äºä¸Šé¢çš„ä¸‰è§’å½¢ï¼Œæ·»åŠ ä¸Šäº›è®¸åç§»é‡ï¼Œåˆ™ä¼šè‡ªç”±ç§»åŠ¨ã€‚</p>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_movingtriangle.gif" alt="ç§»åŠ¨çš„ä¸‰è§’å½¢"></p>
<details><summary>ä¸»å‡½æ•°ä»£ç </summary>
<pre><code class="language-cpp">int main()
{
    // åˆå§‹åŒ– GLFW
    if (!glfwInit())
    {
        return -1;
    }

    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);

    // æ‰“å¼€ä¸€ä¸ªçª—å£å¹¶åˆ›å»ºå®ƒçš„OpenGLä¸Šä¸‹æ–‡
    GLFWwindow *window = glfwCreateWindow(1024, 768, "triangle", NULL, NULL);
    if (window == NULL)
    {
        glfwTerminate();
        return -1;
    }
    glfwMakeContextCurrent(window);

    // ç¡®ä¿æˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°ä¸‹é¢æŒ‰ä¸‹çš„è½¬ä¹‰é”®
    glfwSetInputMode(window, GLFW_STICKY_KEYS, GL_TRUE);

    // ç»¿è‰²èƒŒæ™¯
    glClearColor(0.0f, 1.0f, 0.0f, 0.0f);

    // åˆå§‹åŒ– GLEW
    if (glewInit() != GLEW_OK)
    {
        glfwTerminate();
        return -1;
    }

    // åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼Œå¹¶å°†å®ƒè®¾ä¸ºå½“å‰å¯¹è±¡
    GLuint VertexArrayID; // é¡¶ç‚¹æ•°ç»„æ ‡è¯†
    glGenVertexArrays(1, &amp;VertexArrayID);
    glBindVertexArray(VertexArrayID);

    // ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼š(-1,-1,0),(1,-1,0),(0,1,0)
    static const GLfloat g_vertex_buffer_data[] = {
        -1.0f, -1.0f, 0.0f,
         1.0f, -1.0f, 0.0f,
         0.0f,  1.0f, 0.0f };

    // åˆ›å»ºç¼“å­˜åŒº
    GLuint vertexbuffer; // é¡¶ç‚¹ç¼“å†²åŒºæ ‡è¯†
    glGenBuffers(1, &amp;vertexbuffer); // ç”Ÿæˆ1ä¸ªç¼“å†²åŒºï¼Œå°†ç”Ÿæˆçš„æ ‡è¯†ç¬¦æ”¾å…¥é¡¶ç‚¹ç¼“å†²
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW); // æŠŠè¿™ä¸ªä¸‰è§’å½¢ä¼ ç»™OpenGL

    GLuint programID = createShadeProgram(); // åˆ›å»ºç€è‰²å™¨

    float x = 0.0f, inc = 0.001f;

    do
    {
        glClear(GL_COLOR_BUFFER_BIT);

        glUseProgram(programID);    // ä½¿ç”¨ç€è‰²å™¨

        x += inc;    // ç§»åŠ¨
        if (x &gt; 1.0f) inc = -0.001f;
        if (x &lt; -1.0f) inc = 0.001f;
        // è·å–æŒ‡å‘ offset å˜é‡çš„æŒ‡é’ˆ
        GLuint offsetLoc = glGetUniformLocation(programID, "offset");
        // å°† x çš„å€¼å¤åˆ¶ç»™ offset
        glProgramUniform1f(programID, offsetLoc, x);

        glEnableVertexAttribArray(0);    // å¯ç”¨é¡¶ç‚¹æ•°ç»„
        glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer); // ç»‘å®šç¼“å†²åŒº
        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);

        glDrawArrays(GL_TRIANGLES, 0, 3);    // ç»˜åˆ¶ä¸‰è§’å½¢

        glDisableVertexAttribArray(0);    // ç¦ç”¨é¡¶ç‚¹æ•°ç»„

        glfwSwapBuffers(window);    // äº¤æ¢ç¼“å†²åŒºï¼Œæ›´æ–°å±å¹•
        glfwPollEvents();            // ç›‘å¬äº‹ä»¶
    } while (glfwGetKey(window, GLFW_KEY_ESCAPE) != GLFW_PRESS and glfwWindowShouldClose(window) == 0);

    // åå¤„ç†ï¼Œåˆ é™¤èµ„æº
    glDeleteBuffers(1, &amp;vertexbuffer);
    glDeleteVertexArrays(1, &amp;VertexArrayID);
    glDeleteProgram(programID);

    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<p>è€Œé¡¶ç‚¹ç€è‰²å™¨ä¹Ÿéœ€è¦æ ¹æ®åç§»é‡ä½œä¿®æ”¹ï¼š</p>
<pre><code class="language-glsl">#version 460 core

uniform float offset;

layout(location = 0) in vec3 vertexPosition_modelspace;

void main()
{
    gl_Position = vec4(vertexPosition_modelspace.x + offset, vertexPosition_modelspace.y, vertexPosition_modelspace.z, 1.0);
}
</code></pre>
<p>å…¶ä¸­ <code>uniform</code> è¡¨ç¤ºç»Ÿä¸€å˜é‡ã€‚</p>
<h2 id="ä¸‰-openglæ•°å­¦åŸºç¡€">ä¸‰ã€OpenGLæ•°å­¦åŸºç¡€</h2>
<h3 id="3-1-åæ ‡ç³»">3.1 åæ ‡ç³»</h3>
<p>3D ç©ºé—´ä¸­å¸¸å¸¸ä½¿ç”¨ä¸‰ä¸ªåæ ‡è½´ç»„æˆçš„åæ ‡ç³»ï¼Œå¦‚å·¦æ‰‹åæ ‡ç³»å’Œå³æ‰‹åæ ‡ç³»ã€‚</p>
<ul>
<li>
<p>å·¦æ‰‹åæ ‡ç³»ï¼šä¼¸å‡ºå·¦æ‰‹ï¼Œä½¿å¾—æ‹‡æŒ‡ã€é£ŸæŒ‡å’Œä¸­æŒ‡ä¸¤ä¸¤å‚ç›´ï¼Œåˆ™æ‹‡æŒ‡æŒ‡å‘ä¸º x æ–¹å‘ï¼Œä¸­æŒ‡æŒ‡å‘ä¸º z æ–¹å‘ï¼Œé£ŸæŒ‡æŒ‡å‘ä¸º y æ–¹å‘ã€‚</p>
</li>
<li>
<p>å³æ‰‹åæ ‡ç³»ï¼šä¼¸å‡ºå³æ‰‹ï¼Œä½¿å¾—æ‹‡æŒ‡ã€é£ŸæŒ‡å’Œä¸­æŒ‡ä¸¤ä¸¤å‚ç›´ï¼Œåˆ™æ‹‡æŒ‡æŒ‡å‘ä¸º x æ–¹å‘ï¼Œä¸­æŒ‡æŒ‡å‘ä¸º z æ–¹å‘ï¼Œé£ŸæŒ‡æŒ‡å‘ä¸º y æ–¹å‘ã€‚</p>
</li>
</ul>
<p><em>æ­¤å­¦ä¹ è®°å½•ä½¿ç”¨å³æ‰‹åæ ‡ç³»</em></p>
<h3 id="3-2-ç‚¹">3.2 ç‚¹</h3>
<p>é½æ¬¡åæ ‡ï¼šå…·æœ‰å››ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ x åæ ‡ã€y åæ ‡ã€z åæ ‡ã€w åæ ‡ã€‚å…¶ä¸­ w æ€»æ˜¯éé›¶å€¼ã€‚</p>
<p>OpenGL ä¸­å¯ç”¨ <code>vec3</code> æˆ– <code>vec4</code> ç±»è¡¨ç¤ºç‚¹æ•°æ®ã€‚</p>
<h3 id="3-3-å‘é‡">3.3 å‘é‡</h3>
<p>å‘é‡è¡¨ç¤ºå¤§å°å’Œæ–¹å‘ã€‚å®ƒä»¬æ²¡æœ‰ç‰¹å®šä½ç½®ã€‚åœ¨ 3D å›¾å½¢å­¦ä¸­ï¼Œå‘é‡ä¸€èˆ¬ç”¨ç©ºé—´ä¸­çš„å•ä¸ªç‚¹è¡¨ç¤ºï¼Œå‘é‡çš„å¤§å°æ˜¯åŸç‚¹åˆ°è¯¥ç‚¹çš„è·ç¦»ï¼Œæ–¹å‘åˆ™æ˜¯åŸç‚¹åˆ°è¯¥ç‚¹çš„æ–¹å‘ã€‚</p>
<p>GLSL å’Œ GLM æ‰€æä¾›çš„ <code>vec3</code> å’Œ <code>vec4</code> ç±»å‹æ—¢èƒ½ç”¨æ¥å­˜å‚¨ç‚¹ï¼Œåˆèƒ½ç”¨æ¥å­˜å‚¨å‘é‡ã€‚</p>
<p>è®¾æœ‰å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A=(x,y,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> å’Œ å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B=(u,v,w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>ï¼š</p>
<ul>
<li>
<p>å‘é‡çš„åŠ æ³•ï¼šå¯¹åº”ä½ç½®ç›¸åŠ </p>
</li>
<li>
<p>å‘é‡å½’ä¸€åŒ–ï¼šå°†é•¿åº¦å˜ä¸º1ã€‚GLM åº“æä¾›äº†å‡½æ•° <code>glm::normalize(vec3)</code></p>
</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>^</mo></mover><mo>=</mo><mfrac><mi>A</mi><mrow><mi mathvariant="normal">âˆ£</mi><mi>A</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac><mo>=</mo><mfrac><mi>A</mi><msqrt><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\hat{A}=\frac A{\vert A\vert}=\frac A{\sqrt{x^2+y^2+z^2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9467699999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault">A</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">A</span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.49033em;vertical-align:-1.13em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.1521660000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578340000000001em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.917834em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2821659999999999em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">A</span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.13em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>
<p>å‘é‡ç‚¹ç§¯ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>â‹…</mo><mi>B</mi><mo>=</mo><mi>x</mi><mi>u</mi><mo>+</mo><mi>y</mi><mi>v</mi><mo>+</mo><mi>z</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">A\cdot B = xu+yv+zw</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>ã€‚GLM åº“æä¾›äº†å‡½æ•° <code>glm::dot(vec3,vec3)</code></p>
</li>
<li>
<p>å‘é‡å‰ç§¯ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>Ã—</mo><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><mi>y</mi><mi>w</mi><mo>âˆ’</mo><mi>v</mi><mi>z</mi><mo separator="true">,</mo><mi>u</mi><mi>z</mi><mo>âˆ’</mo><mi>x</mi><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mi>v</mi><mo>âˆ’</mo><mi>u</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\times B=(yw-vz, uz-xw, xv-uy)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>ã€‚GLM åº“æä¾›äº†å‡½æ•° <code>glm::cross(vec3,vec3)</code></p>
</li>
</ul>
<h4 id="3-3-1-ç‚¹ç§¯çš„åº”ç”¨">3.3.1 ç‚¹ç§¯çš„åº”ç”¨</h4>
<ol>
<li>ç‚¹ç§¯çš„åŸºæœ¬åº”ç”¨æ˜¯æ±‚ä¸¤å‘é‡å¤¹è§’ã€‚</li>
</ol>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi><mo>=</mo><mfrac><mrow><mi>V</mi><mo>â‹…</mo><mi>W</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>V</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>W</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\cos\theta=\frac{V\cdot W}{\vert V\vert\vert W\vert}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ol start="2">
<li>
<p>æ±‚å‘é‡çš„å¤§å°ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mi>V</mi><mo>â‹…</mo><mi>V</mi></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{V\cdot V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.11333499999999996em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9266650000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span><span style="top:-2.886665em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.11333499999999996em;"><span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>åˆ¤æ–­å‘é‡æ˜¯å¦æ­£äº¤ï¼Œè‹¥æ­£äº¤ï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>â‹…</mo><mi>W</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">V\cdot W=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>
</li>
<li>
<p>åˆ¤æ–­å‘é‡æ˜¯å¦å¹³è¡Œï¼Œè‹¥å¹³è¡Œï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>â‹…</mo><mi>W</mi><mo>=</mo><mi mathvariant="normal">âˆ£</mi><mi>V</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>W</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">V\cdot W=\vert V\vert\vert W\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord">âˆ£</span></span></span></span></p>
</li>
</ol>
<h4 id="3-3-2-å‰ç§¯çš„åº”ç”¨">3.3.2 å‰ç§¯çš„åº”ç”¨</h4>
<ul>
<li>
<p>ä¸¤å‘é‡å‰ç§¯çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å‘é‡ï¼ˆæ³•å‘é‡ï¼‰ï¼Œæ–°çš„å‘é‡æ­£äº¤ï¼ˆå‚ç›´ï¼‰äºä¹‹å‰ä¸¤ä¸ªå‘é‡æ‰€å®šä¹‰çš„å¹³é¢ã€‚æ‰€å¾—æ³•å‘é‡çš„æ–¹å‘éµå¾ªå³æ‰‹å®šåˆ™ï¼Œå³å°†å³æ‰‹æ‰‹æŒ‡ä» V å‘ W å·æ›²ä¼šä½¿å¾—å¤§æ‹‡æŒ‡æŒ‡å‘æ³•å‘é‡ R çš„æ–¹å‘ã€‚</p>
</li>
<li>
<p>å‰ç§¯çš„è®¡ç®—ä¸å‘é‡é¡ºåºæœ‰å…³ã€‚</p>
</li>
</ul>
<h3 id="3-4-çŸ©é˜µ">3.4 çŸ©é˜µ</h3>
<p>çŸ©é˜µå¼çŸ©å½¢çš„å€¼çš„é˜µåˆ—ï¼Œè·Ÿå¾ˆå¤šé¢†åŸŸä¸Šçš„çŸ©é˜µæ¦‚å¿µç›¸ä¼¼ã€‚</p>
<p>GLSLä¸­çš„ <code>mat4</code> æ•°æ®ç±»å‹ä¾¿æ˜¯ç”¨æ¥å­˜å‚¨ 4 x 4 çŸ©é˜µã€‚åŒæ · GLM ä¸­çš„ <code>mat4</code> ç±»ä¹Ÿæ˜¯ç”¨æ¥å®ä¾‹åŒ–å¹¶è¡¨ç¤º 4 x 4 çŸ©é˜µã€‚</p>
<p>æ¯”å¦‚å•ä½çŸ©é˜µæ˜¯å¯¹è§’çº¿å€¼å…¨ä¸º1ï¼Œå…¶ä½™å€¼éƒ½ä¸º0çš„çŸ©é˜µã€‚åœ¨ GLM ä¸­ï¼Œè°ƒç”¨æ„é€ å‡½æ•° <code>glm::mat4 m(1.0f)</code> å¯ä»¥åœ¨å˜é‡ m ä¸­ç”Ÿæˆå•ä½çŸ©é˜µã€‚</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(å•ä½çŸ©é˜µ)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left[
\begin{matrix}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\right]
\tag{å•ä½çŸ©é˜µ}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord cjk_fallback">å•</span><span class="mord cjk_fallback">ä½</span><span class="mord cjk_fallback">çŸ©</span><span class="mord cjk_fallback">é˜µ</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>çŸ©é˜µè½¬ç½®ï¼šçŸ©é˜µçš„åˆ—ä¸è¡Œäº¤æ¢ã€‚GLM åº“å’Œ GLSL åº“éƒ½æœ‰è½¬ç½®å‡½æ•°ï¼Œåˆ†åˆ«æ˜¯ <code>glm::transpose(mat4)</code> å’Œ <code>transpose(mat4)</code>ã€‚</p>
<p>çŸ©é˜µåŠ æ³•ï¼šä¸¤ä¸ªçŸ©é˜µå¯¹åº”å€¼ç›¸åŠ ã€‚åœ¨GLSLä¸­ï¼Œ<code>+</code> ä½œäº†é‡è½½ï¼Œæ”¯æŒçŸ©é˜µåŠ æ³•ã€‚</p>
<p>çŸ©é˜µä¹˜æ³•ï¼šä¸çº¿æ€§ä»£æ•°ä¸­çš„çŸ©é˜µä¹˜æ³•ä¸€è‡´ã€‚</p>
<ul>
<li>åœ¨ 3D å›¾å½¢å­¦ä¸­ï¼Œç‚¹ä¸çŸ©é˜µç›¸ä¹˜é€šå¸¸å°†ç‚¹è§†ä½œåˆ—å‘é‡ï¼Œå¹¶ä»å³å‘å·¦è®¡ç®—ï¼Œå¾—åˆ°ç‚¹ã€‚</li>
<li>çŸ©é˜µç›¸ä¹˜ä¹Ÿå«ä½œåˆå¹¶ã€‚
<ul>
<li>çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹</li>
</ul>
</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>w</mi><mi>P</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo>=</mo><msub><mi>M</mi><mn>1</mn></msub><mo>Ã—</mo><mo stretchy="false">[</mo><msub><mi>M</mi><mn>2</mn></msub><mo>Ã—</mo><mo stretchy="false">(</mo><msub><mi>M</mi><mn>3</mn></msub><mo>Ã—</mo><mi>P</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>M</mi><mn>1</mn></msub><mo>Ã—</mo><msub><mi>M</mi><mn>2</mn></msub><mo>Ã—</mo><msub><mi>M</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>Ã—</mo><mi>P</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">NewPoint = M_1\times[M_2\times(M_3\times Point)]=(M_1\times M_2\times M_3)\times Point
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span></span></span></span></span></p>
<ul>
<li>GLSL å’Œ GLM éƒ½æ”¯æŒ vec4 ä¸çŸ©é˜µç›¸ä¹˜ï¼Œå¹¶ä½¿ç”¨ <code>*</code> æ“ä½œç¬¦è¡¨ç¤ºã€‚</li>
</ul>
<p>é€†çŸ©é˜µï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><msup><mi>M</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>M</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi><mo>=</mo><mtext>å•ä½çŸ©é˜µ</mtext></mrow><annotation encoding="application/x-tex">MM^{-1}=M^{-1}M=å•ä½çŸ©é˜µ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å•</span><span class="mord cjk_fallback">ä½</span><span class="mord cjk_fallback">çŸ©</span><span class="mord cjk_fallback">é˜µ</span></span></span></span>ï¼ŒGLSL å’Œ GLM éƒ½æä¾›äº† <code>mat4.inverse()</code> å‡½æ•°ã€‚</p>
<h3 id="3-5-å˜æ¢çŸ©é˜µ">3.5 å˜æ¢çŸ©é˜µ</h3>
<p>å˜æ¢çŸ©é˜µåŸºäº 4x4 çŸ©é˜µï¼Œä½¿ç”¨é½æ¬¡åæ ‡ç³»ï¼ŒåŒ…æ‹¬å¹³ç§»çŸ©é˜µã€ç¼©æ”¾çŸ©é˜µã€æ—‹è½¬çŸ©é˜µã€æŠ•å½±çŸ©é˜µå’Œ LookAt çŸ©é˜µã€‚</p>
<h4 id="3-5-1-å¹³ç§»çŸ©é˜µ">3.5.1 å¹³ç§»çŸ©é˜µ</h4>
<p>å¹³ç§»çŸ©é˜µ A ç”¨äºå°†ç‰©ä½“ä»ä¸€ä¸ªä½ç½®ç§»è‡³å¦ä¸€ä½ç½®ã€‚</p>
<p>åœ¨å•ä½çŸ©é˜µçš„åŸºç¡€ä¸Šï¼Œå°† xã€yã€z çš„ç§»åŠ¨é‡è®°å½•åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>03</mn></msub></mrow><annotation encoding="application/x-tex">A_{03}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>13</mn></msub></mrow><annotation encoding="application/x-tex">A_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>23</mn></msub></mrow><annotation encoding="application/x-tex">A_{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä½ç½®ã€‚</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>X</mi><mo>+</mo><msub><mi>T</mi><mi>x</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Y</mi><mo>+</mo><msub><mi>T</mi><mi>y</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Z</mi><mo>+</mo><msub><mi>T</mi><mi>z</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>T</mi><mi>x</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>T</mi><mi>y</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>T</mi><mi>z</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(
\begin{matrix}
X+T_x\\
Y+T_y\\
Z+T_z\\
1
\end{matrix}
\right)
=
\left[
\begin{matrix}
1 &amp; 0 &amp; 0 &amp; T_x\\
0 &amp; 1 &amp; 0 &amp; T_y\\
0 &amp; 0 &amp; 1 &amp; T_z\\
0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\right]
\left(
\begin{matrix}
X\\
Y\\
Z\\
1
\end{matrix}
\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80006em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ç»“æœå°±æ˜¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X,Y,Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span> å¹³ç§»åˆ°ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo>+</mo><msub><mi>T</mi><mi>x</mi></msub><mo separator="true">,</mo><mi>Y</mi><mo>+</mo><msub><mi>T</mi><mi>y</mi></msub><mo separator="true">,</mo><mi>Z</mi><mo>+</mo><msub><mi>T</mi><mi>z</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X+T_x,Y+T_y,Z+T_z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>å¹³ç§»çŸ©é˜µçš„æ„å»ºå¯ä»¥ä½¿ç”¨ GLM ä¸­ <code>glm::translate(x,y,z)</code> å‡½æ•°ã€‚æ¥ç€çŸ©é˜µä¸ç‚¹ç›¸ä¹˜ã€‚</p>
<h4 id="3-5-2-ç¼©æ”¾çŸ©é˜µ">3.5.2 ç¼©æ”¾çŸ©é˜µ</h4>
<p>ç¼©æ”¾çŸ©é˜µç”¨äºæ”¹å˜ç‰©ä½“çš„å¤§å°æˆ–è€…å°†ç‚¹æ²¿æœå‘æˆ–è¿œç¦»åŸç‚¹çš„æ–¹å‘ç§»åŠ¨ã€‚</p>
<p>ç¼©æ”¾çŸ©é˜µ A åœ¨å•ä½çŸ©é˜µçš„åŸºç¡€ä¸Šï¼Œå°†ä½äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>00</mn></msub></mrow><annotation encoding="application/x-tex">A_{00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">A_{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>22</mn></msub></mrow><annotation encoding="application/x-tex">A_{22}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å€¼æ›¿æ¢ä¸º xã€yã€z ç¼©æ”¾å› å­ã€‚</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>X</mi><mtext>&nbsp;</mtext><msub><mi>S</mi><mi>x</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Y</mi><mtext>&nbsp;</mtext><msub><mi>S</mi><mi>y</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Z</mi><mtext>&nbsp;</mtext><msub><mi>S</mi><mi>z</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mi>x</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mi>y</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mi>z</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(
\begin{matrix}
X\ S_x\\
Y\ S_y\\
Z\ S_z\\
1
\end{matrix}
\right)
=
\left[
\begin{matrix}
S_x &amp; 0 &amp; 0 &amp; 0\\
0 &amp; S_y &amp; 0 &amp; 0\\
0 &amp; 0 &amp; S_z &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\right]
\left(
\begin{matrix}
X\\
Y\\
Z\\
1
\end{matrix}
\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80006em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>GLM çš„ <code>glm::scale(x,y,z)</code> å‡½æ•°ç”¨äºæ„å»ºä¾ç…§ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> ç¼©æ”¾çš„çŸ©é˜µï¼Œæ¥ç€çŸ©é˜µä¸ç‚¹ç›¸ä¹˜ã€‚</p>
<p>ç¼©æ”¾è¿˜å¯ä»¥ç”¨æ¥åˆ‡æ¢åæ ‡ç³»ï¼Œæ¯”å¦‚åœ¨å³æ‰‹åæ ‡ç³»ä¸‹ç¡®å®šå·¦æ‰‹åæ ‡ç³»çš„åæ ‡ï¼Œåªéœ€æŠŠ z åæ ‡åè½¬å³å¯ã€‚åˆ‡æ¢åæ ‡ç³»çš„ç¼©æ”¾çŸ©é˜µï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[
\begin{matrix}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; -1&amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\right]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="3-5-3-æ—‹è½¬çŸ©é˜µ">3.5.3 æ—‹è½¬çŸ©é˜µ</h4>
<p>3D ç©ºé—´ä¸­æ—‹è½¬ç‰©ä½“éœ€è¦æŒ‡å®šæ—‹è½¬è½´å’Œæ—‹è½¬è§’ï¼ˆä»¥åº¦æˆ–å¼§åº¦ä¸ºå•ä½ï¼‰ã€‚</p>
<p>æ•°å­¦ä¸Šå¯è¯æ˜ï¼šå›´ç»•ä»»ä½•è½´çš„æ—‹è½¬éƒ½å¯ä»¥è¡¨ç¤ºä¸ºç»• x è½´ã€y<br>
è½´ã€z è½´æ—‹è½¬çš„ç»„åˆã€‚å›´ç»•è¿™ 3 ä¸ªè½´çš„æ—‹è½¬è§’åº¦è¢«ç§°ä¸ºæ¬§æ‹‰è§’ã€‚</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>Z</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>sin</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>sin</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(ç»•xè½´æ—‹è½¬)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left(\begin{matrix}X \\ Y'\\ Z'\\ 1\end{matrix}\right)=\left[\begin{matrix}1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; \cos\theta &amp; -\sin\theta &amp; 0\\ 0 &amp; \sin\theta &amp; \cos\theta &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1\end{matrix}\right]\left(\begin{matrix}X\\ Y\\ Z\\ 1\end{matrix}\right)\tag{ç»•xè½´æ—‹è½¬}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80006em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord cjk_fallback">ç»•</span><span class="mord">x</span><span class="mord cjk_fallback">è½´</span><span class="mord cjk_fallback">æ—‹</span><span class="mord cjk_fallback">è½¬</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>Z</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>sin</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>sin</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(ç»•yè½´æ—‹è½¬)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left(\begin{matrix}X' \\ Y\\ Z'\\ 1\end{matrix}\right)=\left[\begin{matrix}\cos\theta &amp; 0 &amp; \sin\theta &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ -\sin\theta &amp; 0 &amp; \cos\theta &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1\end{matrix}\right]\left(\begin{matrix}X\\ Y\\ Z\\ 1\end{matrix}\right)\tag{ç»•yè½´æ—‹è½¬}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80006em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord cjk_fallback">ç»•</span><span class="mord">y</span><span class="mord cjk_fallback">è½´</span><span class="mord cjk_fallback">æ—‹</span><span class="mord cjk_fallback">è½¬</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>sin</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>sin</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mi>Î¸</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(ç»•zè½´æ—‹è½¬)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left(\begin{matrix}X' \\ Y'\\ Z\\ 1\end{matrix}\right)=\left[\begin{matrix}\cos\theta &amp; -\sin\theta &amp; 0 &amp; 0\\ \sin\theta &amp; \cos\theta &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1\end{matrix}\right]\left(\begin{matrix}X\\ Y\\ Z\\ 1\end{matrix}\right)\tag{ç»•zè½´æ—‹è½¬}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80006em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500299999999997em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-2.8000000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.39501em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.41001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.65003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord cjk_fallback">ç»•</span><span class="mord">z</span><span class="mord cjk_fallback">è½´</span><span class="mord cjk_fallback">æ—‹</span><span class="mord cjk_fallback">è½¬</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>æ—‹è½¬å˜æ¢æœ‰ 3 ç§ï¼Œåˆ†åˆ«æ˜¯ç»• x è½´ã€y è½´ã€z è½´æ—‹è½¬ã€‚GLM æä¾›äº†å‡½æ•° <code>glm::rotate(mat4,Î¸,x,y,z)</code> æ„å»ºç»• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> æ—‹è½¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span> åº¦çš„çŸ©é˜µï¼Œæ¥ç€çŸ©é˜µä¸ç‚¹ç›¸ä¹˜ã€‚</p>
<p>é€šè¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>â¡</mo><mo stretchy="false">(</mo><mtext>âˆ’</mtext><mi>Î¸</mi><mo stretchy="false">)</mo><mo>=</mo><mi>cos</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\cos(âˆ’Î¸) = \cos(Î¸)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>â¡</mo><mo stretchy="false">(</mo><mtext>âˆ’</mtext><mi>Î¸</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>âˆ’</mtext><mi>sin</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sin(âˆ’Î¸) = âˆ’\sin(Î¸)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span> å³å¯éªŒè¯åå‘æ—‹è½¬çš„çŸ©é˜µæ°ç­‰äºå…¶è½¬ç½®çŸ©é˜µã€‚</p>
<p>å½“åœ¨ 3D ç©ºé—´ä¸­æ—‹è½¬è½´ä¸ç©¿è¿‡åŸç‚¹æ—¶ï¼Œç‰©ä½“ä½¿ç”¨æ¬§æ‹‰è§’è¿›è¡Œæ—‹è½¬éœ€è¦å‡ ä¸ªé¢å¤–çš„æ­¥éª¤ã€‚ä¸€èˆ¬æœ‰ï¼š</p>
<ol>
<li>å¹³ç§»æ—‹è½¬è½´ä»¥ä½¿å®ƒç»è¿‡åŸç‚¹ï¼›</li>
<li>ç»• x è½´ã€y è½´ã€z è½´æ—‹è½¬é€‚å½“çš„æ¬§æ‹‰è§’ï¼›</li>
<li>å¤åŸæ­¥éª¤ 1 ä¸­çš„å¹³ç§»ã€‚</li>
</ol>
<h3 id="3-6-è§†è§‰ç©ºé—´å’Œåˆæˆç›¸æœº">3.6 è§†è§‰ç©ºé—´å’Œåˆæˆç›¸æœº</h3>
<p>3D ç©ºé—´ä¸­ï¼Œéœ€è¦æ‰¾åˆ°ä¸€ç‚¹å¹¶ç¡®ç«‹è§‚å¯Ÿæ–¹å‘ï¼Œè¿™ä¸ªç‚¹å«ä½œè§†å›¾æˆ–è§†è§‰ç©ºé—´æˆ–åˆæˆç›¸æœºã€‚</p>
<p>è§‚å¯Ÿ 3D ä¸–ç•Œéœ€è¦ä»¥ä¸‹æ­¥éª¤</p>
<ol>
<li>ç¡®å®šç›¸æœºçš„ä½ç½®ï¼›</li>
<li>è°ƒæ•´ç›¸æœºçš„è§’åº¦ï¼Œé€šå¸¸éœ€è¦ä¸€å¥—å®ƒè‡ªå·±çš„ç›´è§’åæ ‡è½´uã€vã€nï¼›</li>
<li>å®šä¹‰ä¸€ä¸ªè§†ä½“ã€‚è§†ä½“æ˜¯ä»ç›¸æœºçš„ä½ç½®å‡ºå‘ï¼Œæ²¿ç€ç›¸æœºçš„è§†çº¿æœå‘çš„å¯è§†èŒƒå›´ã€‚</li>
<li>å°†è§†ä½“å†…çš„å¯¹è±¡æŠ•å½±åˆ°æŠ•å½±å¹³é¢ä¸Šã€‚</li>
</ol>
<p>OpenGL å…·æœ‰ä¸€ä¸ªå›ºå®šåœ¨åŸç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> ä¸”æœå‘ z è½´è´Ÿæ–¹å‘çš„ç›¸æœºã€‚æ‰€ä»¥å½“ä½¿ç”¨è¿™ä¸ªç›¸æœºæ—¶ï¼Œç”±äºç›¸æœºè‡ªèº«ä¸èƒ½ç§»åŠ¨ï¼Œæ‰€ä»¥éœ€è¦å°†å¯¹è±¡ç§»åŠ¨åˆ°é€‚åˆçš„ä½ç½®å¹¶è°ƒæ•´åˆé€‚çš„æ–¹å‘ã€‚</p>
<p>å‡è®¾æœ‰ä¸–ç•Œç©ºé—´ï¼ˆç±»ä¼¼äºå…¨å±€çš„ç©ºé—´ï¼‰ä¸­æŸç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">P_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œéœ€è¦å¯¹è¯¥ç‚¹è¿›è¡Œå˜æ¢è½¬æ¢æˆç›¸æœºç©ºé—´ä¸­é€‚åˆçš„ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">P_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æ„å»ºä¸€ä¸ªå•ä¸€å˜æ¢çŸ©é˜µä»¥å®Œæˆæ—‹è½¬å’Œå¹³ç§»ï¼Œè¿™ä¸ªçŸ©é˜µå«ä½œè§†å›¾å˜æ¢çŸ©é˜µï¼Œè®°ä½œ Vï¼ˆVåˆå¹¶äº†å¹³ç§»çŸ©é˜µå’Œæ—‹è½¬çŸ©é˜µï¼‰ã€‚</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>C</mi></msub><mo>=</mo><mi>V</mi><mo>Ã—</mo><msub><mi>P</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">P_C=V\times P_W
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å°† V çŸ©é˜µä¸æ¨¡å‹çŸ©é˜µ M çš„ç§¯å®šä¹‰ä¸º <strong>æ¨¡å‹-è§†å›¾(Model-View, MV)</strong> çŸ©é˜µï¼Œè®°ä½œMVï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>V</mi><mo>=</mo><mi>V</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MV=VM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<ul>
<li><em>æ¨¡å‹çŸ©é˜µ M æ˜¯ä¸–ç•Œç©ºé—´ä¸­å¯¹è±¡å®šä½åŠå®šå‘çš„çŸ©é˜µ</em></li>
</ul>
<p>ä¹‹åï¼Œå¯¹äºæŸç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">P_M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å°±å¯ä»¥ä»è‡ªå·±çš„æ¨¡å‹ç©ºé—´ç›´æ¥è½¬æ¢åˆ°ç›¸æœºç©ºé—´ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>C</mi></msub><mo>=</mo><mi>M</mi><mi>V</mi><msub><mi>P</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">P_C=MVP_M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="3-7-æŠ•å½±çŸ©é˜µ">3.7 æŠ•å½±çŸ©é˜µ</h3>
<p>é€è§†æŠ•å½±çŸ©é˜µå’Œæ­£å°„æŠ•å½±çŸ©é˜µ</p>
<h4 id="3-7-1-é€è§†æŠ•å½±çŸ©é˜µ">3.7.1 é€è§†æŠ•å½±çŸ©é˜µ</h4>
<p>é€è§†æŠ•å½±é€šè¿‡ä½¿ç”¨é€è§†æ¦‚å¿µæ¨¡ä»¿æˆ‘ä»¬çœ‹çœŸå®ä¸–ç•Œçš„æ–¹<br>
å¼ï¼Œå°è¯•è®© 2D å›¾åƒçœ‹èµ·æ¥åƒæ˜¯ 3D çš„ã€‚</p>
<p>ä½¿ç”¨å«ä½œ <strong>é€è§†çŸ©é˜µ</strong> æˆ–è€… <strong>é€è§†å˜æ¢</strong> çš„å˜æ¢çŸ©é˜µå°†å¹³è¡Œçº¿å˜ä¸ºæ°å½“çš„ä¸å¹³è¡Œçº¿æ¥å®ç°è¿™ä¸ªæ•ˆæœã€‚å®šä¹‰ 4 ä¸ªå‚æ•°æ¥æ„å»ºè§†ä½“ï¼š</p>
<ul>
<li>çºµæ¨ªæ¯”ï¼šè¿œè¿‘å‰ªè£å¹³é¢çš„å®½åº¦ä¸é«˜åº¦ä¹‹æ¯”ï¼›</li>
<li>è§†åœºï¼šå¯è§†ç©ºé—´çš„çºµå‘è§’åº¦ï¼›</li>
<li>è¿‘å‰ªè£å¹³é¢ï¼ˆä¹Ÿç§°æŠ•å½±å¹³é¢ï¼‰</li>
<li>è¿œå‰ªè£å¹³é¢ã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_View.jpg" alt="é€è§†è§†ä½“æˆ–è§†é”¥ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬2ç‰ˆï¼‰"></p>
<p>é€è§†çŸ©é˜µï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>q</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(é€è§†çŸ©é˜µ)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left[
\begin{matrix}
A &amp; 0 &amp; 0 &amp; 0\\
0 &amp; q &amp; 0 &amp; 0\\
0 &amp; 0 &amp; B &amp; C\\
0 &amp; 0 &amp;-1 &amp; 0
\end{matrix}
\right]
\tag{é€è§†çŸ©é˜µ}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord cjk_fallback">é€</span><span class="mord cjk_fallback">è§†</span><span class="mord cjk_fallback">çŸ©</span><span class="mord cjk_fallback">é˜µ</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>tan</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mfrac><mtext>è§†åœº</mtext><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">q = \frac{1}{\tan{(\frac{è§†åœº}{2})}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.428771em;vertical-align:-1.1073309999999998em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.2376690000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">tan</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">è§†</span><span class="mord cjk_fallback mtight">åœº</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.1073309999999998em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mi>q</mi><mtext>çºµæ¨ªæ¯”</mtext></mfrac></mrow><annotation encoding="application/x-tex">A = \frac{q}{çºµæ¨ªæ¯”}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">çºµ</span><span class="mord cjk_fallback">æ¨ª</span><span class="mord cjk_fallback">æ¯”</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mfrac><mrow><msub><mi>Z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow><mrow><msub><mi>Z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>âˆ’</mo><msub><mi>Z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">B = \frac{Z_{near}+Z_{far}}{Z_{nead}-Z_{far}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mfrac><mrow><mn>2</mn><msub><mi>Z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub><msub><mi>Z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow><mrow><msub><mi>Z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub><mo>âˆ’</mo><msub><mi>Z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow></mfrac><mrow></mrow></mrow><annotation encoding="application/x-tex">C = \frac{2Z_{near}Z_{far}}{Z_{near}-Z_{far}}{}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"></span></span></span></span></span></p>
<p>GLM åº“æä¾›äº†æ„å»ºé€è§†çŸ©é˜µå‡½æ•° <code>glm::perspective()</code>ã€‚</p>
<h4 id="3-7-2-æ­£å°„æŠ•å½±çŸ©é˜µ">3.7.2 æ­£å°„æŠ•å½±çŸ©é˜µ</h4>
<p>åœ¨æ­£å°„æŠ•å½±ä¸­ï¼Œå¹³è¡Œçº¿ä»ç„¶æ˜¯å¹³è¡Œçš„ã€‚</p>
<p>æ„å»ºæ­£å°„çŸ©é˜µéœ€è¦ä»¥ä¸‹å‚æ•°ï¼š</p>
<ol>
<li>ä»ç›¸æœºåˆ°æŠ•å½±å¹³é¢çš„è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">z_{near}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>ä»ç›¸æœºåˆ°è¿œå‰ªè£å¹³é¢çš„è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">z_{far}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>æŠ•å½±å¹³é¢å·¦è¾¹ç•Œ x åæ ‡ Lï¼Œ æŠ•å½±å¹³é¢å³è¾¹ç•Œ x åæ ‡ Rï¼ŒæŠ•å½±å¹³é¢ä¸Šè¾¹ç•Œ y åæ ‡ Tï¼Œ æŠ•å½±å¹³é¢ä¸‹è¾¹ç•Œ y åæ ‡ B</li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_zhengshe.jpg" alt="æ­£å°„æŠ•å½±ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬2ç‰ˆï¼‰"></p>
<p>æ­£å°„çŸ©é˜µï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>2</mn><mrow><mi>R</mi><mo>âˆ’</mo><mi>L</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mfrac><mrow><mi>R</mi><mo>+</mo><mi>L</mi></mrow><mrow><mi>R</mi><mo>âˆ’</mo><mi>L</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>2</mn><mrow><mi>T</mi><mo>âˆ’</mo><mi>B</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mfrac><mrow><mi>T</mi><mo>+</mo><mi>B</mi></mrow><mrow><mi>T</mi><mo>âˆ’</mo><mi>B</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mo>âˆ’</mo><mn>2</mn></mrow><mrow><msub><mi>z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub><mo>âˆ’</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mfrac><mrow><msub><mi>z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow><mrow><msub><mi>z</mi><mrow><mi>f</mi><mi>a</mi><mi>r</mi></mrow></msub><mo>âˆ’</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(æ­£å°„çŸ©é˜µ)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left[
\begin{matrix}
\frac{2}{R-L} &amp; 0 &amp; 0 &amp; -\frac{R+L}{R-L}\\
0 &amp; \frac{2}{T-B} &amp; 0 &amp; -\frac{T+B}{T-B}\\
0 &amp; 0 &amp; \frac{-2}{z_{far}-z_{near}} &amp; -\frac{z_{far}+z_{near}}{z_{far}-z_{near}}\\
0 &amp; 0 &amp;0 &amp; 1
\end{matrix}
\right]
\tag{æ­£å°„çŸ©é˜µ}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.220815em;vertical-align:-2.3604075em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8604075em;"><span style="top:-4.9880765em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.7124145em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.3876725em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.9995925000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3604075em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8604075em;"><span style="top:-4.9880765em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.7124145em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.3876725em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.9995925000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3604075em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8604075em;"><span style="top:-4.9880765em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.7124145em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.3876725em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29011428571428566em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5480799999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-0.9995925000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3604075em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8604075em;"><span style="top:-4.9880765em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.7124145em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.3876725em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.921411em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29011428571428566em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.51308em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29011428571428566em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5480799999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-0.9995925000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3604075em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:5.220815em;vertical-align:-2.3604075em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord cjk_fallback">æ­£</span><span class="mord cjk_fallback">å°„</span><span class="mord cjk_fallback">çŸ©</span><span class="mord cjk_fallback">é˜µ</span></span><span class="mord">)</span></span></span></span></span></span></p>
<h3 id="3-8-lookatçŸ©é˜µ">3.8 LookAtçŸ©é˜µ</h3>
<p>å½“æŠŠç›¸æœºæ”¾åœ¨æŸå¤„å¹¶çœ‹å‘ä¸€ä¸ªç‰¹å®šçš„ä½ç½®æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ° LookAt çŸ©é˜µã€‚LookAt å˜æ¢ä¾ç„¶ç”±ç›¸æœºæ—‹è½¬å†³å®šã€‚</p>
<p>é€šè¿‡æŒ‡å®šå¤§è‡´æ—‹è½¬æœå‘çš„å‘é‡ï¼ˆå¦‚ä¸–ç•Œç©ºé—´ y è½´ï¼‰ã€‚å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—å‰ç§¯è·å¾—ä¸€ç»„å‘é‡ï¼Œä»£è¡¨ç›¸æœºçš„æ­£é¢ï¼ˆå‘é‡ fwdï¼‰ã€ä¾§é¢ï¼ˆå‘é‡ sideï¼‰ï¼Œä»¥åŠä¸Šé¢ï¼ˆå‘é‡ upï¼‰ã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_lookat.jpg" alt="LookAtå…ƒç´ ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬2ç‰ˆï¼‰"></p>
<p>ç”±ç›¸æœºä½ç½®ï¼ˆç‚¹eyeï¼‰ã€ç›®æ ‡ä½ç½®ï¼ˆç‚¹targetï¼‰ã€åˆå§‹å‘ä¸Šå‘é‡ Y æ„å»º LookAt çŸ©é˜µï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>d</mi><msub><mi>e</mi><mi>x</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>d</mi><msub><mi>e</mi><mi>y</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>z</mi><msub><mi>e</mi><mi>z</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>s</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>â‹…</mo><mi>e</mi><mi>y</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>u</mi><msub><mi>p</mi><mi>x</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>u</mi><msub><mi>p</mi><mi>y</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>u</mi><msub><mi>p</mi><mi>z</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>u</mi><mi>p</mi><mo>â‹…</mo><mi>e</mi><mi>y</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>f</mi><mi>w</mi><msub><mi>d</mi><mi>x</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>f</mi><mi>w</mi><msub><mi>d</mi><mi>y</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>f</mi><mi>w</mi><msub><mi>d</mi><mi>z</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><mo>âˆ’</mo><mi>f</mi><mi>w</mi><mi>d</mi><mo>â‹…</mo><mi>e</mi><mi>y</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(LookAtçŸ©é˜µ)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\left[
\begin{matrix}
side_x &amp; side_y &amp; size_z &amp; -(side\cdot eye)\\
up_x &amp; up_y &amp; up_z &amp; -(up\cdot eye)\\
-fwd_x &amp; -fwd_y &amp; -fwd_z &amp; -(-fwd\cdot eye)\\
0 &amp; 0 &amp;0 &amp; 1
\end{matrix}
\right]
\tag{LookAtçŸ©é˜µ}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">L</span><span class="mord">o</span><span class="mord">o</span><span class="mord">k</span><span class="mord">A</span><span class="mord">t</span><span class="mord cjk_fallback">çŸ©</span><span class="mord cjk_fallback">é˜µ</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>w</mi><mi>d</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mi>e</mi><mi>y</mi><mi>e</mi><mo>âˆ’</mo><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">fwd = normalize(eye-target)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mo>âˆ’</mo><mi>f</mi><mi>w</mi><mi>d</mi><mo>Ã—</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">side = normalize(-fwd \times Y)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>p</mi><mo>=</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mi>s</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mo>âˆ’</mo><mi>f</mi><mi>w</mi><mi>d</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">up = normalize(side \times (-fwd))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="å››-openglç®¡ç†3då›¾å½¢æ•°æ®">å››ã€OpenGLç®¡ç†3Då›¾å½¢æ•°æ®</h2>
<p>ä½¿ç”¨ OpenGL æ¸²æŸ“ä¸€ä¸ª 3D å›¾å½¢ éœ€è¦å°†è‹¥å¹²æ•°æ®å‘é€ç»™ OpenGL ç€è‰²å™¨ç®¡çº¿ã€‚</p>
<p>æ¯”å¦‚ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œéœ€è¦å‘é€ï¼š</p>
<ul>
<li>ç«‹æ–¹ä½“æ¨¡å‹çš„é¡¶ç‚¹ï¼›</li>
<li>æ§åˆ¶ç«‹æ–¹ä½“åœ¨3Dç©ºé—´ä¸­æœå‘çš„å˜æ¢çŸ©é˜µã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œå‘é€æ•°æ®åˆ° OpenGL ç®¡çº¿çš„æ–¹å¼æœ‰ï¼š</p>
<ul>
<li>é€šè¿‡é¡¶ç‚¹å±æ€§çš„ <strong>ç¼“å†²åŒº</strong>ï¼›</li>
<li>ç›´æ¥å‘é€ç»™ <strong>ç»Ÿä¸€å˜é‡</strong>ã€‚</li>
</ul>
<h3 id="4-1-ç¼“å†²åŒºå’Œé¡¶ç‚¹å±æ€§">4.1 ç¼“å†²åŒºå’Œé¡¶ç‚¹å±æ€§</h3>
<p>ç»˜åˆ¶å¯¹è±¡æ—¶ï¼Œå®ƒçš„é¡¶ç‚¹æ•°æ®éœ€è¦å‘é€ç»™é¡¶ç‚¹ç€è‰²å™¨ã€‚é€šå¸¸ï¼š</p>
<ol>
<li>é¡¶ç‚¹æ•°æ®è¢«å‘é€åˆ°ä¸€ä¸ªç¼“å†²åŒºä¸­ï¼›</li>
<li>æŠŠç¼“å†²åŒºå’Œç€è‰²å™¨ä¸­å£°æ˜çš„é¡¶ç‚¹å±æ€§ç›¸å…³è”ã€‚</li>
</ol>
<p>å®Œæˆè¿™ä»¶äº‹ï¼Œæœ‰ä¸€ç³»åˆ—çš„æ­¥éª¤ï¼Œæœ‰çš„æ­¥éª¤åªéœ€è¦åšä¸€æ¬¡ï¼Œæœ‰çš„æ­¥éª¤æ¯å¸§éƒ½éœ€åšä¸€æ¬¡ï¼š</p>
<ul>
<li>åªåšä¸€æ¬¡çš„æ­¥éª¤ï¼š
<ol>
<li>åˆ›å»ºç¼“å†²åŒº</li>
<li>å°†é¡¶ç‚¹æ•°æ®å¤åˆ¶åˆ°ç¼“å†²åŒº</li>
</ol>
</li>
<li>æ¯å¸§åˆ·æ–°éœ€è¦çš„æ­¥éª¤ï¼š
<ol>
<li>å¯ç”¨åŒ…å«é¡¶ç‚¹æ•°æ®çš„ç¼“å†²åŒº</li>
<li>å°†ç¼“å†²åŒºå’Œä¸€ä¸ªé¡¶ç‚¹å±æ€§ç›¸å…³è”</li>
<li>å¯ç”¨è¿™ä¸ªé¡¶ç‚¹å±æ€§</li>
<li>ä½¿ç”¨ <code>glDrawArrays()</code> ç»˜åˆ¶å¯¹è±¡</li>
</ol>
</li>
</ul>
<p>åœ¨ OpenGL ä¸­ï¼Œç¼“å†²åŒºè¢«åŒ…å«åœ¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼ˆVertex Buffer Objectï¼ŒVBOï¼‰ä¸­ï¼ŒVBO åœ¨ C++/OpenGL åº”ç”¨ç¨‹åºä¸­è¢«å£°æ˜å’Œå®ä¾‹åŒ–ã€‚ä¸€ä¸ªåœºæ™¯å¯èƒ½éœ€è¦å¾ˆå¤š VBOï¼Œæ‰€ä»¥å¸¸å¸¸ä¼šåœ¨ä¸€ä¸ªåœ°æ–¹ä¸­ç”Ÿæˆå¹¶å¡«å……è‹¥å¹²ä¸ª VBOï¼Œä»¥å¤‡ç¨‹åºéœ€è¦æ—¶ç›´æ¥ä½¿ç”¨ã€‚</p>
<p>ç¼“å†²åŒºä½¿ç”¨ç‰¹å®šçš„æ–¹å¼å’Œé¡¶ç‚¹å±æ€§äº¤äº’ã€‚å½“ <code>glDrawArrays()</code> æ‰§è¡Œæ—¶ï¼Œç¼“å†²åŒºä¸­çš„æ•°æ®å¼€å§‹æµåŠ¨ï¼Œä»ç¼“å†²åŒºçš„å¼€å¤´å¼€å§‹ï¼ŒæŒ‰é¡ºåºæµè¿‡é¡¶ç‚¹ç€è‰²å™¨ï¼Œé¡¶ç‚¹ç€è‰²å™¨å¯¹æ¯ä¸ªé¡¶ç‚¹æ‰§è¡Œä¸€æ¬¡ã€‚</p>
<p>OpenGL ä¸­è¿˜æœ‰ä¸€ç§ç›¸å…³çš„ç»“æ„ï¼Œå«ä½œé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼ˆVertex Array Objectï¼ŒVAOï¼‰ã€‚OpenGLçš„ 3.0 ç‰ˆæœ¬å¼•å…¥äº† VAOï¼Œä½œä¸ºä¸€ç§ç»„ç»‡ç¼“å†²åŒºçš„æ–¹æ³•ï¼Œè®©ç¼“å†²åŒºåœ¨å¤æ‚åœºæ™¯ä¸­æ›´å®¹æ˜“æ“æ§ã€‚OpenGL è¦æ±‚è‡³å°‘åˆ›å»ºä¸€ä¸ª VAOã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æƒ³æ˜¾ç¤ºä¸¤ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå£°æ˜ä¸€ä¸ª VAO å’Œä¸¤ä¸ªç›¸å…³çš„ VBOï¼š</p>
<pre><code class="language-cpp">GLuint vao[1];
GLuint vbo[2];
// â€¦â€¦
glGenVertexArrays(1, vao);
glBindVertexArray(vao[0]);
glGenBuffers(2, vbo);
</code></pre>
<ul>
<li><code>glGenVertexArrays()</code>ï¼šç”Ÿæˆä¸€ä¸ª VAOï¼Œè¿”å› VAO çš„æ•´å‹ ID å¹¶å°†å­˜åˆ°vao
<ul>
<li>ç¬¬ä¸€å‚æ•°è¡¨ç¤ºåˆ›å»º ID ä¸ªæ•°</li>
<li>ç¬¬äºŒå‚æ•°è¡¨ç¤ºä¿å­˜è¿”å› ID çš„æ•°ç»„</li>
</ul>
</li>
<li><code>glBindVertexArray()</code>ï¼šå°† vao[0] è®¾ä¸ºå½“å‰å¯¹è±¡ï¼Œè¿™æ ·ç”Ÿæˆçš„ç¼“å†²åŒºå°±ä¼šå’Œè¿™ä¸ª VAO ç›¸å…³è”</li>
<li><code>glGenBuffers()</code>ï¼šç”Ÿæˆä¸¤ä¸ª VBOï¼Œè¿”å› VBO çš„æ•´å‹ ID å¹¶å°†å®ƒä»¬å­˜åˆ°vbo
<ul>
<li>ç¬¬ä¸€å‚æ•°è¡¨ç¤ºåˆ›å»º ID ä¸ªæ•°</li>
<li>ç¬¬äºŒå‚æ•°è¡¨ç¤ºä¿å­˜è¿”å› ID çš„æ•°ç»„</li>
</ul>
</li>
</ul>
<p>ç¼“å†²åŒºå¤§æ¦‚å®Œæˆä¹‹åï¼Œé¡¶ç‚¹ç€è‰²å™¨éœ€è¦æœ‰ç›¸åº”åœ°é¡¶ç‚¹å±æ€§å˜é‡ã€‚å¦‚ï¼š</p>
<pre><code class="language-cpp">layout (location = 0) in vec3 position;
</code></pre>
<ul>
<li><code>layout (location = 0)</code>ï¼šlayoutä¿®é¥°ç¬¦ï¼Œé¡¶ç‚¹å±æ€§å’Œç‰¹å®šç¼“å†²åŒºå…³è”çš„æ–¹æ³•ï¼Œè¿™é‡Œè¡¨ç¤ºé¡¶ç‚¹å±æ€§çš„è¯†åˆ«å·æ˜¯0</li>
<li><code>in</code>ï¼šè¡¨ç¤ºé¡¶ç‚¹å±æ€§å°†ä¼šä»ç¼“å†²åŒºä¸­æ¥æ”¶æ•°å€¼</li>
<li><code>vec3</code>ï¼šè¡¨ç¤ºé¡¶ç‚¹å±æ€§çš„ç±»å‹æ˜¯ä¸‰ç»´å‘é‡</li>
<li><code>position</code>ï¼šé¡¶ç‚¹å±æ€§çš„åå­—</li>
</ul>
<p>ç»§ç»­å‡è®¾ç»˜åˆ¶ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œå‡å®šç«‹æ–¹ä½“çš„é¡¶ç‚¹æ•°æ®åœ¨ä»£ç ä¸­ç”¨æ•°ç»„ç›´æ¥æŒ‡å®šï¼Œè¿˜éœ€è¦è¿›è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>å°†é¡¶ç‚¹æ•°æ®å€¼å¤åˆ¶åˆ°ä¹‹å‰ç”Ÿæˆçš„ä¸¤ä¸ªç¼“å†²åŒºä¹‹ä¸€ã€‚ä½¿ç”¨ OpenGL çš„å‡½æ•° <code>glBindBuffer()</code> å°†ç¼“å†²åŒºæ ‡ä¸ºæ´»è·ƒï¼ˆä½¿ç”¨ï¼‰</li>
<li>ä½¿ç”¨ <code>glBufferData()</code> å‡½æ•°å°†åŒ…å«é¡¶ç‚¹æ•°æ®çš„æ•°ç»„å¤åˆ¶è¿›æ´»è·ƒç¼“å†²åŒº</li>
</ol>
<pre><code class="language-cpp">glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);
</code></pre>
<p>ä¸Šè¿°æ˜¯åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡çš„æ­¥éª¤ï¼Œæ¥ä¸‹æ¥å¯¹äºæ¯ä¸€å¸§åˆ·æ–°ï¼Œéœ€è¦è¿›è¡Œï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>glBindBuffer()</code> å‡½æ•°æ ‡è®°ç¼“å†²åŒºä¸ºæ´»è·ƒ</li>
<li>å°†æ´»è·ƒç¼“å†²åŒºä¸ç€è‰²å™¨ä¸­çš„é¡¶ç‚¹å±æ€§ç›¸å…³è”</li>
<li>å¯ç”¨é¡¶ç‚¹å±æ€§</li>
</ol>
<pre><code class="language-cpp">// æ ‡è®°ç¬¬0ä¸ªç¼“å†²åŒºä¸ºæ´»è·ƒ
glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
// å°†ç¬¬0ä¸ªå±æ€§å…³è”åˆ°ç¼“å†²åŒº
glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);
// å¯ç”¨ç¬¬0ä¸ªé¡¶ç‚¹å±æ€§
glEnableVertexAttribArray(0);
</code></pre>
<h3 id="4-2-ç»Ÿä¸€å˜é‡">4.2 ç»Ÿä¸€å˜é‡</h3>
<p>ä½¿ç”¨å…³é”®å­— <code>uniform</code> åœ¨ç€è‰²å™¨ä¸­å£°æ˜ç»Ÿä¸€å˜é‡ã€‚</p>
<p>å°†æ•°æ®ä» C++/OpenGL åº”ç”¨ç¨‹åºå‘é€åˆ°ç»Ÿä¸€å˜é‡éœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>è·å–ç»Ÿä¸€å˜é‡çš„å¼•ç”¨</li>
<li>å°†æŒ‡å‘æ‰€éœ€æ•°å€¼çš„æŒ‡é’ˆä¸è·å–çš„ç»Ÿä¸€å˜é‡å¼•ç”¨ç›¸å…³è”</li>
</ol>
<p>æ¯”å¦‚åœ¨ä¸Šé¢ç»˜åˆ¶ç«‹æ–¹ä½“çš„ä¾‹å­ï¼Œå‡è®¾é“¾æ¥çš„æ¸²æŸ“ç¨‹åºä¿å­˜åœ¨åä¸º <code>rendering</code> çš„å˜é‡ä¸­ï¼Œåˆ™ä»¥ä¸‹ä»£ç ä¼šæŠŠ MV å’ŒæŠ•å½±çŸ©é˜µå‘é€åˆ°ä¸¤ä¸ªç»Ÿä¸€å˜é‡ä¸­ï¼š</p>
<pre><code class="language-cpp">// è·å–ç€è‰²å™¨ç¨‹åºä¸­çš„ç»Ÿä¸€å˜é‡ä½ç½®
mvLoc = glGetUniformLocation(rendering, "mv_m");
projLoc = glGetUniformLocation(rendering, "proj_m");
// å°†çŸ©é˜µæ•°æ®å‘é€åˆ°ç»Ÿä¸€å˜é‡ä¸­
glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mv));
glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(proj));
// mv æ˜¯æ¨¡å‹è§†å›¾çŸ©é˜µï¼Œproj æ˜¯æŠ•å½±çŸ©é˜µ
</code></pre>
<p><em><code>value_ptr()</code> è¿”å›å¯¹çŸ©é˜µæ•°æ®çš„å¼•ç”¨ï¼Œ <code>glUniformMatrix4fv()</code> å°†çŸ©é˜µæ•°æ®ä¼ é€’ç»™ç»Ÿä¸€å˜é‡</em></p>
<h3 id="4-3-é¡¶ç‚¹å±æ€§æ’å€¼">4.3 é¡¶ç‚¹å±æ€§æ’å€¼</h3>
<p>åœ¨ç‰‡æ®µç€è‰²å™¨æ …æ ¼åŒ–ä¹‹å‰ï¼Œç”±é¡¶ç‚¹å®šä¹‰çš„å›¾å…ƒè¢«è½¬æ¢ä¸ºç‰‡æ®µã€‚</p>
<ul>
<li>æ …æ ¼åŒ–ï¼šå°† 3D ç©ºé—´ä¿¡æ¯è¡¨è¾¾åœ¨ 2D å±å¹•çš„æ …æ ¼ï¼ˆåƒç´ é˜µåˆ—ï¼‰ä¸­ã€‚</li>
<li>æ …æ ¼åŒ–è¿‡ç¨‹ä¼šçº¿æ€§æ’å€¼é¡¶ç‚¹å±æ€§å€¼ï¼Œä»¥ä¾¿æ˜¾ç¤ºçš„åƒç´ èƒ½æ— ç¼è¿æ¥å»ºæ¨¡åçš„æ›²é¢ã€‚</li>
<li>æ¯”å¦‚æ …æ ¼åŒ–ä¸€ä¸ªä¸‰è§’å½¢æ—¶ï¼Œå°†ä¸‰è§’å½¢é¡¶ç‚¹ä¼ å…¥ï¼Œé¦–å…ˆæ²¿ç€è¿æ¥é¡¶ç‚¹çš„çº¿å¼€å§‹æ’å€¼ï¼Œå…¶ç²¾åº¦çº§åˆ«å’Œåƒç´ æ˜¾ç¤ºå¯†åº¦ç›¸å…³ã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_rasterized.png" alt="ä¸‰è§’å½¢æ …æ ¼åŒ–"></p>
<p>è€Œç»Ÿä¸€å˜é‡åœ¨æ¯æ¬¡é¡¶ç‚¹ç€è‰²å™¨è°ƒç”¨æ—¶ä¿æŒä¸å˜ï¼Œæœ¬èº«ä¸æ˜¯æ’å€¼çš„ï¼Œæ— è®ºé¡¶ç‚¹æ•°é‡æœ‰å¤šå°‘ï¼Œå˜é‡éƒ½åŒ…å«ç›¸åŒçš„å€¼ã€‚</p>
<p>é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œé¡¶ç‚¹å±æ€§è¢«å£°æ˜ä¸º <code>in</code>ï¼Œè¡¨ç¤ºä»ç¼“å†²åŒºæ¥æ”¶ï¼Œä¹Ÿå¯ä»¥è¢«å£°æ˜ä¸º <code>out</code>ï¼Œè¡¨ç¤ºå€¼å‘é€åˆ°ç®¡çº¿çš„ä¸‹ä¸€é˜¶æ®µã€‚</p>
<p>OpenGL å†…ç½®ä¸€ä¸ª <code>vec4</code> å˜é‡ <code>gl_Position</code>ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œå°†çŸ©é˜µå˜æ¢åçš„é¡¶ç‚¹èµ‹å€¼ç»™å®ƒï¼š</p>
<pre><code class="language-cpp">gl_Position = proj_matrix * mv_matrix * position;
</code></pre>
<h3 id="4-4-mv-çŸ©é˜µå’Œé€è§†çŸ©é˜µ">4.4 MV çŸ©é˜µå’Œé€è§†çŸ©é˜µ</h3>
<p>æ¸²æŸ“ 3D å¯¹è±¡çš„ä¸€ä¸ªåŸºç¡€æ­¥éª¤æ˜¯åˆ›å»ºé€‚å½“çš„å˜æ¢çŸ©é˜µå¹¶å°†å®ƒä»¬å‘é€åˆ°ç»Ÿä¸€å˜é‡ã€‚</p>
<ul>
<li>æ¨¡å‹çŸ©é˜µï¼šåœ¨ä¸–ç•Œç©ºé—´ä¸­è¡¨ç¤ºå¯¹è±¡çš„ä½ç½®å’Œæœå‘ã€‚</li>
<li>è§†å›¾çŸ©é˜µï¼šç§»åŠ¨å¹¶æ—‹è½¬ä¸–ç•Œä¸­çš„æ¨¡å‹ï¼Œä»¥æ¨¡æ‹Ÿç›¸æœºçœ‹åˆ°çš„æ•ˆæœã€‚</li>
<li>é€è§†çŸ©é˜µï¼šæ ¹æ®æ‰€éœ€çš„è§†é”¥æä¾› 3D æ•ˆæœã€‚</li>
</ul>
<p>å‡è®¾æ¨¡å‹æ˜¯å˜åŠ¨çš„ï¼Œç›¸æœºæ˜¯å¯ç§»åŠ¨çš„ï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>éœ€è¦æ¯å¸§ä¸ºæ¯ä¸ªæ¨¡å‹åˆ›å»ºæ¨¡å‹çŸ©é˜µï¼›</li>
<li>éœ€è¦æ¯å¸§åˆ›å»ºè§†å›¾çŸ©é˜µï¼Œå¯¹äºè¿™ä¸€å¸§æ‰€æ¸²æŸ“çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸€è‡´çš„ï¼›</li>
<li>éœ€è¦åˆ›å»ºä¸€æ¬¡é€è§†çŸ©é˜µï¼Œç¡®å®šè§†é”¥ã€‚</li>
</ul>
<h3 id="4-5-æ„å»ºä¸€ä¸ª-3d-ç«‹æ–¹ä½“">4.5 æ„å»ºä¸€ä¸ª 3D ç«‹æ–¹ä½“</h3>
<p>ç”±äº OpenGL ä»£ç ç¹å¤šï¼Œéœ€è¦å¤„ç†å¤šæ–‡ä»¶ï¼Œç»™å‡ºæ–‡ä»¶ç»“æ„ï¼š</p>
<pre><code>OpenGLé¡¹ç›®
â”œâ”€ main.cpp        // ä¸»ç¨‹åº
â”œâ”€ fragment.glsl   // ç‰‡æ®µç€è‰²å™¨
â”œâ”€ vertex.glsl     // é¡¶ç‚¹ç€è‰²å™¨
â”œâ”€ Util.h          // å¸¸ç”¨å‡½æ•°çš„å£°æ˜
â””â”€ Util.cpp        // å¸¸ç”¨å‡½æ•°çš„å®ç°
</code></pre>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_greenCube.jpg" alt="ç»¿è‰²çš„ç«‹æ–¹ä½“"></p>
<details><summary>æºä»£ç main.cpp</summary>
<pre><code class="language-cpp">// main.cpp

#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 1;
GLuint vao[numVAO], vbo[numVBO];

double cameraX, cameraY, cameraZ;
double cubeLocX, cubeLocY, cubeLocZ;
float aspect;

GLuint mvLoc, projLoc;
int width, height;
glm::mat4 pMat, vMat, mMat, mvMat;

void makeVertexArray()
{
    float vertexs[108] = {
        -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
        -1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
         1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
    };

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]); // ç”Ÿæˆçš„ç¼“å†²åŒºå’Œ VAO ç›¸å…³è”

    glGenBuffers(numVBO, vbo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]); // å°†ç¼“å†²åŒºæ ‡ä¸ºæ´»è·ƒï¼ˆä½¿ç”¨ï¼‰
    // å°†åŒ…å«é¡¶ç‚¹æ•°æ®çš„æ•°ç»„å¤åˆ¶è¿›æ´»è·ƒç¼“å†²åŒº
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertexs), vertexs, GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 8.0f;
    cubeLocX = 0.0f, cubeLocY = -2.0f, cubeLocZ = 0.0f;    // æ²¿ y è½´ä¸‹ç§»å±•ç¤ºé€è§†
    makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glUseProgram(renderProgram);

    // è·å– MV çŸ©é˜µ å’ŒæŠ•å½±çŸ©é˜µçš„ç»Ÿä¸€å˜é‡
    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    // æ„å»ºé€è§†çŸ©é˜µ
    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 100.0f);
    // å‚æ•°ä¸ºï¼šè§†è§’ï¼Œå®½é«˜æ¯”ï¼Œè¿‘è£å‰ªé¢ï¼Œè¿œè£å‰ªé¢

    // æ„å»ºè§†å›¾çŸ©é˜µã€æ¨¡å‹çŸ©é˜µå’Œ MV çŸ©é˜µ
    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(cubeLocX, cubeLocY, cubeLocZ));
    mvMat = vMat * mMat;

    // å°†çŸ©é˜µå¤åˆ¶ç»™ç›¸åº”çš„ç»Ÿä¸€å˜é‡
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

    // å°† VBO å…³è”ç»™é¡¶ç‚¹ç€è‰²å™¨ä¸­ç›¸åº”çš„é¡¶ç‚¹å±æ€§
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    // è°ƒæ•´ OpenGL è®¾ç½®ï¼Œç»˜åˆ¶æ¨¡å‹
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, 36);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Cube", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
<p>è§£é‡Š <code>main.cpp</code>ï¼š</p>
<ul>
<li>å‡½æ•° <code>makeVertexArray()</code>
<ul>
<li>åˆ›å»ºé¡¶ç‚¹æ•°ç»„ï¼Œä½¿ç”¨ä¸‰è§’å½¢ç»˜åˆ¶ç«‹æ–¹ä½“ï¼Œæ¯ä¸ªé¢éœ€è¦ä¸¤ä¸ªä¸‰è§’å½¢ï¼Œå…±éœ€è¦12ä¸ªä¸‰è§’å½¢ï¼Œæœ‰36ä¸ªé¡¶ç‚¹ï¼Œåˆ36Ã—3=108ä¸ªåæ ‡ï¼ˆå€¼ï¼‰ã€‚</li>
<li>ç«‹æ–¹ä½“å®šä¹‰åœ¨è‡ªå·±çš„åæ ‡ç³»ä¸Šï¼Œä¸­å¿ƒä¸º(0,0,0)ã€‚</li>
<li>å»ºç«‹ä¸€ä¸ª VAO å’Œ VBOï¼Œå¹¶æŠŠç«‹æ–¹ä½“é¡¶ç‚¹åŠ è½½åˆ°VBOä¸­ã€‚</li>
</ul>
</li>
<li>å‡½æ•° <code>init()</code>
<ul>
<li>è¯»å–ç€è‰²å™¨ä»£ç å¹¶æ„å»ºæ¸²æŸ“ç¨‹åºã€‚</li>
<li>å°†ç«‹æ–¹ä½“é€šè¿‡å‡½æ•° <code>makeVertexArray()</code> åŠ è½½åˆ° VBO ä¸­ã€‚</li>
<li>å®šä¹‰ç«‹æ–¹ä½“å’Œç›¸æœºåœ¨ä¸–ç•Œä¸­çš„ä½ç½®ï¼š(0,0,8)å’Œ(0,-2,0)ã€‚</li>
</ul>
</li>
<li>å‡½æ•° <code>display()</code>
<ul>
<li>ä¸æ–­é‡ç»˜å¸§ã€‚</li>
<li>è°ƒç”¨ <code>glClear(GL_DEPTH_BUFFER_BIT)</code> æ¸…é™¤æ·±åº¦ç¼“å†²åŒºã€‚</li>
<li>è°ƒç”¨ <code>glUseProgram()</code> å¯ç”¨ç€è‰²å™¨ï¼Œåœ¨ GPU ä¸ŠåŠ è½½ GLSL ä»£ç ï¼Œä½†ä¸ä¼šè¿è¡Œç€è‰²å™¨ç¨‹åºã€‚</li>
<li>è·å–ç»Ÿä¸€å˜é‡ä½ç½®ï¼Œæ„å»ºé€è§†ã€è§†å›¾çŸ©é˜µå’Œæ¨¡å‹çŸ©é˜µï¼Œå¹¶åˆæˆ MV çŸ©é˜µã€‚
<ul>
<li>ä½¿ç”¨ <code>glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));</code> æ„å»ºè§†å›¾çŸ©é˜µã€‚ä¸ºäº†æ¨¡æ‹Ÿä»¥æŸç§æ–¹å¼ç§»åŠ¨çš„ç›¸æœºçš„è¡¨ç°ï¼Œéœ€è¦å‘ç›¸åçš„æ–¹å‘ç§»åŠ¨ç‰©ä½“æœ¬èº«ã€‚</li>
<li>ä½¿ç”¨ <code>glm::translate(glm::mat4(1.0f), glm::vec3(cubeLocX, cubeLocY, cubeLocZ));</code> æ„å»ºæ¨¡å‹çŸ©é˜µã€‚</li>
</ul>
</li>
<li>å°†é€è§†çŸ©é˜µå’Œ MV çŸ©é˜µèµ‹ç»™ç›¸åº”çš„ç»Ÿä¸€å˜é‡ã€‚</li>
<li>å¯ç”¨ç«‹æ–¹ä½“é¡¶ç‚¹æ•°æ®çš„ç¼“å†²åŒºï¼Œå¹¶å°†å…¶é™„åŠ åˆ°ç¬¬0ä¸ªé¡¶ç‚¹å±æ€§ã€‚</li>
<li>è°ƒç”¨ <code>glDrawArrays()</code> ç»˜åˆ¶æ¨¡å‹ã€‚</li>
</ul>
</li>
</ul>
</details>
<details><summary>Util.h</summary>
<pre><code class="language-cpp">// Util.h

#pragma once

#include &lt;GL/glew.h&gt;
#include &lt;GLFW/glfw3.h&gt;
#include &lt;SOIL2/soil2.h&gt;
#include &lt;glm/glm.hpp&gt;
#include &lt;glm/gtc/type_ptr.hpp&gt;
#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;cmath&gt;
#include &lt;vector&gt;

class Util
{
public:
    static std::string readShaderSource(const std::string &amp;path);
    static void printShaderLog(GLuint shader);
    static void printProgramLog(GLuint program);
    static bool checkOpenGLerror();

    static GLuint createShadeProgram(const std::string vpath, const std::string fpath);
};
</code></pre>
</details>
<details><summary>Util.cpp</summary>
<pre><code class="language-cpp">// Util.cpp

#include "Util.h"

/*
* ä»æ–‡ä»¶ä¸­è¯»å– GLSL ä»£ç 
* @param path æ–‡ä»¶è·¯å¾„
*/
std::string Util::readShaderSource(const std::string &amp;path)
{
    std::string content = "";
    std::ifstream fileStream(path, std::ios::in);
    std::string line = "";
    while (!fileStream.eof())
    {
        getline(fileStream, line);
        content.append(line + "\n");
    }
    fileStream.close();
    return content;
}

/*
* å½“ GLSL ä»£ç ç¼–è¯‘å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param shader ç€è‰²å™¨æ ‡è¯†
*/
void Util::printShaderLog(GLuint shader)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetShaderInfoLog(shader, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Shader Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* å½“ GLSL é“¾æ¥å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param program ç€è‰²å™¨ç¨‹åºæ ‡è¯†
*/
void Util::printProgramLog(GLuint program)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetProgramiv(program, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetProgramInfoLog(program, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Program Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* æ£€æŸ¥ OpenGL é”™è¯¯æ ‡å¿—ï¼Œå³æ˜¯å¦å‘ç”Ÿ OpenGL é”™è¯¯
*/
bool Util::checkOpenGLerror()
{
    bool err = false;
    int glErr = glGetError();
    while (glErr != GL_NO_ERROR)
    {
        std::cout &lt;&lt; "glError: " &lt;&lt; glErr &lt;&lt; "\n";
        err = true;
        glErr = glGetError();
    }
    return err;
}

/*
* åˆ›å»ºç€è‰²å™¨ç¨‹åº
* @param vpath é¡¶ç‚¹ç€è‰²å™¨è·¯å¾„
* @param fpath ç‰‡æ®µç€è‰²å™¨è·¯å¾„
*/
GLuint Util::createShadeProgram(const std::string vpath, const std::string fpath)
{
    // è®°å½•é”™è¯¯ä¿¡æ¯
    GLint vertCompiled, fragCompiled, linked;

    // é¡¶ç‚¹ç€è‰²å™¨
    std::string vs = readShaderSource(vpath);
    // ç‰‡æ®µç€è‰²å™¨
    std::string fs = readShaderSource(fpath);
    const char *vshaderSource = vs.c_str();
    const char *fshaderSource = fs.c_str();

    // åˆ†åˆ«å­˜å…¥ vShader å’Œ fShader å˜é‡
    GLuint vShader = glCreateShader(GL_VERTEX_SHADER);
    GLuint fShader = glCreateShader(GL_FRAGMENT_SHADER);

    // å°† GLSL ä»£ç ä»å­—ç¬¦ä¸²è½½å…¥ç©ºç€è‰²å™¨å¯¹è±¡ä¸­
    glShaderSource(vShader, 1, &amp;vshaderSource, NULL);
    glShaderSource(fShader, 1, &amp;fshaderSource, NULL);

    // ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨
    glCompileShader(vShader);
    checkOpenGLerror();
    glGetShaderiv(vShader, GL_COMPILE_STATUS, &amp;vertCompiled);
    if (vertCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "vertex compilation failed\n";
        printShaderLog(vShader);
    }
    // ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨
    glCompileShader(fShader);
    checkOpenGLerror();
    glGetShaderiv(fShader, GL_COMPILE_STATUS, &amp;fragCompiled);
    if (fragCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "fragment compilation failed\n";
        printShaderLog(fShader);
    }

    GLuint vProgram = glCreateProgram();
    glAttachShader(vProgram, vShader);
    glAttachShader(vProgram, fShader);
    glLinkProgram(vProgram);
    checkOpenGLerror();
    glGetProgramiv(vProgram, GL_LINK_STATUS, &amp;linked);
    if (linked == GL_FALSE)
    {
        std::cout &lt;&lt; "linking failed\n";
        printProgramLog(vProgram);
    }

    return vProgram; // è¿”å›ç€è‰²å™¨ç¨‹åºID
}
</code></pre>
</details>
<details><summary>vertex.glsl å’Œ fragment.glsl</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 position;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

void main()
{
    gl_Position = proj_matrix * mv_matrix * vec4(position, 1.0);
}
</code></pre>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

out vec4 color;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

void main()
{
    color = vec4(0, 0.6, 0, 1.0);
}
</code></pre>
<p>å…³äºç€è‰²å™¨æ–¹é¢</p>
<ul>
<li>ç€è‰²å™¨ä¸­ä¼ å…¥çš„é¡¶ç‚¹å±æ€§çš„ <code>position</code> å˜é‡ä¸Šå­˜åœ¨ã€‚<code>layout</code> ä¿®é¥°ç¬¦ï¼Œä½ç½®æŒ‡å®šä¸ºâ€œ0â€ï¼Œå› æ­¤ <code>display()</code> å‡½æ•°å¯ä»¥ç®€å•åœ°é€šè¿‡åœ¨ <code>glVertexAttribPointer()</code> å‡½æ•°è°ƒç”¨ä¸­ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰å’Œåœ¨ <code>glEnableVertexAttribArray()</code> å‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨ 0 æ¥å¼•ç”¨æ­¤å˜é‡ã€‚</li>
<li><code>position</code> é¡¶ç‚¹å±æ€§è¢«å£°æ˜ä¸º <code>vec3</code> ç±»å‹ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸º <code>vec4</code> ç±»å‹ï¼Œç”± <code>vec4(position,1.0)</code> å®Œæˆã€‚</li>
<li>é¡¶ç‚¹ç€è‰²å™¨ä¸­çš„ä¹˜æ³•å°†çŸ©é˜µå˜æ¢åº”ç”¨äºé¡¶ç‚¹ï¼Œå°†å…¶è½¬æ¢ä¸ºç›¸æœºç©ºé—´ï¼Œæ¥ç€è¢«æ”¾å…¥å†…ç½®çš„ OpenGL è¾“å‡ºå˜é‡ <code>gl_Position</code> ä¸­ï¼Œç„¶åç»§ç»­é€šè¿‡ç®¡çº¿ï¼Œå¹¶ç”±å…‰æ …ç€è‰²å™¨è¿›è¡Œæ’å€¼ã€‚</li>
<li>æ’å€¼åçš„åƒç´ ä½ç½®ï¼ˆç§°ä¸ºç‰‡æ®µï¼‰è¢«å‘é€åˆ°ç‰‡æ®µç€è‰²å™¨ã€‚
<ul>
<li>ç‰‡æ®µç€è‰²å™¨ä¸­ä¹Ÿæœ‰ä¸¤ä¸ªç»Ÿä¸€å˜é‡ï¼Œä½†åœ¨è¯¥ç€è‰²å™¨ä¸­å°šæœªä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
</details>
<details><summary>é€šè¿‡ä¿®æ”¹ç€è‰²å™¨ï¼Œå®ç°å½©è‰²ç«‹æ–¹ä½“</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 position;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

out vec4 changingColor;

void main()
{
    gl_Position = proj_matrix * mv_matrix * vec4(position, 1.0);
    changingColor = vec4(position, 1.0) * 0.5 + vec4(0.5, 0.5, 0.5, 0.5);
}
</code></pre>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

in vec4 changingColor;

out vec4 color;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

void main()
{
    color = changingColor;
}
</code></pre>
</details>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_coloredCube.jpg" alt="å½©è‰²ç«‹æ–¹ä½“"></p>
<p>åŒæ ·åœ°ï¼Œä¹Ÿå¯ä»¥è®©ç«‹æ–¹ä½“åŠ¨èµ·æ¥ï¼Œåªéœ€è¦åœ¨åˆ·æ–°çš„æ¯ä¸€å¸§åŠ ä¸Šå¹³ç§»å˜æ¢å’Œæ—‹è½¬å˜æ¢ï¼š</p>
<details><summary>å±•å¼€ä»£ç </summary>
<pre><code class="language-cpp">// â€¦â€¦

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    // è·å– MV çŸ©é˜µ å’ŒæŠ•å½±çŸ©é˜µçš„ç»Ÿä¸€å˜é‡
    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    // æ„å»ºé€è§†çŸ©é˜µ
    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 100.0f);
    // å‚æ•°ä¸ºï¼šè§†è§’ï¼Œå®½é«˜æ¯”ï¼Œè¿‘è£å‰ªé¢ï¼Œè¿œè£å‰ªé¢

    // ä¸€ç³»åˆ—æ—‹è½¬å˜æ¢çŸ©é˜µ
    glm::mat tMat = glm::translate(glm::mat4(1.0f), glm::vec3(sin(0.35f * currentTime) * 2.0f, cos(0.52f * currentTime) * 2.0f, sin(0.7f * currentTime) * 2.0f));
    glm::mat rMat = glm::rotate(glm::mat4(1.0f), 1.75f * static_cast&lt;float&gt;(currentTime), glm::vec3(0.0f, 1.0f, 0.0f));
    rMat = glm::rotate(rMat, 1.75f * static_cast&lt;float&gt;(currentTime), glm::vec3(1.0f, 0.0f, 0.0f));
    rMat = glm::rotate(rMat, 1.75f * static_cast&lt;float&gt;(currentTime), glm::vec3(0.0f, 0.0f, 1.0f));

    // æ„å»ºè§†å›¾çŸ©é˜µã€æ¨¡å‹çŸ©é˜µå’Œ MV çŸ©é˜µ
    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    //mMat = glm::translate(glm::mat4(1.0f), glm::vec3(cubeLocX, cubeLocY, cubeLocZ));
    mMat = rMat * tMat;
    mvMat = vMat * mMat;

    // å°†çŸ©é˜µå¤åˆ¶ç»™ç›¸åº”çš„ç»Ÿä¸€å˜é‡
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

    // å°† VBO å…³è”ç»™é¡¶ç‚¹ç€è‰²å™¨ä¸­ç›¸åº”çš„é¡¶ç‚¹å±æ€§
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    // è°ƒæ•´ OpenGL è®¾ç½®ï¼Œç»˜åˆ¶æ¨¡å‹
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, 36);
}

// â€¦â€¦
</code></pre>
</details>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_coloredCube1.gif" alt="æ—‹è½¬çš„ç«‹æ–¹ä½“"></p>
<h3 id="4-6-æ¸²æŸ“ä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå‰¯æœ¬">4.6 æ¸²æŸ“ä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå‰¯æœ¬</h3>
<p>ä¸Šé¢å®ç°äº†ä¸€ä¸ªç¿»æ»šçš„ç«‹æ–¹ä½“ï¼Œæ¥ç€å¯ä»¥è€ƒè™‘å®ç°å¤šä¸ªç¿»æ»šçš„ç«‹æ–¹ä½“ã€‚</p>
<p>å¯ä»¥å°† <code>display()</code> å‡½æ•°ä¸­ç”¨äºæ„å»º MV çŸ©é˜µå¹¶ç»˜åˆ¶ç«‹æ–¹ä½“çš„ä»£ç ç§»åŠ¨åˆ°ä¸€ä¸ªæ‰§è¡Œ 24 æ¬¡çš„å¾ªç¯ä¸­æ¥å®Œæˆæ­¤æ“ä½œã€‚</p>
<details><summary>å±•å¼€ä»£ç </summary>
<pre><code class="language-cpp">void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 32.0f;
    makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    // è·å– MV çŸ©é˜µ å’ŒæŠ•å½±çŸ©é˜µçš„ç»Ÿä¸€å˜é‡
    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    // è§†å›¾çŸ©é˜µ
    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));

    // æ„å»ºé€è§†çŸ©é˜µ
    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 100.0f);
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    // å‚æ•°ä¸ºï¼šè§†è§’ï¼Œå®½é«˜æ¯”ï¼Œè¿‘è£å‰ªé¢ï¼Œè¿œè£å‰ªé¢

    float tf;
    glm::mat4 tMat, rMat;
    for (int i = 0; i &lt; 24; i ++)
    {
        tf = currentTime + i;
        tMat = glm::translate(glm::mat4(1.0f), glm::vec3(sin(0.35f * tf) * 8.0f, cos(0.52f * tf) * 8.0f, sin(0.7f * tf) * 8.0f));
        rMat = glm::rotate(glm::mat4(1.0f), 1.75f * tf, glm::vec3(0.0f, 1.0f, 0.0f));
        rMat = glm::rotate(rMat, 1.75f * tf, glm::vec3(1.0f, 0.0f, 0.0f));
        rMat = glm::rotate(rMat, 1.75f * tf, glm::vec3(0.0f, 0.0f, 1.0f));
        // æ„å»ºæ¨¡å‹çŸ©é˜µå’Œ MV çŸ©é˜µ
        mMat = rMat * tMat;
        mvMat = vMat * mMat;

        // å°†çŸ©é˜µå¤åˆ¶ç»™ç›¸åº”çš„ç»Ÿä¸€å˜é‡
        glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));

        // å°† VBO å…³è”ç»™é¡¶ç‚¹ç€è‰²å™¨ä¸­ç›¸åº”çš„é¡¶ç‚¹å±æ€§
        glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
        glEnableVertexAttribArray(0);

        // è°ƒæ•´ OpenGL è®¾ç½®ï¼Œç»˜åˆ¶æ¨¡å‹
        glEnable(GL_DEPTH_TEST);
        glDepthFunc(GL_LEQUAL);
        glDrawArrays(GL_TRIANGLES, 0, 36);
    }
}
</code></pre>
</details>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_mcoloredCube.gif" alt="æ•ˆæœå±•ç¤º"></p>
<p>OpenGL çš„å®ä¾‹åŒ–æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥åªç”¨ä¸€ä¸ªè°ƒç”¨å°±æ¸²æŸ“ä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå‰¯æœ¬ã€‚</p>
<ul>
<li>å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½ä¼˜åŠ¿</li>
</ul>
<p>æŠŠåŸæ¥è°ƒç”¨çš„ <code>glDrawArrays()</code> æ”¹ä¸º <code>glDrawArraysInstanced()</code>ã€‚</p>
<p>åŒæ—¶å®ä¾‹åŒ–æ—¶ï¼Œé¡¶ç‚¹ç€è‰²å™¨å¯ä»¥è®¿é—®å†…ç½®å˜é‡ <code>gl_InstanceID</code> æ¥è·å–å½“å‰æ­£åœ¨å¤„ç†å¯¹è±¡çš„å®ä¾‹åºå·ã€‚</p>
<p>å®ä¾‹åŒ–çš„ç¨‹åºï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 1;
GLuint vao[numVAO], vbo[numVBO];

double cameraX, cameraY, cameraZ;
float aspect, timeFactor;

GLuint mLoc, vLoc, projLoc, tfLoc;
int width, height;
glm::mat4 pMat, vMat, mMat;

void makeVertexArray()
{
    float vertexs[108] = {
        -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
        -1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
         1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
    };

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]); // ç”Ÿæˆçš„ç¼“å†²åŒºå’Œ VAO ç›¸å…³è”

    glGenBuffers(numVBO, vbo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]); // å°†ç¼“å†²åŒºæ ‡ä¸ºæ´»è·ƒï¼ˆä½¿ç”¨ï¼‰
    // å°†åŒ…å«é¡¶ç‚¹æ•°æ®çš„æ•°ç»„å¤åˆ¶è¿›æ´»è·ƒç¼“å†²åŒº
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertexs), vertexs, GL_STATIC_DRAW);
}

void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 32.0f;
    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
    makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    // è·å–è§†å›¾çŸ©é˜µå’ŒæŠ•å½±çŸ©é˜µçš„ç»Ÿä¸€å˜é‡
    vLoc = glGetUniformLocation(renderProgram, "v_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    glUniformMatrix4fv(vLoc, 1, GL_FALSE, glm::value_ptr(vMat));
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

    // è·å–æ—¶é—´å› å­çš„ç»Ÿä¸€å˜é‡
    timeFactor = static_cast&lt;float&gt;(currentTime);
    tfLoc = glGetUniformLocation(renderProgram, "tf");
    glUniform1f(tfLoc, timeFactor);

    // å°† VBO å…³è”ç»™é¡¶ç‚¹ç€è‰²å™¨ä¸­ç›¸åº”çš„é¡¶ç‚¹å±æ€§
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    // å®ä¾‹åŒ–
    glDrawArraysInstanced(GL_TRIANGLES, 0, 36, 24);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Cube", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
<p>ä»ä¹‹å‰çš„å¾ªç¯å¤šä¸ªæ¨¡å‹çŸ©é˜µå±•ç¤º æ”¹ä¸ºäº† åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­æ„å»ºæ¨¡å‹çŸ©é˜µã€‚</p>
<ul>
<li>å°†æ—¶é—´å› å­é€šè¿‡ç»Ÿä¸€å˜é‡ä¼ é€’ç»™é¡¶ç‚¹ç€è‰²å™¨ï¼Œè¿˜éœ€è¦å°†è§†å›¾çŸ©é˜µä¼ é€’åˆ°å•ç‹¬çš„ç»Ÿä¸€å˜é‡ä¸­</li>
<li>æ—‹è½¬è®¡ç®—è¢«ç§»åŠ¨åˆ°äº†é¡¶ç‚¹ç€è‰²å™¨ä¸­</li>
</ul>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 position;

uniform mat4 v_matrix;
uniform mat4 proj_matrix;
uniform float tf;

out vec4 changingColor;

mat4 buildRotateX(float rad)
{
    mat4 xrot = mat4(
        1.0, 0.0, 0.0, 0.0,
        0.0, cos(rad), -sin(rad), 0.0,
        0.0, sin(rad), cos(rad), 0.0,
        0.0, 0.0, 0.0, 1.0);
    return xrot;
}

mat4 buildRotateY(float rad)
{
    mat4 yrot = mat4(
        cos(rad), 0.0, sin(rad), 0.0,
        0.0, 1.0, 0.0, 0.0,
        -sin(rad), 0.0, cos(rad), 0.0,
        0.0, 0.0, 0.0, 1.0);
    return yrot;
}

mat4 buildRotateZ(float rad)
{
    mat4 zrot = mat4(
        cos(rad), -sin(rad), 0.0, 0.0,
        sin(rad), cos(rad), 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0,
        0.0, 0.0, 0.0, 1.0);
    return zrot;
}

mat4 buildTranslate(float x, float y, float z)
{
    mat4 trans = mat4(
        1.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0,
        x, y, z, 1.0);
    return trans;
}

void main()
{
    float i = gl_InstanceID + tf;

    float a = sin(0.35 * i) * 8.0;
    float b = cos(0.52 * i) * 8.0;
    float c = sin(0.70 * i) * 8.0;

    mat4 localRotx = buildRotateX(1.75 * i);
    mat4 localRoty = buildRotateY(1.75 * i);
    mat4 localRotz = buildRotateZ(1.75 * i);
    mat4 localTrans = buildTranslate(a, b, c);

    mat4 newM_matrix = localTrans * localRotx * localRoty * localRotz;
    mat4 mv_matrix = v_matrix * newM_matrix;

    gl_Position = proj_matrix * mv_matrix * vec4(position, 1.0);
    changingColor = vec4(position, 1.0) * 0.5 + vec4(0.5, 0.5, 0.5, 0.5);
}
</code></pre>
<p>ç”±äºç€è‰²å™¨å†…éƒ¨æ— æ³•è°ƒç”¨ GLM çš„å‡½æ•°ï¼Œæ•…éœ€è¦ç¼–å†™çŸ©é˜µå˜æ¢çš„ç›¸å…³å‡½æ•°ã€‚</p>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

in vec4 changingColor;

out vec4 color;

uniform mat4 proj_matrix;

void main()
{
    color = changingColor;
}
</code></pre>
<p>ç‰‡æ®µç€è‰²å™¨æ— éœ€åšæ”¹å˜ã€‚</p>
</details>
<p>å¦‚æœæ¸²æŸ“çš„ç«‹æ–¹ä½“å¾ˆå¤šæ—¶ï¼Œå®ä¾‹åŒ–æå¤§çš„æ–¹ä¾¿äº†ç¨‹åºçš„ç¼–å†™ï¼Œåªéœ€è¦ä¿®æ”¹è§†é‡ç›¸å…³çš„å¸¸é‡ï¼š</p>
<p>æ¯”å¦‚æƒ³æ¸²æŸ“ 100000 ä¸ªå½©è‰²ç«‹æ–¹ä½“ï¼Œåªéœ€ä¿®æ”¹ï¼š</p>
<pre><code class="language-cpp">// main.cpp
// å®ä¾‹åŒ–ä¸ªæ•°
glDrawArraysInstanced(GL_TRIANGLES, 0, 36, 100000);
</code></pre>
<pre><code class="language-cpp">// main.cpp
// é•œå¤´ä½ç½®ï¼Œé•œå¤´æ‹‰è¿œ
cameraX = 0.0f, cameraY = 0.0f, cameraZ = 402.0f;
</code></pre>
<pre><code class="language-cpp">// vertex.glsl
// ä½ç§»å˜å¤§
float a = sin(203.0 * i / 8000.0) * 403.0;
float b = cos(301.0 * i / 4001.0) * 401.0;
float c = sin(400.0 * i / 6003.0) * 405.0;
</code></pre>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_100kcubes.jpg" alt="æ•ˆæœæˆªå›¾(é™æ€å›¾)"></p>
<h3 id="4-7-åŒä¸€åœºæ™¯æ¸²æŸ“å¤šä¸ªå¯¹è±¡">4.7 åŒä¸€åœºæ™¯æ¸²æŸ“å¤šä¸ªå¯¹è±¡</h3>
<p>è¦åœ¨å•ä¸ªåœºæ™¯ä¸­æ¸²æŸ“å¤šä¸ªæ¨¡å‹ï¼Œç®€å•çš„åšæ³•ï¼š</p>
<ol>
<li>ä¸ºæ¯ä¸ªæ¨¡å‹ä½¿ç”¨å•ç‹¬çš„ç¼“å†²åŒºï¼›</li>
<li>æ¯ä¸ªæ¨¡å‹éƒ½éœ€è¦è‡ªå·±çš„æ¨¡å‹çŸ©é˜µï¼Œä¸ºæ¸²æŸ“çš„æ¯ä¸ªæ¨¡å‹ç”Ÿæˆä¸€ä¸ªæ–°çš„ MV çŸ©é˜µï¼›</li>
<li>ä¸ºæ¯ä¸ªæ¨¡å‹å•ç‹¬è°ƒç”¨ <code>glDrawArrays()</code>ã€‚</li>
</ol>
<p>å‡å¦‚åœ¨åœºæ™¯ä¸­æ¸²æŸ“ç«‹æ–¹ä½“å’Œå››æ£±é”¥ï¼Œä¸”ä¸è€ƒè™‘å¤æ‚çš„æƒ…å†µï¼Œå¤ç”¨ç€è‰²å™¨ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_2objects.gif" alt="æ¸²æŸ“ç«‹æ–¹ä½“å’Œå››æ£±é”¥"></p>
<p>ä»£ç å¦‚ä¸‹ï¼ˆè‡ªä¸»ç ”ç©¶ï¼Œä¸è¿‡å¤šè§£é‡Šï¼‰ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 2;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
float cubeLocx, cubeLocy, cubeLocz;
float pyramidLocx, pyramidLocy, pyramidLocz;

GLuint mvLoc, projLoc;

glm::mat4 pMat, vMat, mMat, mvMat;

void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
    float vertexs[108] = {
        -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
        -1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
         1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
    };

    float pyramids[54] = {
        -1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  0.0f,  1.0f, 0.0f,
         1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  0.0f,  1.0f, 0.0f,
         1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  0.0f,  1.0f, 0.0f,
        -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  0.0f,  1.0f, 0.0f,
        -1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f, -1.0f, -1.0f, 1.0f,
         1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f, 1.0f
    };

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]); // ç”Ÿæˆçš„ç¼“å†²åŒºå’Œ VAO ç›¸å…³è”

    glGenBuffers(numVBO, vbo);
    // ç«‹æ–¹ä½“ä¸ç¼“å†²åŒº0ç»‘å®š
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertexs), vertexs, GL_STATIC_DRAW);
    // å››æ£±é”¥ä¸ç¼“å†²åŒº1ç»‘å®š
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(pyramids), pyramids, GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 8.0f;
    cubeLocx = 0.0f, cubeLocy = -2.0f, cubeLocz = 0.0f;
    pyramidLocx = 0.0f, pyramidLocy = 1.0f, pyramidLocz = 0.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    // è·å–è§†å›¾çŸ©é˜µå’ŒæŠ•å½±çŸ©é˜µçš„ç»Ÿä¸€å˜é‡
    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));

    // ç»˜ç”»ç«‹æ–¹ä½“
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(cubeLocx, cubeLocy, cubeLocz));
    mMat *= glm::rotate(glm::mat4(1.0f), static_cast&lt;float&gt;(currentTime), glm::vec3(0.25f, 1.0f, 0.0f));
    mvMat = vMat * mMat;
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);
    glEnable(GL_DEPTH_TEST);
    glDrawArrays(GL_TRIANGLES, 0, 36);

    // ç»˜ç”»å››æ£±é”¥
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(pyramidLocx, pyramidLocy, pyramidLocz));
    mMat *= glm::rotate(glm::mat4(1.0f), static_cast&lt;float&gt;(currentTime), glm::vec3(0.25f, 1.0f, 0.0f));
    mvMat = vMat * mMat;
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);
    glEnable(GL_DEPTH_TEST);
    glDrawArrays(GL_TRIANGLES, 0, 18);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Cube", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-cpp">// é¡¶ç‚¹ç€è‰²å™¨
#version 460 core

layout(location = 0) in vec3 position;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

out vec4 changingColor;

void main()
{
    gl_Position = proj_matrix * mv_matrix * vec4(position, 1.0);
    changingColor = vec4(position, 1.0) * 0.5 + vec4(0.5, 0.5, 0.5, 0.5);
}
</code></pre>
<pre><code class="language-cpp">// ç‰‡æ®µç€è‰²å™¨
#version 460 core

in vec4 changingColor;

out vec4 color;

uniform mat4 proj_matrix;

void main()
{
    color = changingColor;
}
</code></pre>
</details>
<h3 id="4-8-çŸ©é˜µæ ˆ">4.8 çŸ©é˜µæ ˆ</h3>
<p>å‰é¢æ¸²æŸ“çš„æ¨¡å‹éƒ½æ˜¯ç”±ä¸€ç»„é¡¶ç‚¹æ„æˆï¼Œè€Œå®é™…ä¸Šå¸Œæœ›é€šè¿‡ç»„è£…è®¸å¤šç®€å•åœ°æ¨¡å‹æ¥æ„å»ºå¤æ‚çš„æ¨¡å‹ã€‚ä»¥è¿™ç§æ–¹å¼æ„å»ºçš„å¯¹è±¡ç§°ä¸ºåˆ†å±‚æ¨¡å‹ã€‚</p>
<ul>
<li>æ„å»ºåˆ†å±‚æ¨¡å‹çš„æ£˜æ‰‹éƒ¨åˆ†æ˜¯è·Ÿè¸ªæ‰€æœ‰ MV çŸ©é˜µå¹¶ä¿è¯çŸ©é˜µå®Œç¾åè°ƒã€‚</li>
</ul>
<p>çŸ©é˜µæ ˆï¼šå˜æ¢çŸ©é˜µçš„æ ˆã€‚</p>
<ul>
<li>ä½¿å¾—åˆ›å»ºå’Œç®¡ç†å¤æ‚åˆ†å±‚å¯¹è±¡å’Œåœºæ™¯å˜å¾—å®¹æ˜“</li>
<li>ä½¿å¾—å˜æ¢å¯ä»¥æ„å»ºåœ¨å…¶ä»–å˜æ¢ä¹‹ä¸Š</li>
<li>é€šè¿‡ STL çš„ <code>stack</code> ç±»æ„å»º <code>mat4</code> çš„æ ˆã€‚</li>
</ul>
<p>å¯¹äº <code>std::stack&lt;glm::mat4&gt;</code> çš„å®ä¾‹ <code>s</code>ï¼š</p>
<ul>
<li><code>s.push(mat4)</code>ï¼šå°†æ ˆé¡¶çš„çŸ©é˜µå¤åˆ¶ä¸€ä»½ï¼Œå¹¶ä½œå˜æ¢åæŠŠæ–°çš„çŸ©é˜µå‹å…¥æ ˆã€‚</li>
<li><code>s.pop()</code>ï¼šå¼¹å‡ºæ ˆé¡¶çš„çŸ©é˜µã€‚</li>
<li><code>s.top()</code>ï¼šè¿”å›æ ˆé¡¶çš„çŸ©é˜µçš„å¼•ç”¨ã€‚</li>
<li><code>s.top() *= rotate(args)</code>ï¼šç›´æ¥å¯¹æ ˆé¡¶çŸ©é˜µä½œæ—‹è½¬å˜æ¢ã€‚</li>
<li><code>s.top() *= translate(args)</code>ï¼šç›´æ¥å¯¹æ ˆé¡¶çŸ©é˜µä½œå¹³ç§»å˜æ¢ã€‚</li>
<li><code>s.top() *= scale(args)</code>ï¼šç›´æ¥å¯¹æ ˆé¡¶çŸ©é˜µä½œç¼©æ”¾å˜æ¢ã€‚</li>
</ul>
<p>åœ¨æ­¤ä¹‹åï¼Œä¸å†é€šè¿‡åˆ›å»º <code>mat4</code> çš„å®ä¾‹æ¥æ„å»ºå˜æ¢ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>push()</code> å‘½ä»¤åœ¨æ ˆé¡¶éƒ¨åˆ›å»ºæ–°çš„çŸ©é˜µï¼Œç„¶åæ ¹æ®éœ€è¦å°†æœŸæœ›çš„å˜æ¢åº”ç”¨äºæ ˆé¡¶éƒ¨çš„æ–°åˆ›å»ºçš„çŸ©é˜µã€‚</p>
<ul>
<li>å‹å…¥æ ˆçš„ç¬¬ä¸€ä¸ªçŸ©é˜µé€šå¸¸æ˜¯è§†å›¾çŸ©é˜µã€‚å®ƒä¸Šé¢çš„çŸ©é˜µæ˜¯å¤æ‚ç¨‹åº¦è¶Šæ¥è¶Šé«˜çš„ MV çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åº”ç”¨äº†è¶Šæ¥è¶Šå¤šçš„æ¨¡å‹å˜æ¢ã€‚è¿™äº›å˜æ¢æ—¢å¯ä»¥ç›´æ¥åº”ç”¨ï¼Œä¹Ÿå¯ä»¥å…ˆç»“åˆå…¶ä»–çŸ©é˜µå†åº”ç”¨ã€‚</li>
</ul>
<p>å‡è®¾ä¸€ä¸ªä¾‹å­ï¼Œå®ç°ä¸€ä¸ªåœ°çƒå›´ç»•å¤ªé˜³æ—‹è½¬å’Œæœˆçƒå›´ç»•åœ°çƒæ—‹è½¬çš„åœºæ™¯ï¼š</p>
<ol>
<li>é¦–å…ˆå‹å…¥è§†å›¾çŸ©é˜µ Vï¼›</li>
<li>å‹å…¥å¤ªé˜³çš„ MV çŸ©é˜µï¼›</li>
<li>å‹å…¥åœ°çƒçš„ MV çŸ©é˜µï¼Œç”±å¤ªé˜³çš„ MV çŸ©é˜µçš„å‰¯æœ¬å’Œåº”ç”¨äºå…¶ä¹‹ä¸Šçš„åœ°çƒæ¨¡å‹çŸ©é˜µå˜æ¢ç»„æˆï¼›</li>
<li>å‹å…¥æœˆçƒçš„ MV çŸ©é˜µï¼Œç”±åœ°çƒçš„ MV çŸ©é˜µçš„å‰¯æœ¬å’Œåº”ç”¨äºå…¶ä¹‹ä¸Šçš„æœˆçƒæ¨¡å‹çŸ©é˜µå˜æ¢ç»„æˆã€‚</li>
</ol>
<p>æ¥ç€ï¼Œæ¸²æŸ“æœˆçƒå¹¶æŠŠæœˆçƒçŸ©é˜µå¼¹å‡ºï¼Œåé¢çš„åœ°çƒå’Œå¤ªé˜³åªéœ€è¦é‡å¤å³å¯ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å£°æ˜çŸ©é˜µæ ˆï¼›</li>
<li>å½“ç›¸å¯¹äºçˆ¶å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡æ—¶ï¼Œè°ƒç”¨ <code>s.push(s.top())</code>ï¼›</li>
<li>åº”ç”¨æ–°å¯¹è±¡æ‰€éœ€çš„å˜æ¢ï¼›</li>
<li>å®Œæˆå¯¹è±¡æˆ–å­å¯¹è±¡çš„ç»˜åˆ¶åï¼Œå¼¹å‡ºæ ˆé¡¶ï¼Œç§»é™¤å¯¹åº”çš„ MV çŸ©é˜µã€‚</li>
</ol>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œéœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>å¤ªé˜³çš„è‡ªè½¬åœ¨å®ƒè‡ªå·±çš„å±€éƒ¨åæ ‡ç©ºé—´ä¸­è¿›è¡Œï¼Œä¸åº”å½±å“åœ°çƒå’Œæœˆçƒã€‚å› æ­¤ï¼Œå¤ªé˜³çš„æ—‹è½¬å˜æ¢çŸ©é˜µè¢«æ¨åˆ°æ ˆä¸Šï¼Œä½†æ˜¯åœ¨ç»˜åˆ¶å¤ªé˜³ä¹‹åï¼Œå®ƒå¿…é¡»è¢«ä»æ ˆä¸­å¼¹å‡ºã€‚</li>
<li>åœ°çƒçš„å…¬è½¬å°†å½±å“æœˆçƒçš„è¿åŠ¨ï¼Œå› æ­¤åœ°çƒçš„å¹³ç§»å˜æ¢çŸ©é˜µè¢«å‹å…¥æ ˆå¹¶ä¿æŒåˆ°ç»˜åˆ¶æœˆçƒã€‚</li>
<li>åœ°çƒçš„è‡ªè½¬æ˜¯å±€éƒ¨çš„ï¼Œä¸ä¼šå½±å“æœˆçƒï¼Œå› æ­¤åœ¨ç»˜åˆ¶æœˆçƒä¹‹å‰åœ°çƒçš„æ—‹è½¬å˜æ¢çŸ©é˜µéœ€è¦ä»æ ˆä¸­å¼¹å‡ºã€‚</li>
</ul>
<p>æ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_sunearthmoon.gif" alt="å¤ªé˜³-åœ°çƒ-æœˆçƒåœºæ™¯"></p>
<p>é¡¶ç‚¹ç€è‰²å™¨ä¸ç‰‡æ®µç€è‰²å™¨æ— éœ€æ”¹å˜ï¼ŒåŒä¸Šé¢æ¸²æŸ“ä¸¤ä¸ªç›®æ ‡çš„ç¨‹åºã€‚</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;

GLuint renderProgram;

const int numVAO = 1, numVBO = 2;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;

GLuint mvLoc, projLoc;

glm::mat4 pMat, vMat, mMat, mvMat;

std::stack&lt;glm::mat4&gt; matrixStack;

void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
    float vertexs[108] = {
        -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
         1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
         1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
         1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
        -1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
         1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
    };

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]); // ç”Ÿæˆçš„ç¼“å†²åŒºå’Œ VAO ç›¸å…³è”

    glGenBuffers(numVBO, vbo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertexs), vertexs, GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 4.0f, cameraZ = 20.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    matrixStack.push(vMat);

    // ç»˜åˆ¶å¤ªé˜³
    matrixStack.push(matrixStack.top());
    matrixStack.top() *= glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, 0.0f)); // å¤ªé˜³ä½ç½®
    matrixStack.push(matrixStack.top());
    matrixStack.top() *= glm::rotate(glm::mat4(1.0f), static_cast&lt;float&gt;(currentTime), glm::vec3(1.0f, 0.0f, 0.0f)); // å¤ªé˜³è‡ªè½¬
    matrixStack.top() *= glm::scale(glm::mat4(1.0f), glm::vec3(2.0f, 2.0f, 2.0f));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(matrixStack.top()));
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, 36);
    matrixStack.pop();

    // ç»˜åˆ¶åœ°çƒ
    matrixStack.push(matrixStack.top());
    matrixStack.top() *= glm::translate(glm::mat4(1.0f), glm::vec3(sin(static_cast&lt;float&gt;(currentTime)) * 8.0, 0.0, cos(static_cast&lt;float&gt;(currentTime)) * 8.0)); // å¹³ç§»çŸ©é˜µå˜æ¢
    matrixStack.push(matrixStack.top());
    matrixStack.top() *= glm::rotate(glm::mat4(1.0f), static_cast&lt;float&gt;(currentTime) * 2.0f, glm::vec3(0.0f, 2.0f, 0.0f)); // æ—‹è½¬çŸ©é˜µå˜æ¢
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(matrixStack.top()));
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, 36);
    matrixStack.pop();

    // ç»˜åˆ¶æœˆçƒ
    matrixStack.push(matrixStack.top());
    matrixStack.top() *= glm::translate(glm::mat4(1.0f), glm::vec3(0.0, sin(static_cast&lt;float&gt;(currentTime)) * 2.0, cos(static_cast&lt;float&gt;(currentTime)) * 2.0)); // å¹³ç§»çŸ©é˜µå˜æ¢
    matrixStack.top() *= glm::rotate(glm::mat4(1.0f), static_cast&lt;float&gt;(currentTime), glm::vec3(0.0f, 0.0f, 1.0f)); // æ—‹è½¬çŸ©é˜µå˜æ¢
    matrixStack.top() *= glm::scale(glm::mat4(1.0f), glm::vec3(0.25f, 0.25f, 0.25f));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(matrixStack.top()));
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, 36);
    matrixStack.pop(); matrixStack.pop(); matrixStack.pop();
    matrixStack.pop();
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "sun-earth-moon", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
<p>æ³¨æ„çš„ç‚¹ï¼š</p>
<ul>
<li>åŠ å…¥ç¼©æ”¾çŸ©é˜µè°ƒèŠ‚å„ä¸ªæ¨¡å‹çš„å¤§å°</li>
<li>ä½¿ç”¨ä¸‰è§’å‡½æ•°å®ç°è‡ªè½¬å’Œå…¬è½¬</li>
<li>åœ¨ <code>glUniformMatrix4fv()</code> å‘½ä»¤ä¸­è°ƒç”¨çš„  <code>glm::value_ptr(mvStack.top())</code> å‡½æ•°ï¼Œè·å–æ ˆé¡¶éƒ¨çŸ©é˜µä¸­çš„å€¼</li>
</ul>
</details>
<h3 id="4-9-åº”å¯¹-zå†²çª-ä¼ªå½±">4.9 åº”å¯¹â€œZå†²çªâ€ä¼ªå½±</h3>
<p>åœ¨æ¸²æŸ“å¤šä¸ªå¯¹è±¡æ—¶ï¼ŒOpenGL ä½¿ç”¨ Z-buffer ç®—æ³•æ¥è¿›è¡Œéšè—é¢æ¶ˆé™¤ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡é€‰æ‹©æœ€æ¥è¿‘ç›¸æœºçš„ç›¸åº”ç‰‡æ®µçš„é¢œè‰²ä½œä¸ºåƒç´ çš„é¢œè‰²ï¼Œè¿™ç§æ–¹æ³•å¯å†³å®šå“ªäº›ç‰©ä½“çš„æ›²é¢å¯è§å¹¶å‘ˆç°åˆ°å±å¹•ï¼Œè€Œä½äºå…¶ä»–ç‰©ä½“åé¢çš„æ›²é¢ä¸åº”è¯¥è¢«æ¸²æŸ“ã€‚</p>
<p><em>Z-buffer ç®—æ³•æ€æƒ³ï¼šå…ˆå°† Z ç¼“å†²å™¨ä¸­å„å•å…ƒçš„åˆå§‹ç½®è®¾ç½®ä¸ºæœ€å°å€¼ã€‚å½“è¦æ”¹å˜æŸä¸ªåƒç´ çš„é¢œè‰²å€¼æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰å¤šè¾¹å½¢çš„æ·±åº¦å€¼æ˜¯å¦å¤§äºè¯¥åƒç´ åŸæ¥çš„æ·±åº¦å€¼ï¼ˆä¿å­˜åœ¨è¯¥åƒç´ æ‰€å¯¹åº”çš„Z ç¼“å†²å™¨çš„å•å…ƒä¸­ï¼‰ã€‚å¦‚æœå¤§äºåŸæ¥çš„ Z å€¼ï¼Œè¯´æ˜å½“å‰å¤šè¾¹å½¢æ›´é è¿‘è§‚å¯Ÿç‚¹ï¼Œç”¨å®ƒçš„é¢œè‰²æ›¿æ¢åƒç´ åŸæ¥çš„é¢œè‰²ã€‚</em></p>
<p>ç„¶è€Œï¼Œæœ‰æ—¶å€™åœºæ™¯ä¸­çš„ä¸¤ä¸ªç‰©ä½“è¡¨é¢é‡å å¹¶ä½äºé‡åˆçš„å¹³é¢ä¸­ï¼Œè¿™ä½¿å¾—æ·±åº¦ç¼“å†²åŒºç®—æ³•éš¾ä»¥ç¡®å®šåº”è¯¥æ¸²æŸ“ä¸¤ä¸ªè¡¨é¢ä¸­çš„å“ªä¸€ä¸ªã€‚</p>
<p>å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œæµ®ç‚¹èˆå…¥è¯¯å·®å¯èƒ½ä¼šå¯¼è‡´æ¸²æŸ“è¡¨é¢çš„æŸäº›éƒ¨åˆ†ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„é¢œè‰²ï¼Œè€Œå…¶ä»–éƒ¨åˆ†åˆ™ä½¿ç”¨å¦ä¸€ä¸ªå¯¹è±¡çš„é¢œè‰²ã€‚è¿™ç§ä¸è‡ªç„¶çš„ä¼ªå½±ç§°ä¸º Z å†²çªï¼ˆZ-fightingï¼‰æˆ–æ·±åº¦å†²çªï¼ˆdepth-fightingï¼‰ã€‚</p>
<ul>
<li>æ˜¯æ¸²æŸ“çš„ç‰‡æ®µåœ¨æ·±åº¦ç¼“å†²åŒºä¸­ç›¸äº’å¯¹åº”çš„åƒç´ æ¡ç›®ä¸Šâ€œæ–—äº‰â€çš„ç»“æœã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_zfighting.jpg" alt="Zå†²çªä¾‹å­ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬2ç‰ˆï¼‰"></p>
<p>éƒ¨åˆ†åº”å¯¹æ–¹æ³•ï¼š</p>
<ul>
<li>å¯ä»¥é€‰æ‹©é€‚å½“çš„è¿‘ã€è¿œå‰ªè£å¹³é¢å€¼æ¥æœ€å°åŒ–ä¸¤ä¸ªå¹³é¢ä¹‹é—´çš„è·ç¦»ï¼ŒåŒæ—¶ä»ç„¶ç¡®ä¿åœºæ™¯å¿…éœ€çš„æ‰€æœ‰å¯¹è±¡éƒ½ä½äºè§†é”¥å†…</li>
<li>å»ºè®®é¿å…é€‰æ‹©å¤ªé è¿‘ç›¸æœºçš„è¿‘å‰ªè£å¹³é¢</li>
</ul>
<h3 id="4-10-å…¶ä»–å›¾å…ƒ">4.10 å…¶ä»–å›¾å…ƒ</h3>
<p>ç›®å‰ä¸€ç›´ä½¿ç”¨ä¸‰è§’å½¢è¿›è¡Œç»˜åˆ¶ï¼Œå…¶å® OpenGL è¿˜æœ‰å…¶ä»–é€‰æ‹©ã€‚</p>
<h4 id="4-10-1-ä¸‰è§’å½¢å›¾å…ƒ">4.10.1 ä¸‰è§’å½¢å›¾å…ƒ</h4>
<table>
<thead>
<tr>
<th style="text-align:center">åç§°</th>
<th style="text-align:center">ä½œç”¨</th>
<th style="text-align:center">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>GL_TRIANGLES</code></td>
<td style="text-align:center">ç®¡çº¿ä¸­ä¼ é€’çš„æ¯3ä¸ªé¡¶ç‚¹æ•°æ®ç»„æˆä¸€ä¸ªä¸‰è§’å½¢</td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_gltriangle.jpg"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_TRIANGLE_STRIP</code></td>
<td style="text-align:center">ç®¡çº¿ä¸­ä¼ é€’çš„æ¯ä¸ªé¡¶ç‚¹å’Œä¹‹å‰çš„ä¸¤ä¸ªé¡¶ç‚¹ç»„æˆä¸€ä¸ªä¸‰è§’å½¢</td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_gltrianglestrip.png"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_TRIANGLE_FAN</code></td>
<td style="text-align:center">ç®¡çº¿ä¸­ä¼ é€’çš„æ¯å¯¹é¡¶ç‚¹å’Œæœ€å¼€å§‹çš„é¡¶ç‚¹ç»„æˆä¸€ä¸ªä¸‰è§’å½¢</td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_gltrianglefan.png"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_TRIANGLES_ADJACENCY</code></td>
<td style="text-align:center">ä»…ç”¨äºå‡ ä½•ç€è‰²å™¨ï¼Œå…è®¸ç€è‰²å™¨è®¿é—®å½“å‰ä¸‰è§’å½¢çš„é¡¶ç‚¹ï¼Œä»¥åŠé¢å¤–çš„ç›¸é‚»é¡¶ç‚¹</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_TRIANGLE_STRIP_ADJACENCY</code></td>
<td style="text-align:center">ä»…ç”¨äºå‡ ä½•ç€è‰²å™¨ï¼Œç±»ä¼¼äº <code>GL_TRIANGLES_ADJACENCY</code>ï¼Œä½†ä¸‰è§’å½¢é¡¶ç‚¹åƒåœ¨ <code>GL_TRIANGLE_STRIP</code> ä¸­ä¸€æ ·é‡å </td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h4 id="4-10-2-çº¿å›¾å…ƒ">4.10.2 çº¿å›¾å…ƒ</h4>
<table>
<thead>
<tr>
<th style="text-align:center">åç§°</th>
<th style="text-align:center">ä½œç”¨</th>
<th style="text-align:center">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>GL_LINES</code></td>
<td style="text-align:center">ç®¡çº¿ä¸­ä¼ é€’çš„æ¯ä¸¤ä¸ªé¡¶ç‚¹ç»„æˆä¸€æ¡çº¿</td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_glline.png"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_LINE_STRIP</code></td>
<td style="text-align:center">ç®¡çº¿ä¸­æ¯ä¸ªé¡¶ç‚¹å’Œå‰ä¸€ä¸ªé¡¶ç‚¹ç»„æˆä¸€æ¡çº¿</td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_gllinestrip.png"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_LINE_LOOP</code></td>
<td style="text-align:center">ç±»ä¼¼äº <code>GL_LINE_STRIP</code>ï¼Œä½†æœ€åçš„é¡¶ç‚¹å’Œç¬¬ä¸€ä¸ªé¡¶ç‚¹ä¹‹é—´ä¼šå½¢æˆä¸€æ¡çº¿</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_LINE_ADJACENCY</code></td>
<td style="text-align:center">ä»…ç”¨äºå‡ ä½•ç€è‰²å™¨ï¼Œå…è®¸ç€è‰²å™¨è®¿é—®å½“å‰çº¿çš„é¡¶ç‚¹ï¼Œä»¥åŠé¢å¤–çš„ç›¸é‚»é¡¶ç‚¹</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><code>GL_LINE_STRIP_ADJACENCY</code></td>
<td style="text-align:center">ä»…ç”¨äºå‡ ä½•ç€è‰²å™¨ï¼Œç±»ä¼¼äº <code>GL_LINE_ADJACENCY</code>ï¼Œä½†çº¿é¡¶ç‚¹åƒåœ¨ <code>GL_LINE_STRIP</code> ä¸­ä¸€æ ·é‡å </td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h4 id="4-10-3-ç‚¹å›¾å…ƒ">4.10.3 ç‚¹å›¾å…ƒ</h4>
<table>
<thead>
<tr>
<th style="text-align:center">åç§°</th>
<th style="text-align:center">ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>GL_POINTS</code></td>
<td style="text-align:center">ç®¡çº¿ä¸­ä¼ é€’çš„æ¯ä¸ªé¡¶ç‚¹ç»„æˆä¸€ä¸ªç‚¹</td>
</tr>
</tbody>
</table>
<h4 id="è¡¥ä¸å›¾å…ƒ">è¡¥ä¸å›¾å…ƒ</h4>
<table>
<thead>
<tr>
<th style="text-align:center">åç§°</th>
<th style="text-align:center">ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>GL_PATCHES</code></td>
<td style="text-align:center">ä»…ç”¨äºç»†åˆ†ç€è‰²å™¨ï¼ŒæŒ‡ç¤ºä¸€ç»„é¡¶ç‚¹ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ é€’åˆ°ç»†åˆ†æ§åˆ¶ç€è‰²å™¨ï¼Œåœ¨è¿™é‡Œå®ƒä»¬é€šå¸¸ç”¨äºå°†æ›²é¢ç»†åˆ†ç½‘æ ¼å¡‘é€ æˆæ›²é¢</td>
</tr>
</tbody>
</table>
<h3 id="4-11-æ€§èƒ½ä¼˜å…ˆç¼–ç¨‹">4.11 æ€§èƒ½ä¼˜å…ˆç¼–ç¨‹</h3>
<p>éšç€ 3D åœºæ™¯é€æ¸å¤æ‚ï¼Œæ€§èƒ½æ–¹é¢ä¸å¾—ä¸å…³å¿ƒã€‚</p>
<ol>
<li>å°½é‡å‡å°‘åŠ¨æ€å†…å­˜ç©ºé—´åˆ†é…
<ul>
<li>å…³é”®éƒ¨åˆ† <code>display()</code> å‡½æ•°ä¼šè¢«é‡å¤è°ƒç”¨
<ul>
<li>é¿å…é‡å¤å®ä¾‹åŒ–å¯¹è±¡</li>
<li>é¿å…é‡å¤å£°æ˜å˜é‡</li>
</ul>
</li>
<li>C++ æ ˆç±»ï¼Œæ¯æ¬¡å…¥æ ˆå¯èƒ½ä¼šå¯¼è‡´åŠ¨æ€å†…å­˜åˆ†é…</li>
<li>å°†æ•°æ®ä»ä¸€ç§ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹çš„å‡½æ•°è°ƒç”¨åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šå®ä¾‹åŒ–å¹¶è¿”å›æ–°è½¬æ¢çš„æ•°æ®</li>
<li>GLM åº“å‡½æ•°ä¼˜åŒ–æœ‰é™ï¼Œå¯èƒ½å¼•èµ·åŠ¨æ€å†…å­˜åˆ†é…</li>
</ul>
</li>
<li>é¢„å…ˆè®¡ç®—é€è§†çŸ©é˜µ
<ul>
<li>å°†é€è§†çŸ©é˜µçš„è®¡ç®—ç§»åŠ¨åˆ° <code>init()</code> å‡½æ•°ä¸­</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦é‡æ–°è®¡ç®—é€è§†çŸ©é˜µï¼Œä½†çª—å£å¤§å°å˜åŒ–æ—¶éœ€è¦é‡æ–°è®¡ç®—ï¼Œå¯ä»¥å°†è®¡ç®—é€è§†çŸ©é˜µæ·»åŠ åˆ°å›è°ƒå‡½æ•°ä¸­ã€‚</li>
</ul>
</li>
<li>èƒŒé¢å‰”é™¤
<ul>
<li>åˆ©ç”¨ OpenGL çš„èƒŒé¢å‰”é™¤èƒ½åŠ›ï¼šå½“ 3D æ¨¡å‹å®Œå…¨é—­åˆæ—¶ï¼Œå…¶å†…éƒ¨æ°¸è¿œä¸å¯è§æ—¶ï¼Œé‚£ä¹ˆè¿™äº›éƒ¨åˆ†ä¸éœ€è¦è¢«æ …æ ¼åŒ–æˆ–æ¸²æŸ“ã€‚</li>
<li>é»˜è®¤èƒŒé¢å‰”é™¤æ—¶å…³é—­çš„</li>
<li>ä½¿ç”¨å‡½æ•° <code>glEnable(GL_CULL_FACE)</code> å¼€å¯</li>
<li>å¯ç”¨èƒŒé¢å‰”é™¤æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä¸‰è§’å½¢åªæœ‰æœå‰æ—¶æ‰ä¼šè¢«æ¸²æŸ“ã€‚æ­¤å¤–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä» OpenGLç›¸æœºçš„è§’åº¦çœ‹ï¼Œå¦‚æœä¸‰è§’å½¢çš„ 3 ä¸ªé¡¶ç‚¹æ˜¯ä»¥é€†æ—¶é’ˆé¡ºåºæ’åˆ—çš„ï¼ˆåŸºäºå®ƒä»¬åœ¨ç¼“å†²åŒºä¸­å®šä¹‰çš„é¡ºåºï¼‰ï¼Œåˆ™ä¸‰è§’å½¢è¢«è§†ä¸ºæœå‰ï¼›é¡¶ç‚¹æ²¿é¡ºæ—¶é’ˆæ–¹å‘æ’åˆ—çš„ä¸‰è§’å½¢æ˜¯æœåçš„ï¼Œä¸ä¼šè¢«æ¸²æŸ“
<ul>
<li><strong>å®šä¹‰â€œå‰å‘â€çš„é¡¶ç‚¹é¡ºåºæœ‰æ—¶è¢«ç§°ä¸ºç¼ ç»•é¡ºåº</strong></li>
<li>ä½¿ç”¨ <code>glFrontFace(GL_CW)</code> è®¾ç½®é¡ºæ—¶é’ˆä¸ºæ­£å‘ï¼Œä½¿ç”¨ <code>glFrontFace(GL_CCW)</code> è®¾ç½®é€†æ—¶é’ˆä¸ºæ­£å‘</li>
<li>é»˜è®¤ä¸‹ï¼Œ<code>glCullFace(GL_BACK)</code> è®¾ç½®èƒŒå‘çš„ä¸‰è§’å½¢è¢«å‰”é™¤ï¼Œä½†å‚æ•°è¿˜æœ‰ <code>GL_FRONT</code> å’Œ <code>GL_FRONT_AND_BACK</code>ï¼Œåˆ†åˆ«è®¾ç½®å‰å‘æˆ–å…¨éƒ¨ä¸‰è§’å½¢è¢«å‰”é™¤</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="äº”-çº¹ç†è´´å›¾">äº”ã€çº¹ç†è´´å›¾</h2>
<p>çº¹ç†è´´å›¾æ˜¯åœ¨æ …æ ¼åŒ–çš„æ¨¡å‹è¡¨é¢ä¸Šè¦†ç›–å›¾åƒçš„æŠ€æœ¯ã€‚</p>
<p>çº¹ç†å›¾åƒå¯ä»¥æ˜¯ä»»ä½•å›¾åƒã€‚</p>
<h3 id="5-1-åŠ è½½çº¹ç†å›¾åƒæ–‡ä»¶">5.1 åŠ è½½çº¹ç†å›¾åƒæ–‡ä»¶</h3>
<p>OpenGL/GLSL ä¸­å®Œæˆçº¹ç†è´´å›¾éœ€è¦åè°ƒä¸åŒçš„æ•°æ®é›†å’Œæœºåˆ¶ï¼š</p>
<ul>
<li>ä¿å­˜çº¹ç†å›¾åƒçš„çº¹ç†å¯¹è±¡</li>
<li>ç‰¹æ®Šçš„ç»Ÿä¸€é‡‡æ ·å™¨å˜é‡ï¼Œç”¨äºé¡¶ç‚¹ç€è‰²å™¨è®¿é—®çº¹ç†</li>
<li>ä¿å­˜çº¹ç†åæ ‡çš„ç¼“å†²åŒº</li>
<li>å°†çº¹ç†åæ ‡ä¼ é€’ç»™ç®¡çº¿çš„é¡¶ç‚¹å±æ€§</li>
<li>æ˜¾å¡ä¸Šçš„çº¹ç†å•å…ƒ</li>
</ul>
<p>æ­¤å¤„å°†ç”¨ SOIL2 åº“è¿›è¡ŒåŠ è½½å›¾åƒæ–‡ä»¶ç”¨äºè´´å›¾ï¼š</p>
<ol>
<li>ä½¿ç”¨ SOIL2 å®ä¾‹åŒ– OpenGL çº¹ç†å¯¹è±¡å¹¶ä»å›¾åƒæ–‡ä»¶ä¸­è¯»å…¥æ•°æ®ï¼›</li>
<li>è°ƒç”¨ <code>glBindTexture()</code> ä½¿å¾—æ–°åˆ›å»ºçš„çº¹ç†å¯¹è±¡å¤„äºæ¿€æ´»çŠ¶æ€ï¼›</li>
<li>ä½¿ç”¨ <code>glTexParameteri()</code> è°ƒæ•´çº¹ç†è®¾ç½®ï¼›</li>
</ol>
<ul>
<li>æœ€ç»ˆå¾—åˆ°çš„ç»“æœæ˜¯å¯ç”¨çš„ OpenGL çº¹ç†å¯¹è±¡çš„æ•´å‹ IDã€‚</li>
</ul>
<p>åŠ è½½çº¹ç†çš„ä»£ç ï¼ˆåŠ å…¥åœ¨ Util ç±»ä¸­ï¼‰å¦‚ä¸‹ï¼š</p>
<pre><code class="language-cpp">GLuint Util::loadTexture(const std::string &amp;imgPath)
{
    GLuint textureID;
    textureID = SOIL_load_OGL_texture(imgPath.c_str(), SOIL_LOAD_AUTO, SOIL_CREATE_NEW_ID, SOIL_FLAG_INVERT_Y);
    if (textureID == 0)
        std::cout &lt;&lt; "Failed to load texture: " &lt;&lt; imgPath &lt;&lt; "\n";
    return textureID;
}
</code></pre>
<p>ä»£ç å…ˆå£°æ˜äº†ä¸€ä¸ª <code>GLuint</code> ç±»å‹çš„å˜é‡ç”¨äºè®°å½• OpenGL çº¹ç†å¯¹è±¡çš„ IDï¼Œæ¥ç€è°ƒç”¨ <code>SOIL_load_OGL_texture()</code> å‡½æ•°ç”Ÿæˆçº¹ç†å¯¹è±¡ã€‚</p>
<ul>
<li>å‡½æ•°å‚æ•°åŠè¿”å›å€¼
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–‡ä»¶åï¼›</li>
<li>ç¬¬äºŒä¸ªè¯´æ˜ç¬¦ï¼Œ<code>SOIL_LOAD_AUTO</code> è¡¨ç¤ºä½¿ç”¨ç£ç›˜è½½å…¥çš„ï¼›</li>
<li>ç¬¬ä¸‰ä¸ªè¡¨ç¤ºè®©SOILä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªIDï¼›</li>
<li>ç¬¬å››ä¸ªå‚æ•° <code>SOIL_FLAG_INVERT_Y</code> å…è®¸åšæ˜¯ç¿»è½¬Yè½´</li>
<li>è¿”å›å€¼ï¼Œ0è¡¨ç¤ºå¤±è´¥ï¼Œå…¶ä»–è¡¨ç¤º OpenGL ä¸Šä¸‹æ–‡å¥æŸ„</li>
</ul>
</li>
</ul>
<h3 id="5-2-çº¹ç†åæ ‡">5.2 çº¹ç†åæ ‡</h3>
<p>é€šè¿‡ä¸ºæ¨¡å‹ä¸­çš„æ¯ä¸ªé¡¶ç‚¹æŒ‡å®šçº¹ç†åæ ‡æ¥å®Œæˆçº¹ç†è´´å›¾ã€‚</p>
<p>çº¹ç†åæ ‡æ˜¯å¯¹çº¹ç†å›¾åƒï¼ˆ2D å›¾åƒæ–‡ä»¶ï¼‰ä¸­åƒç´ çš„å¼•ç”¨ï¼Œç”¨äºå°† 3D æ¨¡å‹ä¸Šçš„ç‚¹æ˜ å°„åˆ°çº¹ç†ä¸­çš„ä½ç½®ã€‚</p>
<ul>
<li>æ¨¡å‹é™¤äº† 3D ç©ºé—´ä¸­çš„å®šä½åæ ‡ (x, y, z) å¤–ï¼Œè¡¨é¢ä¸Šæ¯ä¸ªç‚¹è¿˜å…·æœ‰çº¹ç†åæ ‡ (s, t)ï¼Œç”¨æ¥æŒ‡å®šçº¹ç†å›¾åƒä¸­å“ªä¸ªåƒç´ ä¸ºå®ƒæä¾›é¢œè‰²ã€‚</li>
</ul>
<p><strong>å¿…é¡»ä¸ºè¦æ·»åŠ çº¹ç†çš„å¯¹è±¡ä¸­æ¯ä¸ªé¡¶ç‚¹æä¾›çº¹ç†åæ ‡ã€‚</strong></p>
<p>è®¾ç½®ä¸¤ä¸ªç¼“å†²åŒºï¼Œä¸€ä¸ªç”¨äºé¡¶ç‚¹åæ ‡ï¼Œå¦ä¸€ä¸ªç”¨äºçº¹ç†åæ ‡ã€‚æ¯æ¬¡è°ƒç”¨é¡¶ç‚¹ç€è‰²å™¨ä¼šæ¥æ”¶åˆ°ä¸¤ç»„åæ ‡ã€‚</p>
<p>2D çº¹ç†å›¾åƒè¢«è®¾å®šä¸ºçŸ©å½¢ï¼Œå·¦ä¸‹è§’åæ ‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ï¼Œå³ä¸Šè§’åæ ‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ï¼Œæ•…çº¹ç†åæ ‡å–å€¼åŒºé—´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ã€‚</p>
<p>ç”±äºä¹‹å‰æ¸²æŸ“çš„ç«‹æ–¹ä½“æ¨¡å‹éƒ½æ˜¯ç”±ä¸‰è§’å½¢æ„æˆï¼Œæ¯ä¸ªé¢éœ€è¦ä¸¤ä¸ªä¸‰è§’å½¢ã€‚</p>
<p><em>å¯¹äºç«‹æ–¹ä½“æˆ–å››æ£±é”¥è¿™æ ·çš„ç®€å•æ¨¡å‹ï¼Œé€‰æ‹©çº¹ç†åæ ‡ç›¸å¯¹å®¹æ˜“ã€‚ä½†å¯¹äºå…·æœ‰å¤§é‡ä¸‰è§’å½¢çš„æ›´å¤æ‚çš„å¼¯æ›²æ¨¡å‹ï¼Œæ‰‹åŠ¨ç¡®å®šå®ƒä»¬æ˜¯ä¸åˆ‡å®é™…çš„ã€‚åœ¨å¼¯æ›²çš„å‡ ä½•å½¢çŠ¶ï¼ˆä¾‹å¦‚çƒå½¢æˆ–ç¯é¢ï¼‰çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ç®—æ³•æˆ–æ•°å­¦æ–¹å¼è®¡ç®—çº¹ç†åæ ‡ã€‚ä½¿ç”¨ Maya æˆ– Blender ç­‰å»ºæ¨¡å·¥å…·æ„å»ºæ¨¡å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨â€œUV æ˜ å°„â€åŠŸèƒ½ï¼Œä½¿å¾—ç¡®å®šçº¹ç†åæ ‡çš„ä»»åŠ¡æ›´å®¹æ˜“å®Œæˆ</em></p>
<h3 id="5-3-æ„å»ºä¸€ä¸ªå¸¦çº¹ç†çš„å››æ£±é”¥">5.3 æ„å»ºä¸€ä¸ªå¸¦çº¹ç†çš„å››æ£±é”¥</h3>
<ol>
<li>é¦–å…ˆåˆ›å»ºçº¹ç†å¯¹è±¡ï¼š</li>
</ol>
<pre><code class="language-cpp">GLuint textureID = Util::loadTexture("texture.jpg");
</code></pre>
<ol start="2">
<li>æ¥ç€æ„å»ºçº¹ç†åæ ‡ï¼š
<ul>
<li>å››æ£±é”¥å…·æœ‰äº”ä¸ªé¢ï¼Œç”±6ä¸ªä¸‰è§’å½¢ç»„æˆï¼Œæ¯ä¸ªä¸‰è§’å½¢æœ‰3ä¸ªé¡¶ç‚¹ï¼Œå…±18ä¸ªé¡¶ç‚¹</li>
<li>ä½¿å›¾åƒçš„é¡¶éƒ¨ä¸­å¿ƒå¯¹åº”å››æ£±é”¥çš„é¡¶ï¼ˆç®€å•åœ°è´´ä¸Šå»ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_texture.jpg" alt="çº¹ç†è´´å›¾"></p>
<pre><code class="language-cpp">float textures[36] = {
    0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
    0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
    0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
    0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
    0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f,
    1.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f
};
</code></pre>
<ol start="3">
<li>ç„¶åå°†çº¹ç†è½½å…¥ç¼“å†²åŒºï¼šè½½å…¥ç¼“å†²åŒº1ã€‚</li>
</ol>
<pre><code class="language-cpp">glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
glBufferData(GL_ARRAY_BUFFER, sizeof(textures), textures, GL_STATIC_DRAW);
</code></pre>
<ol start="4">
<li>åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨çº¹ç†ï¼šé‡‡æ ·å™¨å˜é‡å’Œçº¹ç†å•å…ƒã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œåœ¨ç¡¬ä»¶ä¸­æ‰§è¡Œçº¹ç†å¤„ç†ã€‚åˆ™éœ€è¦é€šè¿‡ç»Ÿä¸€é‡‡æ ·å™¨å˜é‡å®ç°ã€‚
<ul>
<li>ç»Ÿä¸€é‡‡æ ·å™¨å˜é‡ï¼šæŒ‡ç¤ºæ˜¾å¡ä¸Šçš„çº¹ç†å•å…ƒï¼Œä»åŠ è½½çš„çº¹ç†å¯¹è±¡ä¸­æå–æˆ–é‡‡æ ·çº¹ç†å›¾åƒä¸­çš„åƒç´ ã€‚</li>
</ul>
</li>
</ol>
<pre><code class="language-cpp">layout(binding = 0) uniform sampler2D samp;
</code></pre>
<ul>
<li>
<p><code>layout(binding = 0)</code> è¡¨ç¤ºé‡‡æ ·å™¨å˜é‡ <code>samp</code> çš„ç»‘å®šç¬¬0ä¸ªçº¹ç†å•å…ƒã€‚</p>
</li>
<li>
<p>å¯ç”¨çº¹ç†å•å…ƒçš„æ•°é‡å–å†³äºæ˜¾å¡æä¾›çš„æ•°é‡ã€‚</p>
</li>
</ul>
<ol start="5">
<li>
<p>åœ¨ <code>display()</code> å‡½æ•°ä¸­ï¼Œè°ƒç”¨ <code>glActiveTexture()</code> å‡½æ•°æ¿€æ´»çº¹ç†å•å…ƒå¹¶è°ƒç”¨ <code>glBindTexture()</code> å‡½æ•°å°†çº¹ç†å•å…ƒç»‘å®šåˆ°ç‰¹å®šçš„çº¹ç†å¯¹è±¡ã€‚</p>
<ul>
<li>ä»£ç ä¸­ä½¿ç”¨ <code>GL_TEXTURE0</code> è®©ç¬¬0ä¸ªçº¹ç†å•å…ƒå¤„äºæ¿€æ´»çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>
<p>ç‰‡æ®µç€è‰²å™¨ä¸­ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨æ¥æ”¶çš„æ’å€¼çº¹ç†åæ ‡æ¥å¯¹çº¹ç†å¯¹è±¡è¿›è¡Œé‡‡æ ·ï¼š</p>
</li>
</ol>
<pre><code class="language-cpp">in vec2 tc;
â€¦â€¦
color = texture(samp, tc);
</code></pre>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_pyramidwithtexture.jpg" alt="å¸¦çº¹ç†çš„å››æ£±é”¥"></p>
<p>å®Œæ•´ä»£ç ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;

GLuint renderProgram;

const int numVAO = 1, numVBO = 2;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint textureID[2];
GLuint mvLoc, projLoc;

glm::mat4 pMat, vMat, mMat, mvMat;

std::stack&lt;glm::mat4&gt; matrixStack;

void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
    float pyramidVertexs[54] = {
        -1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  0.0f,  1.0f,  0.0f,
         1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  0.0f,  1.0f,  0.0f,
         1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  0.0f,  1.0f,  0.0f,
        -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  0.0f,  1.0f,  0.0f,
        -1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,
         1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f
    };

    float textures[36] = {
        0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
        0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
        0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
        0.0f, 0.0f, 1.0f, 0.0f, 0.5f, 1.0f,
        0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f,
        1.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f
    };

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]);

    glGenBuffers(numVBO, vbo);
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(pyramidVertexs), pyramidVertexs, GL_STATIC_DRAW);
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(textures), textures, GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 1.5f, cameraY = 0.0f, cameraZ = 5.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
    textureID[0] = Util::loadTexture("brick1.jpg");
    textureID[1] = Util::loadTexture("ice.jpg");
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    for (int i = 0; i &lt; 2; i ++)
    {
        vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
        mMat = glm::translate(glm::mat4(1.0f), glm::vec3(i * 3.0f, 0.0f, 0.0f));
        // æ—‹è½¬å±•ç¤ºå„ä¸ªé¢
        mMat = glm::rotate(mMat, -0.45f, glm::vec3(1.0f, 0.0f, 0.0f));
        mMat = glm::rotate(mMat, 0.61f, glm::vec3(0.0f, 1.0f, 0.0f));
        mMat = glm::rotate(mMat, 0.00f, glm::vec3(0.0f, 0.0f, 1.0f));

        mvMat = vMat * mMat;

        glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
        glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));

        glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
        glEnableVertexAttribArray(0);

        glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
        glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
        glEnableVertexAttribArray(1);

        glActiveTexture(GL_TEXTURE0);
        glBindTexture(GL_TEXTURE_2D, textureID[i]);

        glEnable(GL_DEPTH_TEST);
        glDepthFunc(GL_LEQUAL);
        glDrawArrays(GL_TRIANGLES, 0, 18);
    }
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Pyramid with texture", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<details><summary>Util.h</summary>
<pre><code class="language-cpp">#pragma once

#include &lt;GL/glew.h&gt;
#include &lt;GLFW/glfw3.h&gt;
#include &lt;SOIL2/soil2.h&gt;
#include &lt;glm/glm.hpp&gt;
#include &lt;glm/gtc/type_ptr.hpp&gt;
#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;cmath&gt;
#include &lt;vector&gt;

class Util
{
public:
    static std::string readShaderSource(const std::string &amp;path);
    static void printShaderLog(GLuint shader);
    static void printProgramLog(GLuint program);
    static bool checkOpenGLerror();

    static GLuint createShadeProgram(const std::string vpath, const std::string fpath);
    static GLuint loadTexture(const std::string &amp;imgPath);
};
</code></pre>
</details>
<details><summary>Util.cpp</summary>
<pre><code class="language-cpp">#include "Util.h"

/*
* ä»æ–‡ä»¶ä¸­è¯»å– GLSL ä»£ç 
* @param path æ–‡ä»¶è·¯å¾„
*/
std::string Util::readShaderSource(const std::string &amp;path)
{
    std::string content = "";
    std::ifstream fileStream(path, std::ios::in);
    std::string line = "";
    while (!fileStream.eof())
    {
        getline(fileStream, line);
        content.append(line + "\n");
    }
    fileStream.close();
    return content;
}

/*
* å½“ GLSL ä»£ç ç¼–è¯‘å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param shader ç€è‰²å™¨æ ‡è¯†
*/
void Util::printShaderLog(GLuint shader)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetShaderInfoLog(shader, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Shader Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* å½“ GLSL é“¾æ¥å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param program ç€è‰²å™¨ç¨‹åºæ ‡è¯†
*/
void Util::printProgramLog(GLuint program)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetProgramiv(program, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetProgramInfoLog(program, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Program Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* æ£€æŸ¥ OpenGL é”™è¯¯æ ‡å¿—ï¼Œå³æ˜¯å¦å‘ç”Ÿ OpenGL é”™è¯¯
*/
bool Util::checkOpenGLerror()
{
    bool err = false;
    int glErr = glGetError();
    while (glErr != GL_NO_ERROR)
    {
        std::cout &lt;&lt; "glError: " &lt;&lt; glErr &lt;&lt; "\n";
        err = true;
        glErr = glGetError();
    }
    return err;
}

/*
* åˆ›å»ºç€è‰²å™¨ç¨‹åº
* @param vpath é¡¶ç‚¹ç€è‰²å™¨è·¯å¾„
* @param fpath ç‰‡æ®µç€è‰²å™¨è·¯å¾„
*/
GLuint Util::createShadeProgram(const std::string vpath, const std::string fpath)
{
    // è®°å½•é”™è¯¯ä¿¡æ¯
    GLint vertCompiled, fragCompiled, linked;

    // é¡¶ç‚¹ç€è‰²å™¨
    std::string vs = readShaderSource(vpath);
    // ç‰‡æ®µç€è‰²å™¨
    std::string fs = readShaderSource(fpath);
    const char *vshaderSource = vs.c_str();
    const char *fshaderSource = fs.c_str();

    // åˆ†åˆ«å­˜å…¥ vShader å’Œ fShader å˜é‡
    GLuint vShader = glCreateShader(GL_VERTEX_SHADER);
    GLuint fShader = glCreateShader(GL_FRAGMENT_SHADER);

    // å°† GLSL ä»£ç ä»å­—ç¬¦ä¸²è½½å…¥ç©ºç€è‰²å™¨å¯¹è±¡ä¸­
    glShaderSource(vShader, 1, &amp;vshaderSource, NULL);
    glShaderSource(fShader, 1, &amp;fshaderSource, NULL);

    // ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨
    glCompileShader(vShader);
    checkOpenGLerror();
    glGetShaderiv(vShader, GL_COMPILE_STATUS, &amp;vertCompiled);
    if (vertCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "vertex compilation failed\n";
        printShaderLog(vShader);
    }
    // ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨
    glCompileShader(fShader);
    checkOpenGLerror();
    glGetShaderiv(fShader, GL_COMPILE_STATUS, &amp;fragCompiled);
    if (fragCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "fragment compilation failed\n";
        printShaderLog(fShader);
    }

    GLuint vProgram = glCreateProgram();
    glAttachShader(vProgram, vShader);
    glAttachShader(vProgram, fShader);
    glLinkProgram(vProgram);
    checkOpenGLerror();
    glGetProgramiv(vProgram, GL_LINK_STATUS, &amp;linked);
    if (linked == GL_FALSE)
    {
        std::cout &lt;&lt; "linking failed\n";
        printProgramLog(vProgram);
    }

    return vProgram; // è¿”å›ç€è‰²å™¨ç¨‹åºID
}

/*
* ä»æ–‡ä»¶ä¸­è¯»å–çº¹ç†å›¾åƒå¹¶è¿”å›çº¹ç† ID
* @param imgPath å›¾åƒæ–‡ä»¶è·¯å¾„
*/
GLuint Util::loadTexture(const std::string &amp;imgPath)
{
    GLuint textureID;
    textureID = SOIL_load_OGL_texture(imgPath.c_str(), SOIL_LOAD_AUTO, SOIL_CREATE_NEW_ID, SOIL_FLAG_INVERT_Y);
    if (textureID == 0)
        std::cout &lt;&lt; "Failed to load texture: " &lt;&lt; imgPath &lt;&lt; "\n";
    return textureID;
}
</code></pre>
</details>
<details><summary>vertex.glsl</summary>
<pre><code class="language-cpp">#version 460 core

layout(location = 0) in vec3 position;
layout(location = 1) in vec2 texCoord;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
layout(binding = 0) uniform sampler2D samp;

out vec2 tc;

void main()
{
    gl_Position = proj_matrix * mv_matrix * vec4(position, 1.0);
    tc = texCoord;
}
</code></pre>
</details>
<details><summary>fragment.glsl</summary>
<pre><code class="language-cpp">#version 460 core

in vec2 tc;
out vec4 color;

layout(binding = 0) uniform sampler2D samp;

void main()
{
    color = texture(samp, tc);
}
</code></pre>
</details>
<h3 id="5-4-å¤šçº§æ¸è¿œçº¹ç†è´´å›¾">5.4 å¤šçº§æ¸è¿œçº¹ç†è´´å›¾</h3>
<p>çº¹ç†è´´å›¾ç»å¸¸ä¼šåœ¨æ¸²æŸ“å›¾åƒä¸­å¯¼è‡´å„ç§ä¸åˆ©çš„ä¼ªå½±ã€‚</p>
<ul>
<li>è¿™æ˜¯å› ä¸ºçº¹ç†å›¾åƒçš„åˆ†è¾¨ç‡æˆ–é•¿å®½æ¯”å¾ˆå°‘ä¸è¢«çº¹ç†è´´å›¾çš„åœºæ™¯ä¸­åŒºåŸŸçš„åˆ†è¾¨ç‡æˆ–é•¿å®½æ¯”åŒ¹é…ã€‚</li>
</ul>
<ol>
<li>
<p>å½“å›¾åƒåˆ†è¾¨ç‡å°äºæ‰€ç»˜åˆ¶åŒºåŸŸçš„åˆ†è¾¨ç‡æ—¶ï¼Œä¼šå‡ºç°ä¸€ç§å¾ˆå¸¸è§çš„ä¼ªå½±ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦æ‹‰ä¼¸å›¾åƒä»¥è¦†ç›–æ•´ä¸ªåŒºåŸŸï¼Œè¿™æ ·å›¾åƒå°±ä¼šå˜å¾—æ¨¡ç³Šï¼ˆå¹¶ä¸”å¯èƒ½å˜å½¢ï¼‰ã€‚</p>
<ul>
<li>æ ¹æ®çº¹ç†çš„æ€§è´¨ï¼Œæœ‰æ—¶å¯ä»¥é€šè¿‡æ”¹å˜çº¹ç†åæ ‡åˆ†é…æ–¹å¼æ¥åº”å¯¹è¿™ç§æƒ…å†µï¼Œä½¿å¾—çº¹ç†éœ€è¦è¾ƒå°‘çš„æ‹‰ä¼¸ã€‚</li>
<li>å¦ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ›´é«˜åˆ†è¾¨ç‡çš„çº¹ç†å›¾åƒã€‚</li>
</ul>
</li>
<li>
<p>ç›¸åçš„æƒ…å†µæ˜¯å›¾åƒçº¹ç†çš„åˆ†è¾¨ç‡å¤§äºè¢«ç»˜åˆ¶åŒºåŸŸçš„åˆ†è¾¨ç‡ã€‚</p>
<ul>
<li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°æ˜æ˜¾çš„å å½±ï¼Œä»è€Œäº§ç”Ÿå¥‡æ€ªçš„é”™è¯¯å›¾æ¡ˆï¼Œæˆ–ç§»åŠ¨ç‰©ä½“ä¸­çš„â€œé—ªçƒâ€æ•ˆæœã€‚</li>
<li>å å½±æ˜¯ç”±é‡‡æ ·é”™è¯¯å¼•èµ·çš„ã€‚</li>
</ul>
</li>
</ol>
<p>ä½¿ç”¨å¤šçº§æ¸è¿œçº¹ç†è´´å›¾å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸ŠçŸ«æ­£é‡‡æ ·è¯¯å·®ä¼ªå½±ã€‚</p>
<ul>
<li>ä½¿ç”¨å„ç§åˆ†è¾¨ç‡åˆ›å»ºçº¹ç†å›¾åƒçš„ä¸åŒç‰ˆæœ¬ã€‚</li>
<li>è¢«è´´å›¾çš„åŒºåŸŸä½¿ç”¨æœ€é€‚åˆçš„åˆ†è¾¨ç‡çš„çº¹ç†å›¾åƒã€‚</li>
</ul>
<p>å¤šçº§æ¸è¿œçº¹ç†è´´å›¾çš„æœºåˆ¶ï¼š</p>
<ul>
<li>å®ƒåœ¨çº¹ç†å›¾åƒä¸­å­˜å‚¨ç›¸åŒå›¾åƒçš„è¿ç»­çš„ä¸€ç³»åˆ—è¾ƒä½åˆ†è¾¨ç‡çš„å‰¯æœ¬ã€‚</li>
<li>æ‰€ç”¨çš„çº¹ç†å›¾åƒæ¯”åŸå§‹å›¾åƒå¤§ 1/3ï¼Œå…¶ä¸­å›¾åƒçš„ RGB å€¼åˆ†åˆ«å­˜å‚¨åœ¨çº¹ç†å›¾åƒç©ºé—´çš„ 3 ä¸ª 1/4 åŒºåŸŸä¸­æ¥å®ç°çš„ã€‚</li>
<li>å‰©ä½™çš„ 1/4 åŒºåŸŸä¸­è¿­ä»£åœ°å°†å›¾åƒåˆ†è¾¨ç‡è®¾ç½®ä¸ºåŸæ¥çš„ 1/4ï¼Œç›´åˆ°å‰©ä½™åŒºåŸŸå¤ªå°è€Œä¸åŒ…å«ä»»ä½•æœ‰ç”¨çš„å›¾åƒæ•°æ®ã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_Multileveltexture.jpg" alt="å¤šçº§æ¸è¿œçº¹ç†è´´å›¾ç¤ºä¾‹ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬äºŒç‰ˆï¼‰"></p>
<p>ä½¿ç”¨ä»£ç è¿›è¡Œæ„å»ºå¤šçº§æ¸è¿œçº¹ç†ï¼š</p>
<pre><code class="language-cpp">// â€¦â€¦
glBindTexture(GL_TEXTURE_2D, textureID);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
glGenerateMipmap(GL_TEXTURE_2D);
// â€¦â€¦
</code></pre>
<p>å¯¹äºå‡½æ•° <code>glTexparameteri()</code> å…¶ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®ä¸ºæ‰€éœ€çš„ç¼©å°æ–¹æ³•æ¥é€‰æ‹©å¤šçº§æ¸è¿œçº¹ç†çš„é‡‡æ ·æ–¹æ³•ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>GL_NEAREST_MIPMAP_NEAREST</code>ï¼šé€‰æ‹©å…·æœ‰ä¸çº¹ç†åæ ‡å¯¹åº”çš„çº¹ç†å›¾åƒåƒç´ åŒºåŸŸæœ€ç›¸ä¼¼çš„åˆ†è¾¨ç‡çš„å¤šçº§æ¸è¿œçº¹ç†ï¼Œè·å–æ‰€éœ€çº¹ç†åæ ‡çš„æœ€è¿‘çš„çº¹ç†å›¾åƒåƒç´ ã€‚</li>
<li><code>GL_LINEAR_MIPMAP_NEAREST</code>ï¼šé€‰æ‹©å…·æœ‰ä¸çº¹ç†åæ ‡å¯¹åº”çš„çº¹ç†å›¾åƒåƒç´ åŒºåŸŸæœ€ç›¸ä¼¼çš„åˆ†è¾¨ç‡çš„å¤šçº§æ¸è¿œçº¹ç†ï¼Œè·å–æœ€æ¥è¿‘çº¹ç†åæ ‡çš„4ä¸ªçº¹ç†å›¾åƒåƒç´ çš„æ’å€¼ã€‚</li>
<li><code>GL_NEAREST_MIPMAP_LINEAR</code>ï¼šé€‰æ‹©å…·æœ‰ä¸çº¹ç†åæ ‡å¯¹åº”çš„çº¹ç†å›¾åƒåƒç´ åŒºåŸŸæœ€ç›¸ä¼¼çš„åˆ†è¾¨ç‡çš„2ä¸ªå¤šçº§æ¸è¿œçº¹ç†ï¼Œä»æ¯ä¸ªå¤šçº§æ¸è¿œçº¹ç†è·å–çº¹ç†åæ ‡çš„æœ€è¿‘çš„çº¹ç†å›¾åƒåƒç´ è¿›è¡Œæ’å€¼ã€‚</li>
<li><code>GL_LINEAR_MIPMAP_LINEAR</code>ï¼šé€‰æ‹©å…·æœ‰ä¸çº¹ç†åæ ‡å¯¹åº”çš„çº¹ç†å›¾åƒåƒç´ åŒºåŸŸæœ€ç›¸ä¼¼çš„åˆ†è¾¨ç‡çš„2å¤šä¸ªæ¸è¿œçº¹ç†ï¼Œä»æ¯å¤šä¸ªæ¸è¿œçº¹ç†è·å–æœ€æ¥è¿‘çº¹ç†åæ ‡çš„4ä¸ªçº¹ç†å›¾åƒåƒç´ è¿›è¡Œæ’å€¼ï¼Œåˆç§°ä¸ºâ€œä¸‰çº¿æ€§è¿‡æ»¤â€ã€‚</li>
</ul>
<p>é€šå¸¸é€‰æ‹©ä¸‰çº¿æ€§è¿‡æ»¤ã€‚</p>
<p><em>å¯¹äºç‰¹æ®Šçš„åº”ç”¨åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å›¾åƒç¼–è¾‘è½¯ä»¶è‡ªè¡Œæ„å»ºå¤šçº§æ¸è¿œçº¹ç†ï¼Œç„¶åé€šè¿‡ä¸ºæ¯ä¸ªå¤šçº§æ¸è¿œçº¹ç†çº§åˆ«é‡å¤è°ƒç”¨ OpenGL çš„ <code>glTexImage2D()</code> å‡½æ•°æ¥åˆ›å»ºçº¹ç†å¯¹è±¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ ä¸ºå¤šçº§æ¸è¿œçº¹ç†çº§åˆ«</em></p>
<h3 id="5-5-å„å‘å¼‚æ€§è¿‡æ»¤">5.5 å„å‘å¼‚æ€§è¿‡æ»¤</h3>
<p>å¤šçº§æ¸è¿œçº¹ç†è´´å›¾æœ‰æ—¶çœ‹èµ·æ¥æ¯”éå¤šçº§æ¸è¿œçº¹ç†è´´å›¾æ›´æ¨¡ç³Šã€‚</p>
<ul>
<li>è¿™ç§ç»†èŠ‚çš„ä¸¢å¤±æ˜¯å› ä¸ºå½“ç‰©ä½“å€¾æ–œæ—¶ï¼Œå…¶å›¾å…ƒçœ‹èµ·æ¥åœ¨ä¸€ä¸ªè½´ï¼ˆå³æ²¿å®½æˆ–é«˜ï¼‰ä¸Šçš„å°ºå¯¸æ¯”åœ¨å¦ä¸€ä¸ªè½´ä¸Šæ›´å°ã€‚</li>
<li>å½“ OpenGL ä¸ºå›¾å…ƒè´´å›¾æ—¶ï¼Œå®ƒé€‰æ‹©é€‚åˆä¸¤ä¸ªè½´ä¸­å°ºå¯¸è¾ƒå°çš„è½´çš„å¤šçº§æ¸è¿œçº¹ç†ï¼‰ã€‚</li>
</ul>
<p>å¯ä»¥é€šè¿‡å„å‘å¼‚æ€§è¿‡æ»¤æ¢å¤ä¸€äº›ä¸¢å¤±çš„ç»†èŠ‚ã€‚</p>
<ul>
<li>å„å‘å¼‚æ€§è¿‡æ»¤æ¯”æ ‡å‡†å¤šçº§æ¸è¿œçº¹ç†è´´å›¾çš„è®¡ç®—ä»£ä»·æ›´é«˜ï¼Œå¹¶ä¸”ä¸æ˜¯ OpenGL çš„å¿…éœ€éƒ¨åˆ†ã€‚</li>
</ul>
<p>åªéœ€æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-cpp">if (glewIsSupported("GL_EXT_texture_filter_anisotropic"))
{
    GLfloat anisoSetting = 0.0f;
    glGetFloatv(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT, &amp;anisoSetting);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAX_ANISOTROPY_EXT, anisoSetting);
}
</code></pre>
<ul>
<li><code>if</code> åˆ¤æ–­æµ‹è¯•æ˜¾å¡æ˜¯å¦æ”¯æŒå„å‘å¼‚æ€§è¿‡æ»¤ã€‚å¦‚æœæ”¯æŒï¼Œåˆ™è®¾ç½®ä¸ºæ”¯æŒçš„æœ€å¤§é‡‡æ ·ç¨‹åº¦ï¼Œç”± <code>glGetFloatv()</code> å‡½æ•°è·å–ã€‚</li>
<li>ä½¿ç”¨ <code>glTexParameterf()</code> å‡½æ•°æ¿€æ´»å¹¶è®¾ç½®çº¹ç†çš„å„å‘å¼‚æ€§é‡‡æ ·å€¼ã€‚</li>
</ul>
<h3 id="5-6-ç¯ç»•å’Œå¹³é“º">5.6 ç¯ç»•å’Œå¹³é“º</h3>
<p>å½“çº¹ç†åæ ‡è¶…å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>glTexParameteri()</code> å‡½æ•°è®¾ç½®ï¼š</p>
<ul>
<li><code>GL_REPEAT</code>ï¼šé‡å¤çº¹ç†å›¾åƒï¼Œå¿½ç•¥çº¹ç†åæ ‡çš„æ•´æ•°éƒ¨åˆ†ï¼Œç”Ÿæˆé‡å¤æˆ–å¹³é“ºçš„å›¾æ¡ˆï¼Œè¿™æ˜¯é»˜è®¤é€‰é¡¹ã€‚</li>
<li><code>GL_MIRRORED_REPEAT</code>ï¼šé‡å¤çº¹ç†å›¾åƒï¼Œå¿½ç•¥çº¹ç†åæ ‡çš„æ•´æ•°éƒ¨åˆ†ï¼Œä½†æ˜¯å½“æ•´æ•°éƒ¨åˆ†ä¸ºå¥‡æ•°æ—¶åè½¬åæ ‡ï¼Œé‡å¤çš„å›¾æ¡ˆåœ¨åŸå›¾æ¡ˆå’Œå…¶é•œåƒå›¾æ¡ˆä¹‹é—´äº¤æ›¿ã€‚</li>
<li><code>GL_CLAMP_TO_EDGE</code>ï¼šå°†çº¹ç†åæ ‡é™åˆ¶åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> ä¹‹é—´ï¼Œå°äº0çš„åæ ‡è®¾ç½®ä¸º0ï¼Œå¤§äº1çš„åæ ‡è®¾ç½®ä¸º1ã€‚</li>
<li><code>GL_CLAMP_TO_BORDER</code>ï¼šå°†çº¹ç†åæ ‡é™åˆ¶åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> ä¹‹é—´ï¼ŒåŒºé—´ä»¥å¤–è®¾ç½®ä¸ºæŒ‡å®šçš„è¾¹æ¡†é¢œè‰²ã€‚</li>
</ul>
<p>ä»£ç ä¸Šï¼š</p>
<pre><code class="language-cpp">// è®¾ç½®ä¸ºé‡å¤
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
</code></pre>
<p>ä¿®æ”¹ä¸º <code>GL_CLAMP_TO_BORDER</code>ï¼š</p>
<pre><code class="language-cpp">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_BORDER);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_BORDER);
float redColor[4] = { 1.0f, 0.0f, 0.0f, 1.0f };
glTexParameterfv(GL_TEXTURE_2D, GL_TEXTURE_BORDER_COLOR, redColor);
</code></pre>
<h3 id="5-7-é€è§†å˜å½¢">5.7 é€è§†å˜å½¢</h3>
<p>åœ¨çº¹ç†åæ ‡çš„æƒ…å†µä¸‹ï¼Œçº¿æ€§æ’å€¼å¯èƒ½å¯¼è‡´åœ¨å…·æœ‰é€è§†æŠ•å½±çš„ 3D åœºæ™¯ä¸­å‡ºç°æ˜æ˜¾çš„å¤±çœŸã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_distortion.jpg" alt="å¤±çœŸï¼ˆå·¦ï¼‰ï¼Œçº æ­£ï¼ˆå³ï¼‰ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬äºŒç‰ˆï¼‰"></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒOpenGL åœ¨æ …æ ¼åŒ–æœŸé—´ä¼šåº”ç”¨é€è§†æ ¡æ­£ç®—æ³•ã€‚</p>
<ul>
<li>å¯ä»¥åœ¨é¡¶ç‚¹å±æ€§ä¸­æ·»åŠ å…³é”®å­— <code>noperspective</code> æ¥ç¦ç”¨é€è§†æ ¡æ­£ã€‚</li>
<li>é¡¶ç‚¹ç€è‰²å™¨ï¼š<code>noperspective out vec2 texCoord;</code></li>
<li>ç‰‡æ®µç€è‰²å™¨ï¼š<code>noperspective in vec2 texCoord;</code></li>
</ul>
<h3 id="5-8-æè´¨çš„æ›´å¤šç»†èŠ‚">5.8 æè´¨çš„æ›´å¤šç»†èŠ‚</h3>
<p>å¯ä»¥ä½¿ç”¨ C++ å’Œ OpenGL å‡½æ•°ç›´æ¥å°†çº¹ç†å›¾åƒæ–‡ä»¶æ•°æ®åŠ è½½åˆ° OpenGL ä¸­ï¼ˆä¸é€‚ç”¨ SOIL2 åº“ï¼‰ï¼š</p>
<ol>
<li>ä½¿ç”¨ C++ å·¥å…·è¯»å–å›¾åƒæ–‡ä»¶æ•°æ®ã€‚
<ul>
<li>C++ å‡½æ•° <code>fopen()</code>ã€<code>fread()</code>ã€‚</li>
</ul>
</li>
<li>ç”Ÿæˆ OpenGL çº¹ç†å¯¹è±¡ã€‚
<ul>
<li>ä½¿ç”¨ <code>glGenTextures()</code> å‡½æ•°ç”Ÿæˆçº¹ç†å¯¹è±¡ã€‚</li>
<li><code>glGenTextures(1, &amp;textureID);</code></li>
</ul>
</li>
<li>å°†å›¾åƒæ–‡ä»¶æ•°æ®å¤åˆ¶åˆ°çº¹ç†å¯¹è±¡ä¸­ã€‚
<ul>
<li>
<p>ä½¿ç”¨ <code>glTexImage2D()</code> å‡½æ•°å°†å›¾åƒæ–‡ä»¶æ•°æ®å¤åˆ¶åˆ°çº¹ç†å¯¹è±¡ä¸­ã€‚</p>
</li>
<li>
<p><code>data</code> ä¸ºå›¾åƒæ–‡ä»¶æ•°æ®ï¼Œæ•°æ®ç±»å‹ä¸º <code>unsigned char</code>ã€‚</p>
<pre><code class="language-cpp">GLuint textureID;
glGenTextures(1, &amp;textureID);
glBindTexture(GL_TEXTURE_2D, textureID);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, GL_RGB, GL_UNSIGNED_BYTE, data);
</code></pre>
</li>
</ul>
</li>
</ol>
<h2 id="å…­-3dæ¨¡å‹">å…­ã€3Dæ¨¡å‹</h2>
<p>å¯¹äºå››æ£±é”¥å’Œç«‹æ–¹ä½“ï¼Œå¯ä»¥é€šè¿‡åœ¨OpenGLä¸­ä½¿ç”¨é¡¶ç‚¹æ•°ç»„æ¥åˆ›å»ºã€‚ä½†æ˜¯å¤§éƒ¨åˆ† 3D åœºæ™¯å¯¹è±¡éƒ½æ¯”è¾ƒå¤æ‚ï¼Œæ— æ³•æ‰‹åŠ¨æ„å»ºé¡¶ç‚¹æ•°ç»„ã€‚</p>
<p>å¯¹äºæ›´ä¸ºå¤æ‚çš„æ¨¡å‹ï¼Œæ­¤å¤„å…³æ³¨ï¼š</p>
<ul>
<li>é€šè¿‡ç¨‹åºæ¥æ„å»ºæ¨¡å‹</li>
<li>åŠ è½½å¤–éƒ¨åˆ›å»ºçš„æ¨¡å‹</li>
</ul>
<h3 id="6-1-ç¨‹åºæ„å»ºæ¨¡å‹">6.1 ç¨‹åºæ„å»ºæ¨¡å‹</h3>
<h4 id="6-1-1-æ„å»ºä¸€ä¸ªçƒä½“">6.1.1 æ„å»ºä¸€ä¸ªçƒä½“</h4>
<p>åƒåœ†ã€çƒä½“ç­‰å…·æœ‰æ•°å­¦å®šä¹‰ï¼Œå…¶é¡¶ç‚¹æ•°ç»„å¯ä»¥é€šè¿‡æ•°å­¦è®¡ç®—è€Œç”Ÿæˆã€‚</p>
<p>å»ºç«‹ä¸€ä¸ªçƒä½“æ¨¡å‹ï¼š</p>
<ol>
<li>é€‰æ‹©æ¨¡å‹ç²¾åº¦ï¼šä¸€ä¸ªè¡¨ç¤ºå°†çƒä½“åˆ†æˆç›¸åº”ä»½æ•°çš„åœ†å½¢éƒ¨åˆ†çš„æ•°å­—ï¼Œä½“ç°ä¸ºåˆ‡ç‰‡æ•°ã€‚</li>
<li>å°†æ¯ä¸ªåœ†å½¢åˆ‡ç‰‡çš„åœ†å‘¨ç»†åˆ†è‹¥å¹²ä¸ªç‚¹ï¼Œæ­¤å¤„æ¯ä¸ªåˆ‡ç‰‡å…·æœ‰ç›¸åŒæ•°é‡çš„ç‚¹ã€‚</li>
<li>å°†é¡¶ç‚¹åˆ†ç»„ä¸ºä¸‰è§’å½¢ï¼šé€æ­¥éå†é¡¶ç‚¹ï¼Œåœ¨æ¯ä¸€æ­¥æ„å»ºä¸¤ä¸ªä¸‰è§’å½¢ã€‚</li>
</ol>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_group.jpg" alt="å°†é¡¶ç‚¹ç»„åˆæˆä¸‰è§’å½¢"></p>
<ol start="4">
<li>æ ¹æ®çº¹ç†å›¾åƒçš„æ€§è´¨é€‰æ‹©çº¹ç†åæ ‡ã€‚å¯¹äºçƒä½“ï¼Œæƒ³è±¡è®©çº¹ç†å›¾åƒå›´ç»•çƒä½“åŒ…è£¹ï¼Œå¯ä»¥æ ¹æ®å›¾åƒä¸­åƒç´ çš„æœ€ç»ˆå¯¹åº”ä½ç½®ä¸ºæ¯ä¸ªé¡¶ç‚¹æŒ‡å®šçº¹ç†åæ ‡ã€‚</li>
<li>å¯¹äºæ¯ä¸ªé¡¶ç‚¹ï¼Œè¿˜åº”è¯¥ç”Ÿæˆæ³•å‘é‡ï¼Œç”¨äºå…‰ç…§ã€‚</li>
</ol>
<p>åœ¨ç¬¬3ç‚¹ä¸­ï¼Œå­˜åœ¨é¡¶ç‚¹å‡ºç°åœ¨å¤šä¸ªä¸‰è§’å½¢ä¸­ï¼Œå¯¼è‡´æ¯ä¸ªé¡¶ç‚¹è¢«å¤šæ¬¡æŒ‡å®šï¼Œè¿™å¯¹ç¨‹åºä¸åˆ©ã€‚ä»…å­˜å‚¨æ¯ä¸ªé¡¶ç‚¹ä¸€æ¬¡ï¼Œç„¶åä¸ºä¸‰è§’å½¢çš„æ¯ä¸ªè§’æŒ‡å®šç´¢å¼•ï¼Œå¼•ç”¨æ‰€éœ€çš„é¡¶ç‚¹ã€‚</p>
<ul>
<li>éœ€è¦å­˜å‚¨æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ã€çº¹ç†åæ ‡å’Œæ³•å‘é‡ã€‚
<ul>
<li>é¡¶ç‚¹å­˜å‚¨åœ¨ä¸€ç»´æ•°ç»„ä¸­ï¼Œä»æœ€ä¸‹é¢çš„æ°´å¹³åˆ‡ç‰‡å¼€å§‹ã€‚</li>
<li>ç´¢å¼•æ•°ç»„åŒ…å«ç›¸åº”ä¸‰è§’å½¢çš„æ¯ä¸ªè§’ï¼Œå°†å€¼è®¾ä¸ºé¡¶ç‚¹æ•°ç»„ä¸­çš„ä¸‹æ ‡ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_index.png" alt="é¡¶ç‚¹æ•°ç»„å’Œç´¢å¼•æ•°ç»„"></p>
<p>ç„¶åï¼Œä»çƒä½“åº•éƒ¨å¼€å§‹ï¼Œå›´ç»•æ¯ä¸ªæ°´å¹³åˆ‡ç‰‡ä»¥åœ†å½¢æ–¹å¼éå†é¡¶ç‚¹ã€‚è®¿é—®æ¯ä¸ªé¡¶ç‚¹æ—¶ï¼Œæ„å»ºä¸¤ä¸ªä¸‰è§’å½¢ï¼Œåœ¨å…¶å³ä¸Šæ–¹å½¢æˆä¸€ä¸ªæ–¹å½¢åŒºåŸŸã€‚</p>
<pre><code class="language-cpp">// slices ä¸ºåˆ‡ç‰‡æ•°ï¼Œä¹Ÿæ˜¯ç²¾åº¦
// vertexs ä¸ºæ¯ä¸ªæ°´å¹³åˆ‡ç‰‡çš„é¡¶ç‚¹æ•°
for (int i = 0; i &lt; slices; i++) 
{
    for(int j = 0; j &lt; vertexs; j++)
    {
        // è®¡ç®—é¡¶ç‚¹jçš„æŒ‡å‘å³è¾¹ç›¸é‚»é¡¶ç‚¹ã€ä¸Šæ–¹é¡¶ç‚¹
        // ä»¥åŠå³ä¸Šæ–¹é¡¶ç‚¹çš„ä¸¤ä¸ªä¸‰è§’å½¢çš„ç´¢å¼•
    }
}
</code></pre>
<p>ç´¢å¼•æ•°ç»„ä¹ŸåŠ è½½åˆ° VBO ä¸­ï¼ŒæŒ‡å®š VBO çš„ç±»å‹ä¸º <code>GL_ELEMENT_ARRAY_BUFFER</code>ï¼ˆè¿™ä¼šå‘Šè¯‰ OpenGL è¿™ä¸ª VBO åŒ…å«ç´¢å¼•ï¼‰ã€‚</p>
<ul>
<li>åœ¨ <code>display()</code> ä¸­ï¼š
<ul>
<li>å°† <code>glDrawArrays()</code> è°ƒç”¨æ›¿æ¢ä¸º  <code>glDrawElements()</code> è°ƒç”¨ï¼Œå®ƒä¼šå‘Šè¯‰ OpenGLåˆ©ç”¨ç´¢å¼• VBO æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹ã€‚</li>
<li>è¿˜éœ€è¦ä½¿ç”¨ <code>glBindBuffer()</code> å¯ç”¨åŒ…å«ç´¢å¼•çš„ VBOï¼ŒæŒ‡å®šå“ªä¸ª VBO åŒ…å«ç´¢å¼•å¹¶ä¸”ä¸º <code>GL_ELEMENT_ARRAY_BUFFER</code> ç±»å‹ã€‚</li>
</ul>
</li>
</ul>
<p>ç¼–å†™ç±» <code>Sphere</code>ï¼Œç”¨äºåˆ›å»ºçƒä½“æ¨¡å‹ï¼Œçƒä½“ä¸­å¿ƒä½äºåŸç‚¹ã€‚</p>
<ul>
<li>
<p>é¡¶ç‚¹å­˜å‚¨åœ¨ <code>GLM</code> ä¸­çš„ <code>vec2</code> å’Œ <code>vec3</code> ç¤ºä¾‹çš„ <code>std::vector</code> ä¸­ã€‚</p>
</li>
<li>
<p>å› ä¸ºçº¹ç†è´´å›¾å®Œå…¨åŒ…è£¹åœ¨çƒä½“å‘¨å›´ï¼Œæ‰€ä»¥åœ¨çº¹ç†è´´å›¾çš„å·¦å³è¾¹ç¼˜ç›¸äº¤çš„æ¯ä¸ªç‚¹å¤„éœ€è¦ä¸€ä¸ªé¢å¤–çš„é¡¶ç‚¹æ¥ä½¿è´´å›¾ä¸¤ä¾§é‡åˆã€‚</p>
<ul>
<li>é¡¶ç‚¹çš„æ€»æ•°æ˜¯ <code>(prec+1)*(prec+1)</code>ã€‚ç”±äºæ¯ä¸ªé¡¶ç‚¹ç”Ÿæˆ 6 ä¸ªä¸‰è§’å½¢ç´¢å¼•ï¼Œå› æ­¤ç´¢å¼•çš„æ€»æ•°æ˜¯ <code>prec*prec*6</code>ã€‚</li>
<li><code>prec</code> ä¸ºç²¾åº¦ï¼Œä½“ç°åœ¨åˆ‡ç‰‡æ•°ã€‚</li>
</ul>
</li>
</ul>
<p>æ•ˆæœæˆªå›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_sphere.jpg" alt="çƒä½“"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint textureID;
GLuint mvLoc, projLoc;

glm::mat4 pMat, vMat, mMat, mvMat;

Sphere sphere(48);

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
    std::vector&lt;int&gt; ind = sphere.getIndices();
    std::vector&lt;glm::vec3&gt; vert = sphere.getVertices();
    std::vector&lt;glm::vec2&gt; tex = sphere.getTexCoords();
    std::vector&lt;glm::vec3&gt; norm = sphere.getNormals();

    std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
    std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
    std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

    int numIndices = sphere.getNumIndices();

    for (int i = 0; i &lt; numIndices; ++ i)
    {
        pvalues.push_back(vert[i].x);
        pvalues.push_back(vert[i].y);
        pvalues.push_back(vert[i].z);
        tvalues.push_back(tex[i].s);
        tvalues.push_back(tex[i].t);
        nvalues.push_back(norm[i].x);
        nvalues.push_back(norm[i].y);
        nvalues.push_back(norm[i].z);
    }

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]);

    glGenBuffers(numVBO, vbo);
    // é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
    // çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
    // æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
    // ç´¢å¼•æ”¾å…¥ç¼“å†²åŒº3
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * ind.size(), &amp;ind[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 5.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
    textureID = Util::loadTexture("ice.jpg");
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, -1.0f));
    mMat *= glm::scale(glm::mat4(1.0f), glm::vec3(2.0f, 2.0f, 2.0f));
    mvMat = vMat * mMat;

    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));

    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(1);

    glActiveTexture(GL_TEXTURE0);
    glBindTexture(GL_TEXTURE_2D, textureID);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
    glGenerateMipmap(GL_TEXTURE_2D);
    if (glewIsSupported("GL_EXT_texture_filter_anisotropic"))
    {
        GLfloat anisoSetting = 0.0f;
        glGetFloatv(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT, &amp;anisoSetting);
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAX_ANISOTROPY_EXT, anisoSetting);
    }

    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    // åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    glDrawElements(GL_TRIANGLES, sphere.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Sphere", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<details><summary>çƒä½“ç±»</summary>
<pre><code class="language-cpp">// Sphere.h
#pragma once

#include &lt;cmath&gt;
#include &lt;vector&gt;
#include &lt;glm/glm.hpp&gt;

class Sphere
{
private:
    int numVertices;    // é¡¶ç‚¹æ•°ç»„å¤§å°
    int numIndices;        // ç´¢å¼•æ•°ç»„å¤§å°
    std::vector&lt;glm::vec3&gt; vertices;    // é¡¶ç‚¹æ•°ç»„
    std::vector&lt;int&gt; indices;            // ç´¢å¼•æ•°ç»„
    std::vector&lt;glm::vec3&gt; normals;        // æ³•å‘é‡æ•°ç»„
    std::vector&lt;glm::vec2&gt; texCoords;    // çº¹ç†åæ ‡æ•°ç»„

    void init(int);
    float toRadians(float degrees);

public:
    Sphere(int prec = 48);
    int getNumVertices();
    int getNumIndices();
    std::vector&lt;glm::vec3&gt; getVertices();
    std::vector&lt;int&gt; getIndices();
    std::vector&lt;glm::vec3&gt; getNormals();
    std::vector&lt;glm::vec2&gt; getTexCoords();
};
</code></pre>
<pre><code class="language-cpp">// Sphere.cpp
#include "Sphere.h"

Sphere::Sphere(int prec)
{
    init(prec);
}

void Sphere::init(int _prec)
{
    numVertices = (_prec + 1) * (_prec + 1);
    numIndices = _prec * _prec * 6;
    for (int i = 0; i &lt; numVertices; ++ i)
        vertices.push_back(glm::vec3());
    for (int i = 0; i &lt; numVertices; ++ i)
        texCoords.push_back(glm::vec2());
    for (int i = 0; i &lt; numVertices; ++ i)
        normals.push_back(glm::vec3());
    for (int i = 0; i &lt; numIndices; ++ i)
        indices.push_back(0);

    // è®¡ç®—ä¸‰è§’å½¢é¡¶ç‚¹
    for (int i = 0; i &lt;= _prec; ++ i)
        for (int j = 0; j &lt;= _prec; ++ j)
        {
            float y = static_cast&lt;float&gt;(cos(toRadians(180.0f - i * 180.0f / _prec)));
            float x = - static_cast&lt;float&gt;(cos(toRadians(j * 360.0f / _prec)) * fabs(cos(asin(y))));
            float z = static_cast&lt;float&gt;(sin(toRadians(j * 360.0f / _prec)) * fabs(cos(asin(y))));
            vertices[i * (_prec + 1) + j] = glm::vec3(x, y, z);
            texCoords[i * (_prec + 1) + j] = glm::vec2(j * 1.0f / _prec, i * 1.0f / _prec);
            normals[i * (_prec + 1) + j] = glm::vec3(x, y, z);
        }

    // è®¡ç®—ä¸‰è§’å½¢ç´¢å¼•
    for (int i = 0; i &lt; _prec; ++ i)
        for (int j = 0; j &lt; _prec; ++ j)
        {
            indices[6 * (i * _prec + j) + 0] = i * (_prec + 1) + j;
            indices[6 * (i * _prec + j) + 1] = i * (_prec + 1) + j + 1;
            indices[6 * (i * _prec + j) + 2] = (i + 1) * (_prec + 1) + j;
            indices[6 * (i * _prec + j) + 3] = i * (_prec + 1) + j + 1;
            indices[6 * (i * _prec + j) + 4] = (i + 1) * (_prec + 1) + j + 1;
            indices[6 * (i * _prec + j) + 5] = (i + 1) * (_prec + 1) + j;
        }
}

float Sphere::toRadians(float degrees)
{
    return degrees * 2.0f * 3.14159f / 360.0f;
}

int Sphere::getNumVertices()
{
    return numVertices;
}

int Sphere::getNumIndices()
{
    return numIndices;
}

std::vector&lt;glm::vec3&gt; Sphere::getVertices()
{
    return vertices;
}

std::vector&lt;int&gt; Sphere::getIndices()
{
    return indices;
}

std::vector&lt;glm::vec3&gt; Sphere::getNormals()
{
    return normals;
}

std::vector&lt;glm::vec2&gt; Sphere::getTexCoords()
{
    return texCoords;
}
</code></pre>
</details>
<details><summary>ç€è‰²å™¨</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 position;
layout(location = 1) in vec2 texCoord;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
layout(binding = 0) uniform sampler2D samp;

out vec2 tc;

void main()
{
    gl_Position = proj_matrix * mv_matrix * vec4(position, 1.0);
    tc = texCoord;
}
</code></pre>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

in vec2 tc;
out vec4 color;

layout(binding = 0) uniform sampler2D samp;

void main()
{
    color = texture(samp, tc);
}
</code></pre>
</details>
<h4 id="6-1-2-æ„å»ºä¸€ä¸ªç¯é¢">6.1.2 æ„å»ºä¸€ä¸ªç¯é¢</h4>
<p>äº§ç”Ÿç¯é¢éœ€è¦ä¸€å®šçš„ç®—æ³•ã€‚</p>
<p>æ„å»ºä¸€ä¸ªç¯é¢å¦‚å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_totorus.jpg" alt="å›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬äºŒç‰ˆï¼‰"></p>
<p>å°†ä¸€ä¸ªé¡¶ç‚¹å®šä½åˆ°åŸç‚¹çš„å³ä¾§ï¼Œç„¶ååœ¨ xOy å¹³é¢ä¸Šçš„åœ†ä¸­è®©è¿™ä¸ªé¡¶ç‚¹å›´ç»• z è½´æ—‹è½¬ï¼Œä»¥å½¢æˆâ€œç¯â€ï¼Œæœ€åå°†è¿™ä¸ªç¯â€œå‘å¤–â€ç§»åŠ¨â€œå†…å¾„â€çš„è·ç¦»ã€‚</p>
<p>åœ¨æ„å»ºè¿™äº›é¡¶ç‚¹æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªé¡¶ç‚¹è®¡ç®—çº¹ç†åæ ‡å’Œæ³•å‘é‡ï¼Œè¿˜ä¼šé¢å¤–ä¸ºæ¯ä¸ªé¡¶ç‚¹ç”Ÿæˆä¸ç¯é¢è¡¨é¢ç›¸åˆ‡çš„å‘é‡ï¼ˆç§°ä¸ºåˆ‡å‘é‡ï¼‰ã€‚åœ¨é¡¶ç‚¹åˆ›å»ºä¹‹åï¼Œé€ç¯éå†æ‰€æœ‰é¡¶ç‚¹ï¼Œå¹¶åœ¨æ¯ä¸ªé¡¶ç‚¹ä¸Šç”Ÿæˆä¸¤ä¸ªä¸‰è§’å½¢ã€‚ä¸¤ä¸ªä¸‰è§’å½¢çš„ 6 ä¸ªç´¢å¼•è¡¨çš„ç”Ÿæˆæ–¹å¼å’Œä¹‹å‰çš„çƒä½“ç±»ä¼¼ã€‚</p>
<p>æ•ˆæœæˆªå›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_torus.jpg" alt="ç¯é¢"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
//#include "Sphere.h"
#include "Torus.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint textureID;
GLuint mvLoc, projLoc;

glm::mat4 pMat, vMat, mMat, mvMat;

//Sphere sphere(48);
Torus torus(48, 0.5f, 0.2f);

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
    std::vector&lt;int&gt; ind = torus.getIndices();
    std::vector&lt;glm::vec3&gt; vert = torus.getVertices();
    std::vector&lt;glm::vec2&gt; tex = torus.getTexCoords();
    std::vector&lt;glm::vec3&gt; norm = torus.getNormals();

    std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
    std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
    std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

    int numIndices = torus.getNumIndices();

    for (int i = 0; i &lt; numIndices; ++ i)
    {
        pvalues.push_back(vert[i].x);
        pvalues.push_back(vert[i].y);
        pvalues.push_back(vert[i].z);
        tvalues.push_back(tex[i].s);
        tvalues.push_back(tex[i].t);
        nvalues.push_back(norm[i].x);
        nvalues.push_back(norm[i].y);
        nvalues.push_back(norm[i].z);
    }

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]);

    glGenBuffers(numVBO, vbo);
    // é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
    // çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
    // æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
    // ç´¢å¼•æ”¾å…¥ç¼“å†²åŒº3
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * ind.size(), &amp;ind[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 5.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
    textureID = Util::loadTexture("ice.jpg");
    glBindTexture(GL_TEXTURE_2D, textureID);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, -0.5f));
    mMat = glm::rotate(mMat, 30.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));
    mMat *= glm::scale(glm::mat4(1.0f), glm::vec3(2.0f, 2.0f, 2.0f));
    mvMat = vMat * mMat;

    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));

    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(1);

    glActiveTexture(GL_TEXTURE0);
    glBindTexture(GL_TEXTURE_2D, textureID);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
    glGenerateMipmap(GL_TEXTURE_2D);
    if (glewIsSupported("GL_EXT_texture_filter_anisotropic"))
    {
        GLfloat anisoSetting = 0.0f;
        glGetFloatv(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT, &amp;anisoSetting);
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAX_ANISOTROPY_EXT, anisoSetting);
    }

    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    // åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    glDrawElements(GL_TRIANGLES, torus.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Torus", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<details><summary>ç¯é¢ç±»</summary>
<pre><code class="language-cpp">// Torus.h
#pragma once

#include &lt;cmath&gt;
#include &lt;vector&gt;
#include &lt;glm/gtc/matrix_transform.hpp&gt;

class Torus
{
private:
    int numVertices;
    int numIndices;
    int prec;
    float inner, outer;
    std::vector&lt;int&gt; indices;
    std::vector&lt;glm::vec3&gt; vertices;
    std::vector&lt;glm::vec2&gt; texCoords;
    std::vector&lt;glm::vec3&gt; normals;
    std::vector&lt;glm::vec3&gt; sTangents;
    std::vector&lt;glm::vec3&gt; tTangents;
    void init();
    float toRadians(float degrees);

public:
    Torus(int _prec = 48, float _inner = 0.5, float _outer = 0.2);
    int getNumVertices();
    int getNumIndices();
    std::vector&lt;int&gt; getIndices();
    std::vector&lt;glm::vec3&gt; getVertices();
    std::vector&lt;glm::vec2&gt; getTexCoords();
    std::vector&lt;glm::vec3&gt; getNormals();
    std::vector&lt;glm::vec3&gt; getStangents();
    std::vector&lt;glm::vec3&gt; getTtangents();
};
</code></pre>
<pre><code class="language-cpp">// Torus.cpp
#include "Torus.h"

Torus::Torus(int _prec, float _inner, float _outer)
{
    prec = _prec;
    inner = _inner;
    outer = _outer;
    init();
}

void Torus::init()
{
    numVertices = (prec + 1) * (prec + 1);
    numIndices = prec * prec * 6;
    for (int i = 0; i &lt; numVertices; ++ i)
        vertices.push_back(glm::vec3());
    for (int i = 0; i &lt; numVertices; ++ i)
        texCoords.push_back(glm::vec2());
    for (int i = 0; i &lt; numVertices; ++ i)
        normals.push_back(glm::vec3());
    for (int i = 0; i &lt; numIndices; ++ i)
        indices.push_back(0);
    for (int i = 0; i &lt; numVertices; ++ i)
        sTangents.push_back(glm::vec3());
    for (int i = 0; i &lt; numVertices; ++ i)
        tTangents.push_back(glm::vec3());

    // è®¡ç®—ç¬¬ä¸€ä¸ªç¯
    for (int i = 0; i &lt; prec + 1; ++ i)
    {
        float amt = toRadians(i * 360.0f / prec);
        glm::mat4 rMat = glm::rotate(glm::mat4(1.0f), amt, glm::vec3(0.0f, 0.0f, 1.0f));
        glm::vec3 initPos(rMat * glm::vec4(0.0f, outer, 0.0f, 1.0f));

        vertices[i] = glm::vec3(initPos + glm::vec3(inner, 0.0f, 0.0f));
        texCoords[i] = glm::vec2(0.0f, static_cast&lt;float&gt;(i) / prec);

        rMat = glm::rotate(glm::mat4(1.0f), amt + (3.14159f / 2.0f), glm::vec3(0.0f, 0.0f, 1.0f));
        tTangents[i] = glm::vec3(rMat * glm::vec4(0.0f, -1.0f, 0.0f, 1.0f));
        sTangents[i] = glm::vec3(glm::vec3(0.0f, 0.0f, -1.0f));

        normals[i] = glm::cross(tTangents[i], sTangents[i]);
    }

    // å°†ç¬¬ä¸€ä¸ªç¯ç»•Yè½´æ—‹è½¬ï¼Œå¾—åˆ°å…¶ä»–ç¯
    for (int ring = 1; ring &lt; prec + 1; ++ ring)
        for (int i = 0; i &lt; prec + 1; ++ i)
        {
            float amt = toRadians(ring * 360.0f / prec);

            glm::mat4 rMat = glm::rotate(glm::mat4(1.0f), amt, glm::vec3(0.0f, 1.0f, 0.0f));
            vertices[ring * (prec + 1) + i] = glm::vec3(rMat * glm::vec4(vertices[i], 1.0f));

            texCoords[ring * (prec + 1) + i] = glm::vec2(ring * 2.0f / prec, texCoords[i].t);

            rMat = glm::rotate(glm::mat4(1.0f), amt, glm::vec3(0.0f, 1.0f, 0.0f));
            sTangents[ring * (prec + 1) + i] = glm::vec3(rMat * glm::vec4(sTangents[i], 1.0f));

            rMat = glm::rotate(glm::mat4(1.0f), amt, glm::vec3(0.0f, 1.0f, 0.0f));
            tTangents[ring * (prec + 1) + i] = glm::vec3(rMat * glm::vec4(tTangents[i], 1.0f));

            rMat = glm::rotate(glm::mat4(1.0f), amt, glm::vec3(0.0f, 1.0f, 0.0f));
            normals[ring * (prec + 1) + i] = glm::vec3(rMat * glm::vec4(normals[i], 1.0f));
        }

    // è®¡ç®—ä¸‰è§’å½¢ç´¢å¼•
    for (int ring = 0; ring &lt; prec; ++ ring)
        for (int i = 0; i &lt; prec; ++ i)
        {
            indices[((ring * prec + i) * 2) * 3 + 0] = ring * (prec + 1) + i;
            indices[((ring * prec + i) * 2) * 3 + 1] = (ring + 1) * (prec + 1) + i;
            indices[((ring * prec + i) * 2) * 3 + 2] = ring * (prec + 1) + i + 1;
            indices[((ring * prec + i) * 2 + 1) * 3 + 0] = ring * (prec + 1) + i + 1;
            indices[((ring * prec + i) * 2 + 1) * 3 + 1] = (ring + 1) * (prec + 1) + i;
            indices[((ring * prec + i) * 2 + 1) * 3 + 2] = (ring + 1) * (prec + 1) + i + 1;
        }
}

float Torus::toRadians(float degrees)
{
    return degrees * 2.0f * 3.14159f / 360.0f;
}

int Torus::getNumVertices()
{
    return numVertices;
}

int Torus::getNumIndices()
{
    return numIndices;
}

std::vector&lt;int&gt; Torus::getIndices()
{
    return indices;
}

std::vector&lt;glm::vec3&gt; Torus::getVertices()
{
    return vertices;
}

std::vector&lt;glm::vec2&gt; Torus::getTexCoords()
{
    return texCoords;
}

std::vector&lt;glm::vec3&gt; Torus::getNormals()
{
    return normals;
}

std::vector&lt;glm::vec3&gt; Torus::getStangents()
{
    return sTangents;
}

std::vector&lt;glm::vec3&gt; Torus::getTtangents()
{
    return tTangents;
}
</code></pre>
<ul>
<li>å½“ç»• y è½´æ—‹è½¬ç”Ÿæˆç¯æ—¶ï¼ŒæŒ‡å®šä¸€ä¸ªä» 1 å¼€å§‹å¹¶å¢åŠ åˆ°æŒ‡å®šç²¾åº¦çš„å˜é‡ <code>ring</code>ã€‚ç„¶åå°†çº¹ç†åæ ‡å€¼è®¾ç½®ä¸º <code>ring*2.0/prec</code>ï¼Œä½¿å…¶å–å€¼èŒƒå›´ä¸º 0.0ï½2.0ï¼Œå†å‰é¢æè¿°çš„ï¼Œå°†çº¹ç†çš„å¹³é“ºæ¨¡å¼è®¾ä¸º <code>GL_REPEAT</code>ã€‚è¿ç”¨è¿™ç§æ–¹æ³•çš„ç›®çš„æ˜¯é¿å…çº¹ç†å›¾åƒåœ¨æ°´å¹³æ–¹å‘ä¸Šè¿‡åº¦â€œæ‹‰ä¼¸â€ã€‚åä¹‹ï¼Œå¦‚æœç¡®å®å¸Œæœ›çº¹ç†å®Œå…¨å›´ç»•ç¯é¢æ‹‰ä¼¸ï¼Œåªéœ€ä»çº¹ç†åæ ‡è®¡ç®—ä»£ç ä¸­åˆ é™¤ <code>*2.0</code>ã€‚</li>
</ul>
</details>
<h3 id="6-2-åŠ è½½å¤–éƒ¨æ„å»ºçš„æ¨¡å‹">6.2 åŠ è½½å¤–éƒ¨æ„å»ºçš„æ¨¡å‹</h3>
<p>é€šè¿‡ä¸€äº›å»ºæ¨¡å·¥å…·ä¹Ÿå¯ä»¥æ„å»ºæ¨¡å‹ï¼Œå¦‚ï¼šMayaã€Blenderã€Cinema4Dç­‰ï¼Œè€Œä¸€èˆ¬æ¨¡å‹å¯¼å‡ºä¹Ÿæœ‰è®¸å¤šæ ¼å¼ã€‚æ­¤å¤„ä½¿ç”¨ OBJ æ ¼å¼è¿›è¡Œå¤„ç†ã€‚</p>
<p>OBJ æ–‡ä»¶ä¸­çš„è¡Œä»¥å­—ç¬¦æ ‡ç­¾å¼€å¤´ï¼Œè¡¨æ˜è¯¥è¡Œçš„æ•°æ®ç±»å‹ï¼Œå¸¸è§çš„æ ‡ç­¾å¦‚ä¸‹ï¼š</p>
<ul>
<li>vï¼šå‡ ä½•æ•°æ®ï¼ˆé¡¶ç‚¹ä½ç½®ï¼‰</li>
<li>vtï¼šçº¹ç†åæ ‡</li>
<li>vnï¼šé¡¶ç‚¹æ³•å‘é‡</li>
<li>fï¼šé¢ï¼ˆé€šå¸¸æ˜¯ä¸‰è§’å½¢ä¸­çš„é¡¶ç‚¹ï¼‰<br>
å¯èƒ½è¿˜æœ‰æ ‡ç­¾å­˜å‚¨å¯¹è±¡åç§°ã€ä½¿ç”¨çš„æè´¨ã€æ›²çº¿ã€é˜´å½±å’Œè®¸å¤šå…¶ä»–ç»†èŠ‚ã€‚</li>
</ul>
<p>ä½¿ç”¨ Blender ç»˜åˆ¶ä¸€ä¸ªå››æ£±é”¥ï¼Œå¹¶å¯¼å‡ºä¸º OBJæ–‡ä»¶ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_blender.jpg" alt="Blenderå¯¼å‡ºè®¾ç½®"></p>
<p>ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€ä¸€ä¸ª OBJ æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_Pyramidobj.jpg" alt="ç«‹æ–¹ä½“çš„OBJæ–‡ä»¶"></p>
<ul>
<li>ä»¥ <code>#</code> å¼€å¤´çš„æ˜¯ Blender æ·»åŠ çš„æ³¨é‡Šï¼Œå¯ä»¥å¿½ç•¥ã€‚</li>
<li>ä»¥ <code>o</code> å¼€å¤´çš„æ˜¯å¯¹è±¡çš„åç§°ï¼Œå¯¼å…¥æ—¶ä¹Ÿå¯ä»¥å¿½ç•¥ã€‚</li>
<li>ä»¥ <code>s</code> å¼€å¤´è¡¨æ˜ä¸åº”è¯¥å¹³æ»‘å¤„ç†ï¼Œæ­¤å¤„åŒæ ·å¿½ç•¥ã€‚</li>
<li>ä»¥ <code>v</code> å¼€å¤´çš„æ˜¯é¡¶ç‚¹ä½ç½®ï¼Œé¡¶ç‚¹ä½ç½®çš„é¡ºåºæ˜¯ <code>x y z</code>ã€‚æ­¤å¤„æœ‰8ä¸ªé¡¶ç‚¹ï¼ŒåŸç‚¹åœ¨ä¸­å¿ƒã€‚</li>
<li>ä»¥ <code>vt</code> å¼€å¤´çš„æ˜¯å„ç§çº¹ç†åæ ‡ï¼Œçº¹ç†åæ ‡åˆ—è¡¨æ¯”é¡¶ç‚¹åˆ—è¡¨é•¿çš„åŸå› æ˜¯ä¸€äº›é¡¶ç‚¹å‚ä¸äº†å¤šä¸ªä¸‰è§’å½¢çš„æ„å»ºï¼Œå¹¶ä¸”åœ¨è¿™äº›æƒ…å†µä¸‹å¯èƒ½ä½¿ç”¨ä¸åŒçš„çº¹ç†åæ ‡ã€‚</li>
<li>ä»¥ <code>vn</code> å¼€å¤´çš„æ˜¯å„ç§æ³•å‘é‡ï¼Œé€šå¸¸ä¹Ÿæ˜¯æ¯”é¡¶ç‚¹åˆ—è¡¨é•¿ï¼ŒåŸå› åŒä¸Šã€‚</li>
<li>ä»¥ <code>f</code> å¼€å¤´çš„è¡ŒæŒ‡å®šé¢ï¼ˆä¸‰è§’å½¢ï¼‰ã€‚æ¯ä¸ªé¢ï¼ˆä¸‰è§’å½¢ï¼‰å…·æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œç”± <code>/</code> åˆ†éš”ã€‚æ¯ä¸ªå…ƒç´ çš„å€¼åˆ†åˆ«æ˜¯é¡¶ç‚¹åˆ—è¡¨ã€çº¹ç†åæ ‡å’Œæ³•å‘é‡çš„ç´¢å¼•ï¼Œå¦‚ç¬¬ä¸‰ä¸ªé¢æ˜¯ï¼š<code>3/4/3 5/2/3 4/5/3</code>ï¼Œè¡¨æ˜é¡¶ç‚¹åˆ—è¡¨ç¬¬3ä¸ªã€ç¬¬5ä¸ªã€ç¬¬4ä¸ªç»„æˆä¸€ä¸ªé¢ï¼Œç›¸åº”çš„çº¹ç†åæ ‡æ˜¯ç¬¬4é¡¹ã€ç¬¬2é¡¹ã€ç¬¬5é¡¹ï¼Œæ³•å‘é‡ç›¸åŒéƒ½æ˜¯ç¬¬3é¡¹ã€‚</li>
</ul>
<p>OBJ æ ¼å¼çš„æ¨¡å‹å¹¶ä¸è¦æ±‚å…·æœ‰æ³•å‘é‡ï¼Œç”šè‡³çº¹ç†åæ ‡ã€‚</p>
<ul>
<li>å¦‚æœæ¨¡å‹æ²¡æœ‰çº¹ç†åæ ‡å’Œæ³•å‘é‡ï¼Œåˆ™é¢çš„æ•°å€¼å°†ä»…æŒ‡å®šé¡¶ç‚¹ç´¢å¼•ï¼š
<ul>
<li><code>3 5 4</code></li>
</ul>
</li>
<li>å¦‚æœæ¨¡å‹æœ‰çº¹ç†åæ ‡ï¼Œæ²¡æœ‰æ³•å‘é‡ï¼Œåˆ™æ ¼å¼ä¸ºï¼š
<ul>
<li><code>3/4 5/2 4/5</code></li>
</ul>
</li>
<li>å¦‚æœæ¨¡å‹æ²¡æœ‰çº¹ç†åæ ‡ï¼Œæœ‰æ³•å‘é‡ï¼Œåˆ™æ ¼å¼ä¸ºï¼š
<ul>
<li><code>3//3 5//3 4//3</code></li>
</ul>
</li>
</ul>
<p>åœ¨äº’è”ç½‘ä¸Šå¯ä»¥è·å¾—å„ç§èƒ½å¯¼å…¥ OBJ æ¨¡å‹çš„ç¨‹åºï¼Œä½†æ­¤å¤„æ‰‹åŠ¨ç¼–å†™ç¨‹åºè¿›è¡Œç®€å•åœ°å¯¼å…¥ OBJ æ–‡ä»¶ï¼Œå±€é™å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä»…æ”¯æŒåŒ…å« 3 ä¸ªé¢å±æ€§å­—æ®µï¼Œå³ä»¥ <code>f #/#/# #/#/# #/#/#</code> çš„å½¢å¼å­˜åœ¨ã€‚</li>
<li>æè´¨æ ‡ç­¾å°†è¢«å¿½ç•¥ã€‚</li>
<li>ä»…æ”¯æŒç”±å•ä¸ªä¸‰è§’å½¢ç½‘æ ¼ç»„æˆçš„ OBJ æ¨¡å‹ã€‚</li>
<li>å‡è®¾æ¯è¡Œä¸Šçš„å…ƒç´ éƒ½åªç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ã€‚</li>
<li>æ²¡æœ‰ä½¿ç”¨ä¸Šç´¢å¼•æœºåˆ¶ã€‚</li>
</ul>
<p>å®šä¹‰ä¸¤ä¸ªç±»ï¼ˆç½®äºåŒä¸€ä¸ªæ–‡ä»¶ï¼‰ï¼š</p>
<ul>
<li><code>ModelImporter</code> ç±»ç”¨äºä» OBJ æ–‡ä»¶ä¸­å¯¼å…¥æ¨¡å‹æ•°æ®ã€‚</li>
<li><code>ImportedModel</code> ç±»ç”¨äºä¿å­˜å¹¶æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œç±»ä¼¼äºä¸Šé¢çš„çƒä½“ç±»ã€ç¯é¢ç±»ã€‚</li>
</ul>
<p>å¯¹äºå››æ£±é”¥ï¼ŒåŠ è½½ OBJ ä¸å…ˆå‰æ‰‹åŠ¨æ„å»ºçš„æ¨¡å‹å·®ä¸å¤šã€‚é€šè¿‡ Windows è‡ªå¸¦çš„ 3D æŸ¥çœ‹å™¨ï¼Œå¯ä»¥è·å–ä¸€äº›æ¨¡å‹ï¼ˆæ ¼å¼ä¸º <code>.glb</code> ï¼Œå°†å…¶æ”¾å…¥ Blender ä¸­ï¼Œå†å¯¼å‡ºä¸º OBJ æ–‡ä»¶ï¼‰ã€‚è·å–æ¨¡å‹ååœ¨ OpenGL ç¨‹åºä¸­åŠ è½½ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_unicorn.jpg" alt="ç‹¬è§’å…½æ¨¡å‹"></p>
<p>å¯¼å…¥æ¨¡å‹åï¼Œå¯¹æ¨¡å‹çš„å¤§å°å’Œä½ç½®è¿›è¡Œä¿®æ”¹ï¼Œç§»åŠ¨é€‚åˆçš„ç›¸æœºä½ç½®å¹¶åŠ å…¥æè´¨ï¼Œæœ€åå¦‚å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_iceUnicorn.jpg" alt="å†°ç‹¬è§’å…½"></p>
<p>æ›´å¤šå¯ä»¥è‡ªå·±æ‘¸ç´¢ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint textureID;
GLuint mvLoc, projLoc;

glm::mat4 pMat, vMat, mMat, mvMat;

//Sphere sphere(48);
//Torus torus(48, 0.5f, 0.2f);
ImportedModel model(" Pyramid.obj");

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
    //std::vector&lt;int&gt; ind = model.getIndices(); ä¸ä½¿ç”¨ç´¢å¼•æ•°ç»„
    std::vector&lt;glm::vec3&gt; vert = model.getVertices();
    std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
    std::vector&lt;glm::vec3&gt; norm = model.getNormals();

    std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
    std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
    std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

    int numObjVertices = model.getNumVertices();

    for (int i = 0; i &lt; numObjVertices; ++ i)
    {
        pvalues.push_back(vert[i].x);
        pvalues.push_back(vert[i].y);
        pvalues.push_back(vert[i].z);
        tvalues.push_back(tex[i].s);
        tvalues.push_back(tex[i].t);
        nvalues.push_back(norm[i].x);
        nvalues.push_back(norm[i].y);
        nvalues.push_back(norm[i].z);
    }

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]);

    glGenBuffers(numVBO, vbo);
    // é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
    // çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
    // æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 4.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
    textureID = Util::loadTexture("ice.jpg");
    glBindTexture(GL_TEXTURE_2D, textureID);
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, 0.0f));
    mMat = glm::rotate(mMat, 30.0f * 3.14159f / 180.0f, glm::vec3(0.0f, 1.0f, 0.0f));
    mMat *= glm::scale(glm::mat4(1.0f), glm::vec3(1.0f, 1.0f, 1.0f));
    mvMat = vMat * mMat;

    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));

    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(1);

    glActiveTexture(GL_TEXTURE0);
    glBindTexture(GL_TEXTURE_2D, textureID);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
    glGenerateMipmap(GL_TEXTURE_2D);
    if (glewIsSupported("GL_EXT_texture_filter_anisotropic"))
    {
        GLfloat anisoSetting = 0.0f;
        glGetFloatv(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT, &amp;anisoSetting);
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAX_ANISOTROPY_EXT, anisoSetting);
    }

    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, model.getNumVertices());
    // åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
    // glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    // glDrawElements(GL_TRIANGLES, torus.getVertices(), GL_UNSIGNED_INT, 0);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Pyramid", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<details><summary>å¯¼å…¥æ¨¡å‹ç±»</summary>
<pre><code class="language-cpp">// ImportedModel.h
#pragma once

#include &lt;glm/glm.hpp&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;fstream&gt;
#include &lt;sstream&gt;

class ImportedModel
{
private:
    int numVertices;
    std::vector&lt;glm::vec3&gt; vertices;
    std::vector&lt;glm::vec2&gt; texCoords;
    std::vector&lt;glm::vec3&gt; normals;

public:
    ImportedModel();
    ImportedModel(const std::string &amp;filePath);
    int getNumVertices();
    std::vector&lt;glm::vec3&gt; getVertices();
    std::vector&lt;glm::vec2&gt; getTexCoords();
    std::vector&lt;glm::vec3&gt; getNormals();
};

class ModelImporter
{
private:
    // OBJ è¯»å–
    std::vector&lt;float&gt; vertVals;
    std::vector&lt;float&gt; stVals;
    std::vector&lt;float&gt; normalVals;

    // ä¿å­˜ä¸ºé¡¶ç‚¹å±æ€§ä»¥ä¾›åç»­ä½¿ç”¨çš„æ•°å€¼
    std::vector&lt;float&gt; triangleVerts;
    std::vector&lt;float&gt; texCoords;
    std::vector&lt;float&gt; normals;

public:
    ModelImporter();
    void parseOBJ(const std::string &amp;filePath);
    int getNumVertices();
    std::vector&lt;float&gt; getVertices();
    std::vector&lt;float&gt; getTexCoords();
    std::vector&lt;float&gt; getNormals();
};
</code></pre>
<pre><code class="language-cpp">// ImportedModel.cpp
#include "ImportedModel.h"

ImportedModel::ImportedModel()
{}

ImportedModel::ImportedModel(const std::string &amp;filePath)
{
    ModelImporter modelImporter = ModelImporter();
    modelImporter.parseOBJ(filePath);
    numVertices = modelImporter.getNumVertices();
    std::vector&lt;float&gt; verts = modelImporter.getVertices();
    std::vector&lt;float&gt; tcs = modelImporter.getTexCoords();
    std::vector&lt;float&gt; nms = modelImporter.getNormals();

    for (int i = 0; i &lt; numVertices; ++ i)
    {
        vertices.push_back(glm::vec3(verts[i * 3], verts[i * 3 + 1], verts[i * 3 + 2]));
        texCoords.push_back(glm::vec2(tcs[i * 2], tcs[i * 2 + 1]));
        normals.push_back(glm::vec3(nms[i * 3], nms[i * 3 + 1], nms[i * 3 + 2]));
    }
}

int ImportedModel::getNumVertices()
{
    return numVertices;
}

std::vector&lt;glm::vec3&gt; ImportedModel::getVertices()
{
    return vertices;
}

std::vector&lt;glm::vec2&gt; ImportedModel::getTexCoords()
{
    return texCoords;
}

std::vector&lt;glm::vec3&gt; ImportedModel::getNormals()
{
    return normals;
}

ModelImporter::ModelImporter()
{}

void ModelImporter::parseOBJ(const std::string &amp;filePath)
{
    float x, y, z;
    std::string content;
    std::ifstream fin(filePath, std::ios::in);
    std::string line = "";
    while (!fin.eof())
    {
        getline(fin, line);
        if (line.compare(0, 2, "v ") == 0)
        {
            std::stringstream s(line.erase(0, 1));
            s &gt;&gt; x &gt;&gt; y &gt;&gt; z;
            vertVals.push_back(x);
            vertVals.push_back(y);
            vertVals.push_back(z);
        }
        if (line.compare(0, 2, "vt") == 0)
        {
            std::stringstream s(line.erase(0, 2));
            s &gt;&gt; x &gt;&gt; y;
            stVals.push_back(x);
            stVals.push_back(y);
        }
        if (line.compare(0, 2, "vn") == 0)
        {
            std::stringstream s(line.erase(0, 2));
            s &gt;&gt; x &gt;&gt; y &gt;&gt; z;
            normalVals.push_back(x);
            normalVals.push_back(y);
            normalVals.push_back(z);
        }
        if (line.compare(0, 2, "f ") == 0)
        {
            std::string oneCorner, v, t, n;
            std::stringstream s(line.erase(0, 2));
            for (int i = 0; i &lt; 3; ++ i)
            {
                std::getline(s, oneCorner, ' ');
                std::stringstream oneCornerSS(oneCorner);
                std::getline(oneCornerSS, v, '/');
                std::getline(oneCornerSS, t, '/');
                std::getline(oneCornerSS, n, '/');

                int vertRef = (std::stoi(v) - 1) * 3;
                int tcRef = (std::stoi(t) - 1) * 2;
                int nmRef = (std::stoi(n) - 1) * 3;

                triangleVerts.push_back(vertVals[vertRef]);
                triangleVerts.push_back(vertVals[vertRef + 1]);
                triangleVerts.push_back(vertVals[vertRef + 2]);

                texCoords.push_back(stVals[tcRef]);
                texCoords.push_back(stVals[tcRef + 1]);

                normals.push_back(normalVals[nmRef]);
                normals.push_back(normalVals[nmRef + 1]);
                normals.push_back(normalVals[nmRef + 2]);
            }
        }
    }
}

int ModelImporter::getNumVertices()
{
    return triangleVerts.size() / 3;
}

std::vector&lt;float&gt; ModelImporter::getVertices()
{
    return triangleVerts;
}

std::vector&lt;float&gt; ModelImporter::getTexCoords()
{
    return texCoords;
}

std::vector&lt;float&gt; ModelImporter::getNormals()
{
    return normals;
}
</code></pre>
</details>
<h2 id="ä¸ƒ-å…‰ç…§">ä¸ƒã€å…‰ç…§</h2>
<h3 id="7-1-å…‰ç…§æ¨¡å‹">7.1 å…‰ç…§æ¨¡å‹</h3>
<p>å…‰ç…§æ¨¡å‹æœ‰æ—¶ä¹Ÿç§°ä¸ºç€è‰²æ¨¡å‹ã€‚</p>
<p>å¸¸è§çš„å…‰ç…§æ¨¡å‹ç§°ä¸º ADS æ¨¡å‹ï¼ŒåŸºäºæ ‡è®°ä¸º Aã€D å’Œ S ä¸‰ç§ç±»å‹çš„åå°„ï¼š</p>
<ul>
<li>Aï¼šç¯å¢ƒå…‰åå°„ï¼ˆambient reflectionï¼‰ï¼šæ¨¡æ‹Ÿä½çº§å…‰ç…§ï¼Œå½±å“åœºæ™¯ä¸­çš„æ‰€æœ‰ç‰©ä½“ã€‚</li>
<li>Dï¼šæ¼«åå°„ï¼ˆdiffuse reflectionï¼‰ï¼šæ ¹æ®å…‰çº¿çš„å…¥å°„è§’åº¦è°ƒæ•´ç‰©ä½“äº®åº¦ã€‚</li>
<li>Sï¼šé•œé¢åå°„ï¼ˆspecular reflectionï¼‰ï¼šå±•ç¤ºç‰©ä½“çš„å…‰æ³½ï¼Œé€šè¿‡åœ¨ç‰©ä½“è¡¨é¢ä¸Šï¼Œå…‰çº¿ç›´æ¥åœ°åå°„åˆ°æˆ‘ä»¬çš„çœ¼ç›çš„ä½ç½®ï¼Œç­–ç•¥æ€§åœ°æ”¾ç½®é€‚å½“å¤§å°çš„é«˜å…‰æ¥ä½“ç°ã€‚</li>
</ul>
<p>ä½¿ç”¨ ADS å…‰ç…§æ¨¡å‹éœ€è¦æŒ‡å®šç”¨äºåƒç´ è¾“å‡ºçš„ RGBA å€¼ä¸Šå› å…‰ç…§<br>
è€Œäº§ç”Ÿçš„åˆ†é‡ã€‚å› ç´ åŒ…æ‹¬ï¼š</p>
<ul>
<li>å…‰æºç±»å‹åŠå…¶ç¯å¢ƒå…‰åå°„ã€æ¼«åå°„å’Œé•œé¢åå°„ç‰¹æ€§ï¼›</li>
<li>å¯¹è±¡æè´¨çš„ç¯å¢ƒå…‰åå°„ã€æ¼«åå°„å’Œé•œé¢åå°„ç‰¹å¾ï¼›</li>
<li>å¯¹è±¡æè´¨çš„â€œå…‰æ³½åº¦â€ï¼›</li>
<li>å…‰çº¿ç…§å°„ç‰©ä½“çš„è§’åº¦ï¼›</li>
<li>ä»ä¸­æŸ¥çœ‹åœºæ™¯çš„è§’åº¦ã€‚</li>
</ul>
<h3 id="7-2-å…‰æº">7.2 å…‰æº</h3>
<p>å¸¸è§çš„å…‰æºç±»å‹æœ‰ï¼š</p>
<ul>
<li>å…¨å±€å…‰ï¼šé€šå¸¸ç§°ä¸ºå…¨å±€ç¯å¢ƒå…‰ï¼Œä»…åŒ…å«ç¯å¢ƒå…‰ç»„ä»¶</li>
<li>å®šå‘å…‰ï¼šè¿œè·ç¦»å…‰</li>
<li>ä½ç½®å…‰ï¼šç‚¹å…‰æº</li>
<li>èšå…‰ç¯</li>
</ul>
<p>å…¨å±€ç¯å¢ƒå…‰ç”¨äºæ˜¾ç¤ºå¯¹è±¡çš„æ¯ä¸ªåƒç´ éƒ½æœ‰ç›¸åŒçš„å…‰ç…§ã€‚</p>
<ul>
<li>å…¨å±€ç¯å¢ƒå…‰æ¨¡æ‹Ÿäº†ç°å®ä¸–ç•Œå…‰çº¿ç»è¿‡å¤šæ¬¡åå°„ï¼Œ<strong>æ— æ³•ç¡®å®šå…‰æºå’Œæ–¹å‘</strong>ã€‚</li>
<li>ä»…æœ‰ç¯å¢ƒå…‰åå°„åˆ†é‡ï¼Œæ²¡æœ‰æ¼«åå°„æˆ–é•œé¢åå°„åˆ†é‡ã€‚</li>
<li>é€šå¸¸è¢«å»ºæ¨¡ä¸ºåæš—çš„ç™½å…‰ã€‚</li>
<li>ç”¨ RGBA å€¼è®¾å®šï¼š<code>float globalAmbient[4] = {0.6f, 0.6f, 0.6f, 1.0f};</code>
<ul>
<li>RGBA å€¼çš„èŒƒå›´æ˜¯ 0.0 åˆ° 1.0ã€‚A è®¾ç½®ä¸º1ã€‚</li>
</ul>
</li>
</ul>
<p>å®šå‘å…‰æˆ–è¿œè·ç¦»å…‰</p>
<ul>
<li><strong>æ²¡æœ‰æºä½ç½®ä½†å…·æœ‰æ–¹å‘</strong>ã€‚ç”¨äºæ¨¡æ‹Ÿå…‰æºè·ç¦»éå¸¸è¿œï¼Œå…‰çº¿æ¥è¿‘å¹³è¡Œçš„æƒ…å†µã€‚</li>
<li>å®šå‘å…‰å¯¹ç‰©ä½“çš„å½±å“å–å†³äºå…‰ç…§è§’åº¦ï¼Œç‰©ä½“æœå‘å®šå‘å…‰çš„ä¸€ä¾§æ¯”å¯¹ä¾§æ›´äº®ã€‚</li>
<li>å»ºæ¨¡å®šå‘å…‰éœ€è¦æŒ‡å®šå…¶æ–¹å‘ï¼ˆå‘é‡ï¼‰åŠå…¶ç¯å¢ƒã€æ¼«åå°„å’Œé•œé¢ç‰¹å¾ã€‚</li>
<li>ç”¨ RGBA è®¾å®šï¼Œå¦‚æŒ‡å‘ z è½´è´Ÿæ–¹å‘çš„çº¢è‰²å®šå‘å…‰ä»£ç ï¼š</li>
</ul>
<pre><code class="language-cpp">float dirLightAmbient[4] = {0.1f, 0.0f, 0.0f, 1.0f};
float dirLightDiffuse[4] = {1.0f, 0.0f, 0.0f, 1.0f};
float dirLightSpecular[4] = {1.0f, 0.0f, 0.0f, 1.0f};
float dirLightDirection[3] = {0.0f, 0.0f, -1.0f};
</code></pre>
<p>ä½ç½®å…‰åœ¨ 3D åœºæ™¯ä¸­å…·æœ‰ç‰¹å®šä½ç½®ï¼Œç”¨ä»¥ä½“ç°é è¿‘åœºæ™¯çš„å…‰æºã€‚</p>
<ul>
<li><strong>ä½ç½®å…‰æ²¡æœ‰æ–¹å‘</strong>ï¼Œå› ä¸ºå®ƒå¯¹åœºæ™¯ä¸­æ¯ä¸ªé¡¶ç‚¹çš„å…‰ç…§æ–¹å‘éƒ½ä¸åŒã€‚</li>
<li>ä½ç½®å…‰è¿˜å¯ä»¥åŒ…å«è¡°å‡å› å­ï¼Œç”¨äºæ¨¡æ‹Ÿå®ƒä»¬çš„å¼ºåº¦éšç€è·ç¦»å‡å°çš„ç¨‹åº¦ã€‚</li>
<li>ç”¨ RGBA è®¾å®šï¼Œå¦‚ä½ç½®(5,2,-3)å¤„çš„çº¢è‰²ä½ç½®å…‰å¯ä»¥æŒ‡å®šä¸ºï¼š</li>
</ul>
<pre><code class="language-cpp">float posLightAmbient[4] = {0.1f, 0.0f, 0.0f, 1.0f};
float posLightDiffuse[4] = {1.0f, 0.0f, 0.0f, 1.0f};
float posLightSpecular[4] = {1.0f, 0.0f, 0.0f, 1.0f};
float posLightPosition[3] = {5.0f, 2.0f, -3.0f};
</code></pre>
<ul>
<li>è¡°å‡å› å­æœ‰è®¸å¤šå»ºæ¨¡æ–¹å¼ï¼Œå…¶ä¸­ä¸€ç§æ˜¯ä½¿ç”¨æ’å®šè¡°å‡ã€çº¿æ€§è¡°å‡å’ŒäºŒæ¬¡æ–¹è¡°å‡ï¼Œå¼•å…¥3ä¸ªéè´Ÿå¯è°ƒå‚æ•°ï¼Œä¸ç¦»å…‰æºçš„è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> ç»“åˆè¿›è¡Œè®¡ç®—ï¼š</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>u</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>k</mi><mi>c</mi></msub><mo>+</mo><msub><mi>k</mi><mi>l</mi></msub><mi>d</mi><mo>+</mo><msub><mi>k</mi><mi>q</mi></msub><msup><mi>d</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">attenuationFactor = \frac{1}{k_c + k_l d + k_q d^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">u</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.293548em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">k_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼šåº”æ°¸è¿œå¤§äºç­‰äº1ï¼›</p>
</li>
<li>
<p>å¦å¤–ä¸¤ä¸ªå‚æ•°è‡³å°‘æœ‰ä¸€ä¸ªå¤§äºé›¶ï¼›</p>
</li>
<li>
<p>ä½¿å¾—å› å­å–å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œå¹¶å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> å¢å¤§æ—¶æ¥è¿‘0ã€‚</p>
</li>
<li>
<p>å°†å› å­ä¸å…‰çš„å¼ºåº¦ç›¸ä¹˜å³å¯ã€‚</p>
</li>
</ul>
<p>èšå…‰ç¯</p>
<ul>
<li><strong>åŒæ—¶å…·æœ‰ä½ç½®å’Œæ–¹å‘</strong>ã€‚</li>
<li>èšå…‰ç¯å‚æ•°å¦‚ä¸‹å›¾</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_spotlightargs.jpg" alt="èšå…‰ç¯å‚æ•°ï¼Œå›¾æºè®¡ç®—æœºå›¾å½¢å­¦ç¼–ç¨‹ï¼ˆç¬¬äºŒç‰ˆï¼‰"></p>
<ul>
<li>å…·æœ‰è¡°å‡æŒ‡æ•°æ¨¡æ‹Ÿéšå…‰æŸè§’åº¦çš„å¼ºåº¦å˜åŒ–ï¼Œå…·æœ‰è¡°å‡å› å­æ¨¡æ‹Ÿå…‰æŸè·ç¦»è¡°å‡ã€‚
<ul>
<li>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> å°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span> æ—¶ï¼Œè®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> çš„ä½™å¼¦çš„è¡°å‡æŒ‡æ•°æ¬¡å¹‚æ¥è®¡ç®—å¼ºåº¦å› å­ã€‚</li>
<li>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span> æ—¶ï¼Œå¼ºåº¦å› å­ä¸º0ã€‚</li>
<li>å¼ºåº¦å› å­å–å€¼èŒƒå›´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œå°†å¼ºåº¦å› å­ä¹˜å…‰çš„å¼ºåº¦å³å¯æ¨¡æ‹Ÿé”¥å½¢æ•ˆæœã€‚</li>
</ul>
</li>
<li>ç”¨ RGBA è®¾å®šï¼Œå¦‚ä½ç½®(5,2,-3)å¤„å‘ä¸‹ç…§å°„ z è½´è´Ÿæ–¹å‘çš„çº¢è‰²èšå…‰ç¯å¯ä»¥è¡¨ç¤ºä¸ºï¼š</li>
</ul>
<pre><code class="language-cpp">float spotLightAmbient[4] = {0.1f, 0.0f, 0.0f, 1.0f};
float spotLightDiffuse[4] = {1.0f, 0.0f, 0.0f, 1.0f};
float spotLightSpecular[4] = {1.0f, 0.0f, 0.0f, 1.0f};
float spotLightPosition[3] = {5.0f, 2.0f, -3.0f};
float spotLightDirection[3] = {0.0f, 0.0f, -1.0f};
float spotLightCutoff = 20.0f;
float spotLightExponent = 10.0f;
</code></pre>
<p><em>å½“è®¾è®¡æ‹¥æœ‰è®¸å¤šå…‰æºçš„ç³»ç»Ÿæ—¶ï¼Œç¨‹åºå‘˜åº”è¯¥è€ƒè™‘åˆ›å»ºç›¸åº”çš„ç±»ç»“æ„ï¼Œå¦‚å®šä¹‰ Light ç±»åŠå…¶å­ç±» GlobalAmbientã€Directionalã€Positionalã€Spotlight</em></p>
<h3 id="7-3-æè´¨">7.3 æè´¨</h3>
<p>åœºæ™¯ä¸­ç»™ç‰©ä½“çš„å¤–è§‚æ·»åŠ å…‰ç…§ï¼Œäº§ç”Ÿåå°„ç‰¹æ€§ã€‚å³å¯¹è±¡ä¸ ADS å…‰ç…§æ¨¡å‹ç›¸äº’ä½œç”¨ã€‚</p>
<p>é€šè¿‡æŒ‡å®š4ä¸ªå€¼ï¼Œåœ¨ ADS å…‰ç…§æ¨¡å‹ä¸­æ¨¡æ‹Ÿæè´¨ï¼š</p>
<ul>
<li>ç¯å¢ƒå…‰åå°„</li>
<li>æ¼«åå°„</li>
<li>é•œé¢åå°„</li>
<li>å…‰æ³½</li>
</ul>
<p>å¦‚é”¡é“åˆé‡‘çš„æ•ˆæœï¼ŒæŒ‡å®šï¼š</p>
<pre><code class="language-cpp">float pewterMatAmbient[4] = {0.11f, 0.06f, 0.11f, 1.0f};
float pewterMatDiffuse[4] = {0.43f, 0.47f, 0.54f, 1.0f};
float pewterMatSpecular[4] = {0.33f, 0.33f, 0.52f, 1.0f};
</code></pre>
<p>æ²¡æœ‰çº¹ç†çš„ç‰©ä½“åœ¨æ¸²æŸ“æ—¶ï¼Œå¯ä»¥æŒ‡å®šæè´¨ç‰¹æ€§ã€‚æ­¤å¤„é¢„å®šä¹‰ä¸€äº›å¯é€‰æ‹©çš„æè´¨ï¼ˆç½®äºUtilç±»ä¸­ï¼‰ï¼š</p>
<details><summary>é»„é‡‘ã€ç™½é“¶ã€é’é“œæè´¨ä»£ç </summary>
<pre><code class="language-cpp">// é»„é‡‘æè´¨çš„ç¯å¢ƒå…‰
float *Util::goldAmbient()
{
    static float ambient[4] = { 0.2473f, 0.1995f, 0.0745f, 1.0f };
    return ambient;
}

// é»„é‡‘æè´¨çš„æ¼«åå°„
float *Util::goldDiffuse()
{
    static float diffuse[4] = { 0.7516f, 0.6065f, 0.2265f, 1.0f };
    return diffuse;
}

// é»„é‡‘æè´¨çš„é•œé¢åå°„
float *Util::goldSpecular()
{
    static float specular[4] = { 0.6283f, 0.5559f, 0.3661f, 1.0f };
    return specular;
}

// é»„é‡‘æè´¨çš„å…‰æ³½åº¦
float Util::goldShininess()
{
    return 51.2f;
}

// ç™½é“¶æè´¨çš„ç¯å¢ƒå…‰
float *Util::silverAmbient()
{
    static float ambient[4] = { 0.1923f, 0.1923f, 0.1923f, 1.0f };
    return ambient;
}

// ç™½é“¶æè´¨çš„æ¼«åå°„
float *Util::silverDiffuse()
{
    static float diffuse[4] = { 0.5075f, 0.5075f, 0.5075f, 1.0f };
    return diffuse;
}

// ç™½é“¶æè´¨çš„é•œé¢åå°„
float *Util::silverSpecular()
{
    static float specular[4] = { 0.5083f, 0.5083f, 0.5083f, 1.0f };
    return specular;
}

// ç™½é“¶æè´¨çš„å…‰æ³½åº¦
float Util::silverShininess()
{
    return 51.2f;
}

// é’é“œæè´¨çš„ç¯å¢ƒå…‰
float *Util::bronzeAmbient()
{
    static float ambient[4] = { 0.2125f, 0.1275f, 0.054f, 1.0f };
    return ambient;
}

// é’é“œæè´¨çš„æ¼«åå°„
float *Util::bronzeDiffuse()
{
    static float diffuse[4] = { 0.714f, 0.4284f, 0.18144f, 1.0f };
    return diffuse;
}

// é’é“œæè´¨çš„é•œé¢åå°„
float *Util::bronzeSpecular()
{
    static float specular[4] = { 0.393548f, 0.271906f, 0.166721f, 1.0f };
    return specular;
}

// é’é“œæè´¨çš„å…‰æ³½åº¦
float Util::bronzeShininess()
{
    return 25.6f;
}
</code></pre>
</details>
<p><strong>è¿™äº›ä»£ç ä»…ä»…æä¾›äº†ç”¨äºæè¿°å¹¶å­˜å‚¨åœºæ™¯ä¸­å…ƒç´ æ‰€éœ€å…‰ç…§å’Œæè´¨ç‰¹æ€§çš„ä¸€ç§æ–¹å¼ï¼Œä»ç„¶éœ€è¦è‡ªå·±è®¡ç®—å…‰ç…§ã€‚</strong></p>
<h3 id="7-4-adså…‰ç…§è®¡ç®—">7.4 ADSå…‰ç…§è®¡ç®—</h3>
<p>å½“ç»˜åˆ¶åœºæ™¯æ—¶ï¼Œæ¯ä¸ªé¡¶ç‚¹åæ ‡éƒ½ä¼šè¿›è¡Œå˜æ¢ä»¥å°† 3D ä¸–ç•Œæ¨¡æ‹Ÿåˆ° 2D å±å¹•ä¸Šã€‚æ¯ä¸ªåƒç´ çš„é¢œè‰²éƒ½æ˜¯æ …æ ¼åŒ–ã€çº¹ç†è´´å›¾ä»¥åŠæ’å€¼çš„ç»“æœã€‚</p>
<p>ç°åœ¨éœ€è¦åŠ å…¥ä¸€ä¸ªæ–°çš„æ­¥éª¤æ¥è°ƒæ•´è¿™äº›æ …æ ¼åŒ–ä¹‹åçš„åƒç´ é¢œè‰²ï¼Œä»¥ä¾¿ååº”åœºæ™¯ä¸­çš„å…‰ç…§å’Œæè´¨ã€‚</p>
<p>é¦–å…ˆç¡®å®šæ¯ä¸ªåƒç´ çš„åå°„å¼ºåº¦ Iï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><msub><mi>I</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>I</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><msub><mi>I</mi><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{observed} = I_{ambient} + I_{diffuse} + I_{specular}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ç¯å¢ƒå…‰å€¼ä¸ºåœºæ™¯ç¯å¢ƒå…‰ä¸æè´¨ç¯å¢ƒå…‰åˆ†é‡çš„ä¹˜ç§¯ï¼ˆRGBåˆ†åˆ«ä¹˜ç§¯ï¼‰ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msub><mi>t</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mtext>&nbsp;</mtext><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>I</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mo>=</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msubsup><mi>t</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msubsup><mi>l</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>I</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msubsup><mo>=</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msubsup><mi>t</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msubsup><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msubsup><mi>l</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>I</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>b</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow></msubsup><mo>=</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msubsup><mi>t</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>b</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow></msubsup><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msubsup><mi>l</mi><mrow><mi>a</mi><mi>m</mi><mi>b</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>b</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow></msubsup></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">I_{ambient}=Light_{ambient}\ Material_{ambient}=
\begin{cases}
I_{ambient}^{red}=Light_{ambient}^{red}Material_{ambient}^{red}\\
I_{ambient}^{green}=Light_{ambient}^{green}Material_{ambient}^{green}\\
I_{ambient}^{blue}=Light_{ambient}^{blue}Material_{ambient}^{blue}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.3986920000000005em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013079999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.3986920000000005em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013079999999999em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em;"><span style="top:-2.3986920000000005em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013079999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>å…¶ä¸­æ¼«åå°„åˆ†é‡åŸºäºå…‰å¯¹äºå¹³é¢çš„å…¥å°„è§’ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span>ã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_angleOfIncidence.png" alt="å…¥å°„è§’"></p>
<p>å…¶ä¸­ç¡®å®šå…¥å°„è§’ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span> éœ€è¦ï¼š</p>
<ol>
<li>æ±‚ä»ç»˜åˆ¶å‘é‡åˆ°å…‰æºçš„å‘é‡ï¼ˆæˆ–ä¸å…‰ç…§æ–¹å‘ç›¸åçš„å‘é‡ï¼‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span></li>
<li>æ¸²æŸ“ç‰©ä½“è¡¨æ˜çš„æ³•å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></li>
</ol>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ç”±</mtext><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>I</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>cos</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msub><mi>t</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>N</mi><mo>â‹…</mo><mi>L</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>N</mi><mi mathvariant="normal">âˆ¥</mi><mi>L</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mfrac><mi>Ï€</mi><mn>2</mn></mfrac><mo>â‰¤</mo><mi>Î¸</mi><mo>â‰¤</mo><mfrac><mi>Ï€</mi><mn>2</mn></mfrac></mrow></mstyle></mtd></mtr></mtable></mrow><mspace linebreak="newline"></mspace><mtext>å¾—</mtext><msub><mi>I</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msub><mi>t</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub><mtext>&nbsp;</mtext><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi></mrow></msub><mtext>&nbsp;</mtext><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mo>â‹…</mo><mi>L</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>N</mi><mi mathvariant="normal">âˆ¥</mi><mi>L</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>åŒæ ·åˆ†åˆ«è¿›è¡Œ</mtext><mi>R</mi><mi>G</mi><mi>B</mi><mtext>è¿ç®—</mtext></mrow><annotation encoding="application/x-tex">ç”±\begin{cases}
I_{diffuse}=\cos(\theta)Light_{diffuse}Material_{diffuse}\\
\cos(\theta)=\frac{N\cdot L}{\vert N\|L\vert}\\
-\frac{\pi}{2}\leq\theta\leq\frac{\pi}{2}
\end{cases}\\
å¾—I_{diffuse}=Light_{diffuse}\ Material_{diffuse}\ \max(\frac{N\cdot L}{\vert N\|L\vert},0)\\
åŒæ ·åˆ†åˆ«è¿›è¡ŒRGBè¿ç®—
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.4079999999999995em;vertical-align:-1.9539999999999997em;"></span><span class="mord cjk_fallback">ç”±</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.454em;"><span style="top:-4.454000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0140000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mtight">âˆ¥</span><span class="mord mathdefault mtight">L</span><span class="mord mtight">âˆ£</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">â‹…</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.4860000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ï€</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ï€</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9539999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord cjk_fallback">å¾—</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">&nbsp;</span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord">âˆ¥</span><span class="mord mathdefault">L</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">åŒ</span><span class="mord cjk_fallback">æ ·</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">åˆ«</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">è¿</span><span class="mord cjk_fallback">ç®—</span></span></span></span></span></p>
<p>å…¶ä¸­é•œé¢åå°„åˆ†é‡é™¤äº†ä¸å…¥å°„è§’ç›¸å…³ï¼Œä¹Ÿä¸å…‰åœ¨è¡¨é¢ä¸Šçš„åå°„è§’ä»¥åŠè§‚å¯Ÿç‚¹ä¸åå…‰è¡¨é¢ä¹‹é—´çš„å¤¹è§’ç›¸å…³ã€‚ä¸‹å›¾ R è¡¨ç¤ºå…‰åå°„ï¼ŒV è¡¨ç¤ºè§‚å¯Ÿå‘é‡ï¼ˆåƒç´ åˆ°çœ¼ç›ï¼‰ã€‚</p>
<ul>
<li>V æ˜¯ä»çœ¼ç›åˆ°åƒç´ çš„å–åã€‚</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> è¶Šå°ï¼Œé•œé¢åå°„åˆ†é‡è¶Šå¤§ã€‚
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> ç”¨äºè®¡ç®—é•œé¢åå°„åˆ†é‡çš„æ–¹å¼å–å†³äºç‰©ä½“çš„å…‰æ³½åº¦ã€‚å…‰æ³½åº¦è¶Šå¤§è¶Šé—ªäº®ï¼Œåˆ™å…¥å°„å…‰æ›´å¤šåå°„ç»™çœ¼ç›ï¼›å…‰æ³½åº¦è¾ƒå°ï¼Œä¸é‚£ä¹ˆé—ªäº®ï¼Œåˆ™é•œé¢é«˜å…‰ä¼šæ•£å¼€ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_observationPointIncidence.png" alt="è§‚å¯Ÿç‚¹å…¥å°„è§’"></p>
<p>åå…‰åº¦å¯ä»¥ç”¨è¡°å‡å‡½æ•°å»ºæ¨¡ï¼Œè¡°å‡å‡½æ•°è¡¨ç¤ºè§’åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> å¢å¤§æ—¶é•œé¢åå°„åˆ†é‡è¡°å‡åˆ°0çš„é€Ÿåº¦ã€‚</p>
<ul>
<li>ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mo><mi>cos</mi><mo>â¡</mo></mo><mi>n</mi></msup><mo stretchy="false">(</mo><mi>Ï†</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\cos^n(\varphi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">Ï†</span><span class="mclose">)</span></span></span></span> è¿›è¡Œè¡°å‡ï¼ŒæŒ‡æ•°è¶Šå¤§ï¼Œè¡°å‡é€Ÿåº¦è¶Šå¿«ã€‚
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> åˆå«ä½œæè´¨çš„åå…‰åº¦å› å­ã€‚</li>
<li>åå…‰åº¦å› å­ä»¥å…‰æ³½åº¦å½¢å¼ç»™å‡ºã€‚</li>
</ul>
</li>
</ul>
<p>é•œé¢åå°„è®¡ç®—å¦‚ä¸‹ï¼ˆå®é™…è¿ç®—ä½¿ç”¨RGBè¿ç®—ï¼‰ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi></mrow></msub><mo>=</mo><mi>L</mi><mi>i</mi><mi>g</mi><mi>h</mi><msub><mi>t</mi><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi></mrow></msub><mtext>&nbsp;</mtext><mi>M</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi></mrow></msub><mtext>&nbsp;</mtext><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>R</mi><mo>â‹…</mo><mi>V</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>R</mi><mi mathvariant="normal">âˆ¥</mi><mi>V</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">I_{specular}=Light_{specular}\ Material_{specular}\ \max((\frac{R\cdot V}{\vert R\|V\vert})^n,0)\\
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">&nbsp;</span><span class="mop">max</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord">âˆ¥</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></p>
<h3 id="7-5-å®ç°adså…‰ç…§">7.5 å®ç°ADSå…‰ç…§</h3>
<p>å¹³æ»‘ç€è‰²æ–¹æ³•ï¼š</p>
<ul>
<li>Gouraud ç€è‰²</li>
<li>Phong ç€è‰²</li>
</ul>
<h4 id="7-5-1-gouraud-ç€è‰²">7.5.1 Gouraud ç€è‰²</h4>
<p>è¿™æ–¹æ³•åˆç§°ä¸ºåŒçº¿æ€§å…‰å¼ºæ’å€¼æ³•</p>
<p>ä½¿ç”¨ 3D å›¾å½¢ç®¡çº¿ä¸­çš„è‡ªåŠ¨æ’å€¼æ¸²æŸ“ï¼Œé€‚ç”¨äºç°ä»£æ˜¾å¡ã€‚è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç¡®å®šæ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ï¼Œå¹¶è¿›è¡Œå…‰ç…§ç›¸å…³è®¡ç®—ã€‚</li>
<li>å…è®¸æ­£å¸¸çš„æ …æ ¼åŒ–è¿‡ç¨‹åœ¨æ’å…¥åƒç´ æ—¶å¯¹é¢œè‰²ä¹Ÿè¿›è¡Œæ’å€¼ï¼ˆåŒæ—¶ä¹Ÿå¯¹å…‰ç…§è¿›è¡Œæ’å€¼ï¼‰ã€‚</li>
</ol>
<p>OpenGL ä¸­ï¼Œå¤§å¤šæ•°å…‰ç…§è®¡ç®—éƒ½æ˜¯é¡¶ç‚¹ç€è‰²å™¨ä¸­å®Œæˆï¼Œç‰‡æ®µç€è‰²å™¨ä»…ä¼ é€’å¹¶å±•ç¤ºè‡ªåŠ¨æ’å€¼çš„å…‰ç…§åçš„é¢œè‰²ã€‚</p>
<ul>
<li>é¡¶ç‚¹ç€è‰²å™¨
<ol>
<li>æ ¹æ®é¡¶ç‚¹è®¡ç®— Nã€Lã€V å’Œ R å‘é‡</li>
<li>è®¡ç®— Aã€Dã€Såˆ†é‡</li>
<li>è¾“å‡ºå±æ€§ã€å…‰ç…§åçš„é¢œè‰²ã€<code>gl_position</code></li>
</ol>
</li>
<li>ç‰‡æ®µç€è‰²å™¨
<ol>
<li>ä¼ å…¥æ’å€¼ï¼šé¢œè‰²ã€ä½ç½®</li>
</ol>
</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_goldtorus.jpg" alt="é€šè¿‡ Gouraud ç€è‰²çš„é»„é‡‘æè´¨ç¯é¢"></p>
<p>ç¨‹åºä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>Utilç±»</summary>
<pre><code class="language-cpp">// Util.h
#pragma once

#include &lt;GL/glew.h&gt;
#include &lt;GLFW/glfw3.h&gt;
#include &lt;SOIL2/soil2.h&gt;
#include &lt;glm/glm.hpp&gt;
#include &lt;glm/gtc/type_ptr.hpp&gt;
#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;cmath&gt;
#include &lt;vector&gt;

class Util
{
public:
    static std::string readShaderSource(const std::string &amp;path);
    static void printShaderLog(GLuint shader);
    static void printProgramLog(GLuint program);
    static bool checkOpenGLerror();

    static GLuint createShadeProgram(const std::string vpath, const std::string fpath);
    static GLuint loadTexture(const std::string &amp;imgPath);

    static float *goldAmbient();
    static float *goldDiffuse();
    static float *goldSpecular();
    static float goldShininess();

    static float *silverAmbient();
    static float *silverDiffuse();
    static float *silverSpecular();
    static float silverShininess();

    static float *bronzeAmbient();
    static float *bronzeDiffuse();
    static float *bronzeSpecular();
    static float bronzeShininess();
};
</code></pre>
<pre><code class="language-cpp">// Util.cpp
#include "Util.h"

/*
* ä»æ–‡ä»¶ä¸­è¯»å– GLSL ä»£ç 
* @param path æ–‡ä»¶è·¯å¾„
*/
std::string Util::readShaderSource(const std::string &amp;path)
{
    std::string content = "";
    std::ifstream fileStream(path, std::ios::in);
    std::string line = "";
    while (!fileStream.eof())
    {
        getline(fileStream, line);
        content.append(line + "\n");
    }
    fileStream.close();
    return content;
}

/*
* å½“ GLSL ä»£ç ç¼–è¯‘å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param shader ç€è‰²å™¨æ ‡è¯†
*/
void Util::printShaderLog(GLuint shader)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetShaderInfoLog(shader, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Shader Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* å½“ GLSL é“¾æ¥å¤±è´¥æ—¶ï¼Œæ˜¾ç¤º OpenGL æ—¥å¿—å†…å®¹
* @param program ç€è‰²å™¨ç¨‹åºæ ‡è¯†
*/
void Util::printProgramLog(GLuint program)
{
    int len = 0;
    int chWrittn = 0;
    char *log;
    glGetProgramiv(program, GL_INFO_LOG_LENGTH, &amp;len);
    if (len &gt; 0)
    {
        log = new char[len];
        glGetProgramInfoLog(program, len, &amp;chWrittn, log);
        std::cout &lt;&lt; "Program Info: " &lt;&lt; log &lt;&lt; "\n";
        delete[] log;
    }
}

/*
* æ£€æŸ¥ OpenGL é”™è¯¯æ ‡å¿—ï¼Œå³æ˜¯å¦å‘ç”Ÿ OpenGL é”™è¯¯
*/
bool Util::checkOpenGLerror()
{
    bool err = false;
    int glErr = glGetError();
    while (glErr != GL_NO_ERROR)
    {
        std::cout &lt;&lt; "glError: " &lt;&lt; glErr &lt;&lt; "\n";
        err = true;
        glErr = glGetError();
    }
    return err;
}

/*
* åˆ›å»ºç€è‰²å™¨ç¨‹åº
* @param vpath é¡¶ç‚¹ç€è‰²å™¨è·¯å¾„
* @param fpath ç‰‡æ®µç€è‰²å™¨è·¯å¾„
*/
GLuint Util::createShadeProgram(const std::string vpath, const std::string fpath)
{
    // è®°å½•é”™è¯¯ä¿¡æ¯
    GLint vertCompiled, fragCompiled, linked;

    // é¡¶ç‚¹ç€è‰²å™¨
    std::string vs = readShaderSource(vpath);
    // ç‰‡æ®µç€è‰²å™¨
    std::string fs = readShaderSource(fpath);
    const char *vshaderSource = vs.c_str();
    const char *fshaderSource = fs.c_str();

    // åˆ†åˆ«å­˜å…¥ vShader å’Œ fShader å˜é‡
    GLuint vShader = glCreateShader(GL_VERTEX_SHADER);
    GLuint fShader = glCreateShader(GL_FRAGMENT_SHADER);

    // å°† GLSL ä»£ç ä»å­—ç¬¦ä¸²è½½å…¥ç©ºç€è‰²å™¨å¯¹è±¡ä¸­
    glShaderSource(vShader, 1, &amp;vshaderSource, NULL);
    glShaderSource(fShader, 1, &amp;fshaderSource, NULL);

    // ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨
    glCompileShader(vShader);
    checkOpenGLerror();
    glGetShaderiv(vShader, GL_COMPILE_STATUS, &amp;vertCompiled);
    if (vertCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "vertex compilation failed\n";
        printShaderLog(vShader);
    }
    // ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨
    glCompileShader(fShader);
    checkOpenGLerror();
    glGetShaderiv(fShader, GL_COMPILE_STATUS, &amp;fragCompiled);
    if (fragCompiled == GL_FALSE)
    {
        std::cout &lt;&lt; "fragment compilation failed\n";
        printShaderLog(fShader);
    }

    GLuint vProgram = glCreateProgram();
    glAttachShader(vProgram, vShader);
    glAttachShader(vProgram, fShader);
    glLinkProgram(vProgram);
    checkOpenGLerror();
    glGetProgramiv(vProgram, GL_LINK_STATUS, &amp;linked);
    if (linked == GL_FALSE)
    {
        std::cout &lt;&lt; "linking failed\n";
        printProgramLog(vProgram);
    }

    return vProgram; // è¿”å›ç€è‰²å™¨ç¨‹åºID
}

/*
* ä»æ–‡ä»¶ä¸­è¯»å–çº¹ç†å›¾åƒå¹¶è¿”å›çº¹ç† ID
* @param imgPath å›¾åƒæ–‡ä»¶è·¯å¾„
*/
GLuint Util::loadTexture(const std::string &amp;imgPath)
{
    GLuint textureID;
    textureID = SOIL_load_OGL_texture(imgPath.c_str(), SOIL_LOAD_AUTO, SOIL_CREATE_NEW_ID, SOIL_FLAG_INVERT_Y);
    if (textureID == 0)
        std::cout &lt;&lt; "Failed to load texture: " &lt;&lt; imgPath &lt;&lt; "\n";
    return textureID;
}

// é»„é‡‘æè´¨çš„ç¯å¢ƒå…‰
float *Util::goldAmbient()
{
    static float ambient[4] = { 0.2473f, 0.1995f, 0.0745f, 1.0f };
    return ambient;
}

// é»„é‡‘æè´¨çš„æ¼«åå°„
float *Util::goldDiffuse()
{
    static float diffuse[4] = { 0.7516f, 0.6065f, 0.2265f, 1.0f };
    return diffuse;
}

// é»„é‡‘æè´¨çš„é•œé¢åå°„
float *Util::goldSpecular()
{
    static float specular[4] = { 0.6283f, 0.5559f, 0.3661f, 1.0f };
    return specular;
}

// é»„é‡‘æè´¨çš„å…‰æ³½åº¦
float Util::goldShininess()
{
    return 51.2f;
}

// ç™½é“¶æè´¨çš„ç¯å¢ƒå…‰
float *Util::silverAmbient()
{
    static float ambient[4] = { 0.1923f, 0.1923f, 0.1923f, 1.0f };
    return ambient;
}

// ç™½é“¶æè´¨çš„æ¼«åå°„
float *Util::silverDiffuse()
{
    static float diffuse[4] = { 0.5075f, 0.5075f, 0.5075f, 1.0f };
    return diffuse;
}

// ç™½é“¶æè´¨çš„é•œé¢åå°„
float *Util::silverSpecular()
{
    static float specular[4] = { 0.5083f, 0.5083f, 0.5083f, 1.0f };
    return specular;
}

// ç™½é“¶æè´¨çš„å…‰æ³½åº¦
float Util::silverShininess()
{
    return 51.2f;
}

// é’é“œæè´¨çš„ç¯å¢ƒå…‰
float *Util::bronzeAmbient()
{
    static float ambient[4] = { 0.2125f, 0.1275f, 0.054f, 1.0f };
    return ambient;
}

// é’é“œæè´¨çš„æ¼«åå°„
float *Util::bronzeDiffuse()
{
    static float diffuse[4] = { 0.714f, 0.4284f, 0.18144f, 1.0f };
    return diffuse;
}

// é’é“œæè´¨çš„é•œé¢åå°„
float *Util::bronzeSpecular()
{
    static float specular[4] = { 0.393548f, 0.271906f, 0.166721f, 1.0f };
    return specular;
}

// é’é“œæè´¨çš„å…‰æ³½åº¦
float Util::bronzeShininess()
{
    return 25.6f;
}
</code></pre>
</details>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint mvLoc, projLoc, nLoc;

// å…‰æºå±æ€§
GLuint globalAmbLoc, ambLoc, diffLoc, specLoc, posLoc;
// æè´¨å±æ€§
GLuint mAmbLoc, mDifLoc, mSpecLoc, mShiLoc;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;
glm::vec3 currentLightPos, lightPosV;    // æ¨¡å‹å’Œè§†è§‰ç©ºé—´ä¸­çš„å…‰ç…§ä½ç½®
float lightPos[3];    // å…‰ç…§ä½ç½®çš„æµ®ç‚¹æ•°ç»„

// åˆå§‹åŒ–å…‰ç…§ä½ç½®
glm::vec3 initialLightLoc = glm::vec3(5.0f, 2.0f, 2.0f);

// ç™½å…‰ç‰¹æ€§
float globalAmbient[4] = { 0.7f, 0.7f, 0.7f, 1.0f };
float lightAmbient[4] = { 0.0f, 0.0f, 0.0f, 1.0f };
float lightDiffuse[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightSpecular[4] = { 1.0f, 1.0f, 1.0f, 1.0f };

float *matAmb = Util::goldAmbient();
float *matDif = Util::goldDiffuse();
float *matSpe = Util::goldSpecular();
float matShi = Util::goldShininess();

//Sphere model(48);
Torus model(48, 0.5f, 0.2f);
//ImportedModel model("unicorn.obj");

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void installLights(glm::mat4 vMatrix)
{
    // å°†å…‰æºä½ç½®è½¬æ¢ä¸ºè§†å›¾ç©ºé—´åæ ‡ï¼Œå­˜å…¥æµ®ç‚¹æ•°ç»„
    lightPosV = glm::vec3(vMatrix * glm::vec4(currentLightPos, 1.0));
    lightPos[0] = lightPosV.x;
    lightPos[1] = lightPosV.y;
    lightPos[2] = lightPosV.z;

    // åœ¨ç€è‰²å™¨è·å–å…‰æºä½ç½®å’Œæè´¨å±æ€§
    globalAmbLoc = glGetUniformLocation(renderProgram, "globalAmbient");
    ambLoc = glGetUniformLocation(renderProgram, "light.ambient");
    diffLoc = glGetUniformLocation(renderProgram, "light.diffuse");
    specLoc = glGetUniformLocation(renderProgram, "light.specular");
    posLoc = glGetUniformLocation(renderProgram, "light.position");
    mAmbLoc = glGetUniformLocation(renderProgram, "material.ambient");
    mDifLoc = glGetUniformLocation(renderProgram, "material.diffuse");
    mSpecLoc = glGetUniformLocation(renderProgram, "material.specular");
    mShiLoc = glGetUniformLocation(renderProgram, "material.shininess");

    // åœ¨ç€è‰²å™¨ä¸­ä¸ºå…‰æºä¸æè´¨ç»Ÿä¸€å˜é‡èµ‹å€¼
    glProgramUniform4fv(renderProgram, globalAmbLoc, 1, globalAmbient);
    glProgramUniform4fv(renderProgram, ambLoc, 1, lightAmbient);
    glProgramUniform4fv(renderProgram, diffLoc, 1, lightDiffuse);
    glProgramUniform4fv(renderProgram, specLoc, 1, lightSpecular);
    glProgramUniform3fv(renderProgram, posLoc, 1, lightPos);
    glProgramUniform4fv(renderProgram, mAmbLoc, 1, matAmb);
    glProgramUniform4fv(renderProgram, mDifLoc, 1, matDif);
    glProgramUniform4fv(renderProgram, mSpecLoc, 1, matSpe);
    glProgramUniform1f(renderProgram, mShiLoc, matShi);
}

void makeVertexArray()
{
    std::vector&lt;int&gt; ind = model.getIndices();
    std::vector&lt;glm::vec3&gt; vert = model.getVertices();
    std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
    std::vector&lt;glm::vec3&gt; norm = model.getNormals();

    std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
    std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
    std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

    for (int i = 0; i &lt; model.getNumVertices(); ++ i)
    {
        pvalues.push_back(vert[i].x);
        pvalues.push_back(vert[i].y);
        pvalues.push_back(vert[i].z);
        tvalues.push_back(tex[i].s);
        tvalues.push_back(tex[i].t);
        nvalues.push_back(norm[i].x);
        nvalues.push_back(norm[i].y);
        nvalues.push_back(norm[i].z);
    }

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]);

    glGenBuffers(numVBO, vbo);
    // é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
    // çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
    // æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
    // é¡¶ç‚¹ç´¢å¼•æ”¾å…¥ç¼“å†²åŒº3
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * ind.size(), &amp;ind[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 4.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
    nLoc = glGetUniformLocation(renderProgram, "norm_matrix");

    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, 0.0f));
    mMat = glm::rotate(mMat, 35.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));

    // åŸºäºå½“å‰å…‰æºä½ç½®ï¼Œåˆå§‹åŒ–å…‰ç…§
    currentLightPos = glm::vec3(initialLightLoc.x, initialLightLoc.y, initialLightLoc.z);
    installLights(vMat);

    mvMat = vMat * mMat;
    // æ„å»º MV çŸ©é˜µçš„é€†è½¬ç½®çŸ©é˜µï¼Œç”¨äºå˜æ¢æ³•å‘é‡
    invTrMat = glm::transpose(glm::inverse(mvMat));

    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
    glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));

    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(1);

    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    //glDrawArrays(GL_TRIANGLES, 0, model.getNumVertices());
    // åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Light", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>å®šä¹‰å‡½æ•° <code>installLights()</code> å°†å…‰æºåœ¨è§†è§‰ç©ºé—´ä¸­çš„ä½ç½®å’Œæè´¨çš„ ADS ç‰¹æ€§è¯»å…¥ç›¸åº”çš„ç»Ÿä¸€å˜é‡ã€‚</li>
<li>ç›´æ¥å¯¹æ³•å‘é‡åº”ç”¨ MV çŸ©é˜µä¸èƒ½ä¿è¯æ³•å‘é‡ä¾ç„¶ä¸ç‰©ä½“è¡¨é¢å‚ç›´ã€‚ä½¿ç”¨ MV çŸ©é˜µçš„é€†è½¬ç½®çŸ©é˜µï¼Œç”¨äºå˜æ¢æ³•å‘é‡ã€‚</li>
<li>å˜é‡ lightPosV åŒ…å«å…‰æºåœ¨ç›¸æœºç©ºé—´ä¸­çš„ä½ç½®ï¼Œæ¯å¸§åªéœ€è¦è®¡ç®—ä¸€æ¬¡ã€‚</li>
</ul>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

struct PositionalLight
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    vec3 position;
};

struct Material
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    float shininess;
};

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec3 vertNormal;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;    // ç”¨äºå˜æ¢æ³•å‘é‡
uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;

out vec4 color;

void main()
{
    // å°†é¡¶ç‚¹ä½ç½®å’Œæ³•å‘é‡è½¬æ¢åˆ°è§†è§‰ç©ºé—´
    // è®¡ç®—è§†è§‰ç©ºé—´å…‰ç…§å‘é‡ï¼ˆä»é¡¶ç‚¹åˆ°å…‰æºï¼‰
    vec4 P = mv_matrix * vec4(vertPos, 1.0);
    vec3 N = normalize((norm_matrix * vec4(vertNormal, 0.0)).xyz);
    vec3 L = normalize(light.position - P.xyz);

    // è§†è§‰å‘é‡ç­‰äºè§†è§‰ç©ºé—´ä¸­è´Ÿé¡¶ç‚¹ä½ç½®
    vec3 V = normalize(-P.xyz);

    // R æ˜¯ -L çš„ç›¸å¯¹äºè¡¨é¢å‘é‡ N çš„é•œåƒ
    vec3 R = reflect(-L, N);

    // ç¯å¢ƒå…‰ã€æ¼«åå°„å’Œé•œé¢åå°„åˆ†é‡
    vec3 ambient = ((globalAmbient * material.ambient) + (light.ambient * material.ambient)).xyz;
    vec3 diffuse = light.diffuse.xyz * material.diffuse.xyz * max(dot(N, L), 0.0);
    vec3 specular = pow(max(dot(R, V), 0.0f), material.shininess) * material.specular.xyz * light.specular.xyz;

    // å°†é¢œè‰²è¾“å‡ºåˆ°ç‰‡æ®µç€è‰²å™¨

    gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
    color = vec4(ambient + diffuse + specular, 1.0);
}
</code></pre>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>å­—æ®µé€‰æ‹©å™¨ç¬¦å·â€œ.xyzâ€ï¼Œæ˜¯å°† <code>vec4</code> è½¬æ¢ä¸ºä»…åŒ…å«å…¶å‰ 3 ä¸ªå…ƒç´ çš„ç­‰æ•ˆ <code>vec3</code> çš„â€œå¿«æ·æ–¹å¼â€ã€‚</li>
<li><code>normalize()</code> ç”¨æ¥å°†å‘é‡è½¬æ¢ä¸ºå•ä½é•¿åº¦ã€‚</li>
<li><code>reflect()</code> å‡½æ•°ç”¨ä¸è®¡ç®—ä¸€ä¸ªå‘é‡åŸºäºå¦ä¸€ä¸ªå‘é‡çš„åå°„ã€‚</li>
<li><code>dot()</code> å‡½æ•°ä¸ºç‚¹ä¹˜è¿ç®—ã€‚</li>
</ul>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

in vec4 color;
out vec4 fragColor;

void main()
{
    fragColor = color;
}
</code></pre>
</details>
<p>Gouraud ç€è‰²å®¹æ˜“å—åˆ°å…¶ä»–ä¼ªå½±å½±å“ã€‚</p>
<ul>
<li>å¦‚æœé•œé¢é«˜å…‰èŒƒå›´å†…ä¸€ä¸ªæ¨¡å‹é¡¶ç‚¹ä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½ä¸ä¼šè¢«æ¸²æŸ“å‡ºæ¥ã€‚</li>
<li>é•œé¢åå°„åˆ†é‡æ˜¯ä¾é¡¶ç‚¹è®¡ç®—çš„ï¼Œå› æ­¤ï¼Œå½“æ¨¡å‹çš„æ‰€æœ‰é¡¶ç‚¹éƒ½æ²¡æœ‰é•œé¢åå°„åˆ†é‡æ—¶ï¼Œå…¶æ …æ ¼åŒ–åçš„åƒç´ ä¹Ÿä¸ä¼šæœ‰é•œé¢åå°„æ•ˆæœã€‚</li>
</ul>
<h4 id="7-5-2-phong-ç€è‰²">7.5.2 Phong ç€è‰²</h4>
<p>è¯¥ç®—æ³•çš„ç»“æ„ç±»ä¼¼ Gouraud ç€è‰²ç®—æ³•ï¼Œä¸åŒä¹‹å¤„åœ¨äºå…‰ç…§è®¡ç®—æ˜¯<strong>æŒ‰åƒç´ è€Œéé¡¶ç‚¹</strong>å®Œæˆçš„ã€‚</p>
<ul>
<li>é¡¶ç‚¹ç€è‰²å™¨
<ol>
<li>è®¡ç®—å‘é‡ Nã€Lã€V</li>
<li>è¾“å‡ºå±æ€§ Nã€Lã€Vã€<code>gl_position</code></li>
</ol>
</li>
<li>ç‰‡æ®µç€è‰²å™¨
<ol>
<li>ä¼ å…¥æ’å€¼ Nã€Lã€V</li>
<li>è®¡ç®— Rã€Î¸ã€Ï†</li>
<li>è®¡ç®— ADS åˆ†é‡</li>
<li>è¾“å‡ºé¢œè‰²</li>
</ol>
</li>
</ul>
<p>å°†ä¹‹å‰åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å®ç°çš„è¿‡ç¨‹ç§»åˆ°ç‰‡æ®µç€è‰²å™¨ä¸­è¿›è¡Œã€‚</p>
<p>æ•… main.cppå’Œ Util ç±»æ— éœ€æ”¹å˜ï¼Œåªéœ€ä¿®æ”¹ç€è‰²å™¨çš„ä»£ç ã€‚</p>
<p>å¯¹äºåŸå§‹çš„ Phong è¿›è¡Œä¼˜åŒ–ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> çš„è®¡ç®—æ˜¯éå¿…é¡»çš„ã€‚</li>
<li>è§’ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> å¯ä»¥é€šè¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span> çš„è§’å¹³åˆ†çº¿å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span> å¾—åˆ°ã€‚
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>L</mi><mo>+</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">H = L + V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\theta = \frac{1}{2}\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">Ï†</span></span></span></span></li>
<li>ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span> ä»£æ›¿ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï†</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Ï†</span></span></span></span> å°±å·²ç»å¯ä»¥è·å¾—è¶³å¤Ÿå¥½çš„ç»“æœã€‚</li>
</ul>
</li>
<li>æœ€åé•œé¢åå°„åˆ†é‡åœ¨å…‰æ³½åº¦ä¹˜ 3.0 ä½œä¸ºæ”¹å–„é•œé¢é«˜å…‰çš„å¾®è°ƒã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_optobPointIncidence.png" alt="ä½¿ç”¨Î±ä»£æ›¿Ï†"></p>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

struct PositionalLight
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    vec3 position;
};

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec3 vertNormal;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;    // ç”¨äºå˜æ¢æ³•å‘é‡
uniform PositionalLight light;

out vec3 normals;    // è§†è§‰ç©ºé—´é¡¶ç‚¹æ³•å‘é‡
out vec3 lightDir;    // æŒ‡å‘å…‰æºçš„å‘é‡
out vec3 halfVector;// è§’å¹³åˆ†çº¿å‘é‡ H

void main()
{
    vec3 _vertPos;    // è§†è§‰ç©ºé—´ä¸­çš„é¡¶ç‚¹ä½ç½®
    // è¾“å‡ºé¡¶ç‚¹ä½ç½®ã€å…‰ç…§æ–¹å‘å’Œæ³•å‘é‡åˆ°å…‰æ …ç€è‰²å™¨è¿›è¡Œæ’å€¼
    _vertPos = (mv_matrix * vec4(vertPos, 1.0)).xyz;
    lightDir = light.position - _vertPos;
    normals = (norm_matrix * vec4(vertNormal, 1.0)).xyz;
    halfVector = (lightDir + (-_vertPos)).xyz;
    gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

struct PositionalLight
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    vec3 position;
};

struct Material
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    float shininess;
};

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;

in vec3 normals;
in vec3 lightDir;
in vec3 halfVector;
out vec4 fragColor;

void main()
{
    // å½’ä¸€åŒ–å…‰ç…§å‘é‡ã€æ³•å‘é‡ã€å¹³åˆ†çº¿å‘é‡
    vec3 L = normalize(lightDir);
    vec3 N = normalize(normals);
    vec3 H = normalize(halfVector);

    // è®¡ç®—å…‰ç…§ä¸å¹³é¢æ³•å‘é‡é—´çš„è§’åº¦
    float cosTheta = dot(L, N);
    // è®¡ç®—æ³•å‘é‡ N ä¸è§’å¹³åˆ†çº¿å‘é‡ H ä¹‹é—´çš„è§’åº¦
    float cosPhi = dot(H, N);

    // æŒ‰åƒç´ è®¡ç®— ADS åˆ†é‡ï¼Œåˆå¹¶æ„å»ºè¾“å‡ºé¢œè‰²
    vec3 ambient = ((globalAmbient * material.ambient) + (light.ambient * material.ambient)).xyz;
    vec3 diffuse = light.diffuse.xyz * material.diffuse.xyz * max(cosTheta, 0.0);
    vec3 specular = light.specular.xyz * material.specular.xyz * pow(max(cosPhi, 0.0), material.shininess * 3.0);

    fragColor = vec4(ambient + diffuse + specular, 1.0);
}
</code></pre>
</details>
<h3 id="7-6-ç»“åˆå…‰ç…§å’Œçº¹ç†">7.6 ç»“åˆå…‰ç…§å’Œçº¹ç†</h3>
<p>ç»“åˆå…‰ç…§å’Œçº¹ç†çš„æ–¹å¼å–å†³äºç‰©ä½“çš„ç‰¹æ€§åŠå…¶çº¹ç†çš„ç›®çš„ï¼š</p>
<ul>
<li>çº¹ç†å›¾åƒå¾ˆå†™å®åœ°åæ˜ äº†ç‰©ä½“çœŸå®çš„è¡¨é¢å¤–è§‚ï¼›</li>
<li>ç‰©ä½“åŒæ—¶å…·æœ‰æè´¨å’Œçº¹ç†ï¼›</li>
<li>æè´¨åŒ…æ‹¬é˜´å½±å’Œåå°„ä¿¡æ¯ï¼›</li>
<li>æœ‰å¤šç§å…‰æˆ–å¤šä¸ªçº¹ç†</li>
</ul>
<p>å½“ç‰©ä½“æ‹¥æœ‰ä¸€ä¸ªç®€å•çš„çº¹ç†ï¼ŒåŒæ—¶è¿›è¡Œå…‰ç…§æ—¶ï¼Œç®€å•çš„æ–¹æ³•æ˜¯ï¼š</p>
<ol>
<li>åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­å®Œå…¨å°†æè´¨ç‰¹æ€§å»é™¤ï¼›</li>
<li>ä½¿ç”¨çº¹ç†å–æ ·æ‰€å¾—çº¹ç†é¢œè‰²ä»£æ›¿æè´¨çš„ ADS å€¼ã€‚</li>
</ol>
<ul>
<li>å¯¹äºé—ªäº®è¡¨é¢ï¼š
<ul>
<li>çº¹ç†é¢œè‰²å½±å“äº†ç¯å¢ƒå…‰å’Œæ¼«åå°„åˆ†é‡ï¼Œè€Œé•œé¢åå°„é¢œè‰²ä»…ç”±å…‰æºå†³å®šã€‚</li>
</ul>
</li>
</ul>
<pre><code class="language-cpp">fragColor = textureColor * (ambient + diffuse) + specular;
</code></pre>
<ul>
<li>
<p>å¯¹äºéé—ªäº®è¡¨é¢ï¼š</p>
<ul>
<li>
<p>é•œé¢é«˜å…‰éƒ¨åˆ†åº”å½“åŒ…å«ç‰©ä½“è¡¨é¢é¢œè‰²ã€‚</p>
<pre><code class="language-cpp">fragColor = textureColor * (ambient + diffuse + specular);
</code></pre>
</li>
</ul>
</li>
<li>
<p>å¯¹äºç‰©ä½“æ—¢æœ‰ ADS æè´¨ï¼Œåˆæœ‰çº¹ç†å›¾åƒï¼ŒåŠ æƒæ±‚å’Œã€‚</p>
</li>
</ul>
<pre><code class="language-cpp">textureColor = texture(samp, texCoord);
lightColor = (ambLight * ambMaterial) + (diffLight * diffMaterial) + specLight;
fragColor = 0.5 * textureColor + 0.5 * lightColor;
</code></pre>
<ul>
<li>ç»“åˆäº†å…‰ç…§ã€æè´¨ã€çº¹ç†ï¼Œå¹¶èƒ½å¤Ÿæ‰©å±•åˆ°å¤šä¸ªå…‰æºã€å¤šç§æè´¨çš„æƒ…å†µã€‚</li>
</ul>
<pre><code class="language-cpp">texture1Color = texture(sampler1, texCoord);
texture2Color = texture(sampler2, texCoord);
light1Color = (ambLight1 * ambMaterial) + (diffLight1 * diffMaterial) + specLight1;
light2Color = (ambLight2 * ambMaterial) + (diffLight2 * diffMaterial) + specLight2;
fragColor = 0.25 * texture1Color + 
            0.25 * texture2Color +
            0.25 * light1Color +
            0.25 * light2Color;
</code></pre>
<p>ç¨ä½œå°è¯•çš„ä¸€ä¸ªä¾‹å­ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_movinglight.gif" alt="é’é“œæè´¨ã€å†°å—çº¹ç†ã€ç§»åŠ¨å…‰æºä¸‹çš„æé¾™"></p>
<p>å¯¹äºè¿™ä¸ªä¾‹å­çš„ä»£ç ï¼ˆImportedModel ç±»å’Œ Util ç±»åŒä¹‹å‰ï¼‰ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint mvLoc, projLoc, nLoc;
GLuint textureID;

// å…‰æºå±æ€§
GLuint globalAmbLoc, ambLoc, diffLoc, specLoc, posLoc;
// æè´¨å±æ€§
GLuint mAmbLoc, mDifLoc, mSpecLoc, mShiLoc;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;
glm::vec3 currentLightPos, lightPosV;    // æ¨¡å‹å’Œè§†è§‰ç©ºé—´ä¸­çš„å…‰ç…§ä½ç½®
float lightPos[3];    // å…‰ç…§ä½ç½®çš„æµ®ç‚¹æ•°ç»„

// åˆå§‹åŒ–å…‰ç…§ä½ç½®
glm::vec3 initialLightLoc = glm::vec3(5.0f, 2.0f, 2.0f);

// ç™½å…‰ç‰¹æ€§
float globalAmbient[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightAmbient[4] = { 0.0f, 0.0f, 0.0f, 1.0f };
float lightDiffuse[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightSpecular[4] = { 1.0f, 1.0f, 1.0f, 1.0f };

float *matAmb = Util::bronzeAmbient();
float *matDif = Util::bronzeDiffuse();
float *matSpe = Util::bronzeSpecular();
float matShi = Util::bronzeShininess();

//Sphere model(48);
//Torus model(48, 0.5f, 0.2f);
// åŠ è½½çš„æ¨¡å‹è¿˜ä¸èƒ½ä½¿ç”¨ç´¢å¼•
ImportedModel model("model/velociraptor.obj");

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    glViewport(0, 0, width, height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void installLights(glm::mat4 vMatrix)
{
    // å°†å…‰æºä½ç½®è½¬æ¢ä¸ºè§†å›¾ç©ºé—´åæ ‡ï¼Œå­˜å…¥æµ®ç‚¹æ•°ç»„
    lightPosV = glm::vec3(vMatrix * glm::vec4(currentLightPos, 1.0));
    lightPos[0] = lightPosV.x;
    lightPos[1] = lightPosV.y * 10.0f * cos(glfwGetTime() * 2.0f);
    lightPos[2] = lightPosV.z;

    // åœ¨ç€è‰²å™¨è·å–å…‰æºä½ç½®å’Œæè´¨å±æ€§
    globalAmbLoc = glGetUniformLocation(renderProgram, "globalAmbient");
    ambLoc = glGetUniformLocation(renderProgram, "light.ambient");
    diffLoc = glGetUniformLocation(renderProgram, "light.diffuse");
    specLoc = glGetUniformLocation(renderProgram, "light.specular");
    posLoc = glGetUniformLocation(renderProgram, "light.position");
    mAmbLoc = glGetUniformLocation(renderProgram, "material.ambient");
    mDifLoc = glGetUniformLocation(renderProgram, "material.diffuse");
    mSpecLoc = glGetUniformLocation(renderProgram, "material.specular");
    mShiLoc = glGetUniformLocation(renderProgram, "material.shininess");

    // åœ¨ç€è‰²å™¨ä¸­ä¸ºå…‰æºä¸æè´¨ç»Ÿä¸€å˜é‡èµ‹å€¼
    glProgramUniform4fv(renderProgram, globalAmbLoc, 1, globalAmbient);
    glProgramUniform4fv(renderProgram, ambLoc, 1, lightAmbient);
    glProgramUniform4fv(renderProgram, diffLoc, 1, lightDiffuse);
    glProgramUniform4fv(renderProgram, specLoc, 1, lightSpecular);
    glProgramUniform3fv(renderProgram, posLoc, 1, lightPos);
    glProgramUniform4fv(renderProgram, mAmbLoc, 1, matAmb);
    glProgramUniform4fv(renderProgram, mDifLoc, 1, matDif);
    glProgramUniform4fv(renderProgram, mSpecLoc, 1, matSpe);
    glProgramUniform1f(renderProgram, mShiLoc, matShi);
}

void makeVertexArray()
{
    //std::vector&lt;int&gt; ind = model.getIndices();
    std::vector&lt;glm::vec3&gt; vert = model.getVertices();
    std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
    std::vector&lt;glm::vec3&gt; norm = model.getNormals();

    std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
    std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
    std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

    for (int i = 0; i &lt; model.getNumVertices(); ++ i)
    {
        pvalues.push_back(vert[i].x);
        pvalues.push_back(vert[i].y);
        pvalues.push_back(vert[i].z);
        tvalues.push_back(tex[i].s);
        tvalues.push_back(tex[i].t);
        nvalues.push_back(norm[i].x);
        nvalues.push_back(norm[i].y);
        nvalues.push_back(norm[i].z);
    }

    glGenVertexArrays(numVAO, vao);
    glBindVertexArray(vao[0]);

    glGenBuffers(numVBO, vbo);
    // é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
    // çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
    // æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
    // é¡¶ç‚¹ç´¢å¼•æ”¾å…¥ç¼“å†²åŒº3
    //glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    //glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * ind.size(), &amp;ind[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
    renderProgram = Util::createShadeProgram("Phong/vertex.glsl", "Phong/fragment.glsl");
    cameraX = 0.0f, cameraY = 0.0f, cameraZ = 4.0f;

    glfwGetFramebufferSize(window, &amp;width, &amp;height);
    aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
    pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

    makeVertexArray();

    textureID = Util::loadTexture("textureImg/ice.jpg");
    glBindTexture(GL_TEXTURE_2D, textureID);
}

void display(GLFWwindow *window, double currentTime)
{
    glClear(GL_DEPTH_BUFFER_BIT);
    glClear(GL_COLOR_BUFFER_BIT);
    glUseProgram(renderProgram);

    mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
    projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
    nLoc = glGetUniformLocation(renderProgram, "norm_matrix");

    vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
    mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, -1.0f, 0.0f));
    mMat = glm::rotate(mMat, 35.0f * 3.14159f / 180.0f, glm::vec3(0.0f, 1.0f, 0.0f));
    mMat *= glm::scale(glm::mat4(1.0f), glm::vec3(5.0f, 5.0f, 5.0f));

    // åŸºäºå½“å‰å…‰æºä½ç½®ï¼Œåˆå§‹åŒ–å…‰ç…§
    currentLightPos = glm::vec3(initialLightLoc.x, initialLightLoc.y, initialLightLoc.z);
    installLights(vMat);

    mvMat = vMat * mMat;
    // æ„å»º MV çŸ©é˜µçš„é€†è½¬ç½®çŸ©é˜µï¼Œç”¨äºå˜æ¢æ³•å‘é‡
    invTrMat = glm::transpose(glm::inverse(mvMat));

    glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
    glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
    glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));

    glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(1);

    glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
    glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(2);

    glActiveTexture(GL_TEXTURE0);
    glBindTexture(GL_TEXTURE_2D, textureID);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
    glGenerateMipmap(GL_TEXTURE_2D);
    if (glewIsSupported("GL_EXT_texture_filter_anisotropic"))
    {
        GLfloat anisoSetting = 0.0f;
        glGetFloatv(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT, &amp;anisoSetting);
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAX_ANISOTROPY_EXT, anisoSetting);
    }

    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glDrawArrays(GL_TRIANGLES, 0, model.getNumVertices());
    // åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
    //glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
    //glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
    if (!glfwInit())    exit(EXIT_FAILURE);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
    GLFWwindow *window = glfwCreateWindow(800, 600, "Light", NULL, NULL);
    glfwMakeContextCurrent(window);
    if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
    glfwSwapInterval(1);

    glfwSetWindowSizeCallback(window, windowSizeCallback);

    init(window);

    while (!glfwWindowShouldClose(window))
    {
        display(window, glfwGetTime());
        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    glfwDestroyWindow(window);
    glfwTerminate();

    return 0;
}
</code></pre>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-cpp">// vertex.glsl
#version 460 core

struct PositionalLight
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    vec3 position;
};

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec2 texCoord;
layout(location = 2) in vec3 vertNormal;

layout(binding = 0) uniform sampler2D samp;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;    // ç”¨äºå˜æ¢æ³•å‘é‡
uniform PositionalLight light;

out vec3 normals;    // è§†è§‰ç©ºé—´é¡¶ç‚¹æ³•å‘é‡
out vec3 lightDir;    // æŒ‡å‘å…‰æºçš„å‘é‡
out vec3 halfVector;// è§’å¹³åˆ†çº¿å‘é‡ H
out vec2 tc;

void main()
{
    vec3 _vertPos;    // è§†è§‰ç©ºé—´ä¸­çš„é¡¶ç‚¹ä½ç½®
    // è¾“å‡ºé¡¶ç‚¹ä½ç½®ã€å…‰ç…§æ–¹å‘å’Œæ³•å‘é‡åˆ°å…‰æ …ç€è‰²å™¨è¿›è¡Œæ’å€¼
    _vertPos = (mv_matrix * vec4(vertPos, 1.0)).xyz;
    lightDir = light.position - _vertPos;
    normals = (norm_matrix * vec4(vertNormal, 1.0)).xyz;
    halfVector = (lightDir + (-_vertPos)).xyz;
    gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
    tc = texCoord;
}
</code></pre>
<pre><code class="language-cpp">// fragment.glsl
#version 460 core

struct PositionalLight
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    vec3 position;
};

struct Material
{
    vec4 ambient;
    vec4 diffuse;
    vec4 specular;
    float shininess;
};

layout(binding = 0) uniform sampler2D samp;

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;

in vec2 tc;
in vec3 normals;
in vec3 lightDir;
in vec3 halfVector;
out vec4 fragColor;

void main()
{
    // å½’ä¸€åŒ–å…‰ç…§å‘é‡ã€æ³•å‘é‡ã€è§†è§‰å‘é‡
    vec3 L = normalize(lightDir);
    vec3 N = normalize(normals);
    vec3 H = normalize(halfVector);

    // è®¡ç®—å…‰ç…§ä¸å¹³é¢æ³•å‘é‡é—´çš„è§’åº¦
    float cosTheta = dot(L, N);
    // è®¡ç®—æ³•å‘é‡ N ä¸è§’å¹³åˆ†çº¿å‘é‡ H ä¹‹é—´çš„è§’åº¦
    float cosPhi = dot(H, N);

    // æŒ‰åƒç´ è®¡ç®— ADS åˆ†é‡ï¼Œåˆå¹¶æ„å»ºè¾“å‡ºé¢œè‰²
    vec3 ambient = ((globalAmbient * material.ambient) + (light.ambient * material.ambient)).xyz;
    vec3 diffuse = light.diffuse.xyz * material.diffuse.xyz * max(cosTheta, 0.0);
    vec3 specular = light.specular.xyz * material.specular.xyz * pow(max(cosPhi, 0.0), material.shininess * 3.0);

    vec4 textureColor = texture(samp, tc);
    vec4 lightColor = light.ambient + light.diffuse + light.specular;
    vec4 stripLightColor = vec4(ambient + diffuse + specular, 1.0);

    fragColor = 0.3 * textureColor + 0.7 * stripLightColor;
}
</code></pre>
</details>
<h2 id="å…«-é˜´å½±">å…«ã€é˜´å½±</h2>
<h3 id="8-1-æŠ•å½±é˜´å½±">8.1 æŠ•å½±é˜´å½±</h3>
<p>æŠ•å½±é˜´å½±ï¼šç»™å®šä¸€ä¸ªä½äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1, z_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> çš„ç‚¹å…‰æºï¼Œä¸€ä¸ªéœ€è¦æ¸²æŸ“çš„ç‰©ä½“ï¼ˆç‰©ä½“ä¸Šçš„ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>w</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>w</mi></msub><mo separator="true">,</mo><msub><mi>z</mi><mi>w</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_w, y_w, z_w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼‰å’Œä¸€ä¸ªæŠ•å°„é˜´å½±çš„å¹³é¢ï¼Œå¯ä»¥é€šè¿‡ç”Ÿæˆä¸€ä¸ªå˜æ¢çŸ©é˜µï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_projectedShadow.png" alt="æŠ•å½±é˜´å½±"></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>w</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>w</mi></msub><mo separator="true">,</mo><msub><mi>z</mi><mi>w</mi></msub><mo stretchy="false">)</mo><mo>â†’</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>S</mi></msub><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>z</mi><mi>S</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_w, y_w, z_w)\rightarrow(x_S,0,z_S)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li>é€šå¸¸ä½¿ç”¨æš—è‰²ç‰©ä½“ä¸åœ°å¹³é¢çº¹ç†æ··åˆä½œä¸ºé˜´å½±çš„çº¹ç†ã€‚</li>
</ul>
<p>æŠ•å½±é˜´å½±æ˜“äºå®ç°ï¼Œä½†ä»…é€‚ç”¨äºå¹³å¦è¡¨é¢ã€‚</p>
<h3 id="8-2-é˜´å½±ä½“">8.2 é˜´å½±ä½“</h3>
<p>æ‰¾åˆ°è¢«ç‰©ä½“é˜´å½±è¦†ç›–çš„é˜´å½±ä½“ï¼Œä¹‹åå‡å°‘è§†ä½“ä¸é˜´å½±ä½“ç›¸äº¤éƒ¨åˆ†ä¸­çš„å¤šè¾¹å½¢çš„é¢œè‰²å¼ºåº¦ã€‚</p>
<p>é˜´å½±ä½“çš„ä¼˜ç‚¹åœ¨äºå…¶é«˜åº¦å‡†ç¡®ï¼Œæ¯”èµ·å…¶ä»–æ–¹æ³•æ¥æ›´ä¸å®¹æ˜“äº§ç”Ÿä¼ªå½±ã€‚</p>
<p>å‡ ä½•ç€è‰²å™¨å¯ä»¥ç”¨äºè®¡ç®—é˜´å½±ä½“ï¼Œæ¨¡æ¿ç¼“å†²åŒºå¯ä»¥ç”¨äºåˆ¤æ–­åƒç´ <br>
æ˜¯å¦åœ¨é˜´å½±ä½“å†…ã€‚æœ‰äº›æ˜¾å¡å¯¹äºç‰¹å®šçš„é˜´å½±ä½“æ“ä½œä¼˜åŒ–æä¾›äº†ç¡¬ä»¶æ”¯æŒã€‚</p>
<h3 id="8-3-é˜´å½±è´´å›¾">8.3 é˜´å½±è´´å›¾</h3>
<p>é˜´å½±è´´å›¾çš„æƒ³æ³•ï¼šå…‰çº¿æ— æ³•â€œçœ‹åˆ°â€çš„ä»»ä½•ä¸œè¥¿éƒ½åœ¨é˜´å½±ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå¯¹è±¡ 1 é˜»æŒ¡å…‰çº¿åˆ°è¾¾å¯¹è±¡ 2ï¼Œç­‰åŒäºå…‰çº¿ä¸èƒ½â€œçœ‹åˆ°â€å¯¹è±¡ 2</p>
<p>æ‰€ä»¥è®¡ç®—ç­–ç•¥æ˜¯ï¼šæš‚æ—¶å°†ç›¸æœºç§»åŠ¨åˆ°å…‰çš„ä½ç½®ï¼Œåº”ç”¨ Z-buffer ç®—æ³•ï¼Œç„¶åä½¿ç”¨ç”Ÿæˆçš„æ·±åº¦ä¿¡æ¯æ¥è®¡ç®—ã€‚</p>
<p>ç”±æ­¤å¯å¾—ï¼Œæ¸²æŸ“åœºæ™¯éœ€è¦ä¸¤è½®ï¼š</p>
<ul>
<li>ç¬¬ä¸€è½®ä»å…‰æºè§’åº¦æ¸²æŸ“åœºæ™¯ï¼ˆä¸ç»˜åˆ¶ï¼‰ã€‚å¯¹äºæ¯ä¸ªåƒç´ ï¼Œæ·±åº¦ç¼“å†²åŒºåŒ…å«å…‰æºä¸æœ€è¿‘çš„å¯¹è±¡ä¹‹é—´çš„è·ç¦»ã€‚
<ul>
<li>ç”Ÿæˆæ·±åº¦ç¼“å†²åŒºã€‚</li>
</ul>
</li>
<li>å°†æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°çº¹ç†å¯¹è±¡ã€‚
<ul>
<li>å½“çº¹ç†å¯¹è±¡ç”¨äºå‚¨å­˜é˜´å½±æ·±åº¦ä¿¡æ¯æ—¶ï¼Œç§°å…¶ä¸ºé˜´å½±çº¹ç†ã€‚</li>
<li>å°†æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°çº¹ç†ä¸­çš„è¿‡ç¨‹ç§°ä¸ºâ€œé˜´å½±è´´å›¾â€ã€‚</li>
</ul>
</li>
<li>ç¬¬äºŒè½®ä»ç›¸æœºè§’åº¦æ¸²æŸ“åœºæ™¯ï¼ˆæ­£å¸¸æ¸²æŸ“ï¼‰ã€‚å¯¹äºæ¯ä¸ªåƒç´ ï¼Œåœ¨é˜´å½±çº¹ç†ä¸­æŸ¥æ‰¾ç›¸åº”çš„ä½ç½®ã€‚
<ul>
<li>å¦‚æœç›¸æœºåˆ°æ¸²æŸ“ç‚¹çš„è·ç¦»å¤§äºä»é˜´å½±çº¹ç†æ£€ç´¢åˆ°çš„å€¼ï¼Œåˆ™åœ¨è¯¥åƒç´ å¤„ç»˜åˆ¶çš„å¯¹è±¡ç¦»å…‰æºçš„è·ç¦»æ¯”å½“å‰ç¦»å…‰æºæœ€è¿‘çš„å¯¹è±¡ç¦»å…‰æºæ›´è¿œï¼Œå¾—å‡ºè¯¥åƒç´ å¤„äºé˜´å½±ä¸­ã€‚</li>
</ul>
</li>
</ul>
<p>é˜´å½±çš„å¤„ç†ï¼šä»…æ¸²æŸ“ç¯å¢ƒå…‰ï¼Œå¿½ç•¥æ¼«åå°„å’Œé•œé¢åå°„åˆ†é‡ã€‚</p>
<h4 id="8-3-1-ç¬¬ä¸€è½®-ä»å…‰æºä½ç½®ç»˜åˆ¶">8.3.1 ç¬¬ä¸€è½®â€”â€”ä»å…‰æºä½ç½®ç»˜åˆ¶</h4>
<p>ç¬¬ä¸€è½®ä¸­å¹¶ä¸æ˜¯çœŸçš„åœ¨æ˜¾ç¤ºå…¶ä¸­ç»˜åˆ¶åœºæ™¯ï¼Œæ•…ä»…éœ€ç”¨åˆ°é¡¶ç‚¹ç€è‰²å™¨ã€‚</p>
<p>é€šè¿‡å˜æ¢çŸ©é˜µï¼ˆæ„å»ºè§‚å¯ŸçŸ©é˜µï¼‰ç§»åŠ¨ç›¸æœºï¼š</p>
<ul>
<li>ç›¸æœºç§»åŠ¨åˆ°å…‰æºçš„ä½ç½®</li>
<li>ç›¸æœºæ–¹å‘æœå‘å‘ˆç°çš„åŒºåŸŸ</li>
</ul>
<p>ç¬¬ä¸€è½®éœ€è¦å¤„ç†çš„ç»†èŠ‚ï¼š</p>
<ol>
<li>é…ç½®ç¼“å†²åŒºå’Œé˜´å½±çº¹ç†ã€‚</li>
<li>ç¦ç”¨é¢œè‰²è¾“å‡ºã€‚</li>
<li>åœ¨å…‰æºå¤„ä¸ºè§†é‡ä¸­çš„ç‰©ä½“æ„å»ºä¸€ä¸ª LookAt çŸ©é˜µã€‚</li>
<li>å¯ç”¨ GLSL ç¬¬ä¸€è½®ç€è‰²å™¨ç¨‹åºï¼Œå‡†å¤‡æ¥å— MVP çŸ©é˜µã€‚
<ul>
<li>Mï¼šå¯¹è±¡çš„æ¨¡å‹çŸ©é˜µ</li>
<li>Vï¼šLookAt çŸ©é˜µä½œä¸ºè§‚å¯ŸçŸ©é˜µ</li>
<li>Pï¼šé€è§†çŸ©é˜µ</li>
<li>è¯¥ MVP çŸ©é˜µ ç§°ä¸º <code>shadowMVP</code>ã€‚</li>
</ul>
</li>
<li>ä¸ºæ¯ä¸ªå¯¹è±¡åˆ›å»ºä¸€ä¸ª <code>shadowMVP</code> çŸ©é˜µï¼Œå¹¶è°ƒç”¨ <code>glDrawArrays()</code>ã€‚</li>
</ol>
<p>é¡¶ç‚¹ç€è‰²å™¨å˜æˆï¼š</p>
<pre><code class="language-glsl">#version 460 core

layout(location = 0) in vec3 vertPos;
uniform mat4 shadowMVP;

void main()
{
	gl_Position = shadowMVP * vec4(vertPos, 1.0);
}
</code></pre>
<p>ç‰‡æ®µç€è‰²å™¨å˜æˆï¼š</p>
<pre><code class="language-glsl">#version 460 core
void main() {}
</code></pre>
<h4 id="8-3-2-å°†æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°çº¹ç†">8.3.2 å°†æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°çº¹ç†</h4>
<p>OpenGL æä¾›äº†ä¸¤ç§å°†æ·±åº¦ç¼“å†²åŒºæ·±åº¦æ•°æ®æ”¾å…¥çº¹ç†å•å…ƒçš„æ–¹æ³•ï¼š</p>
<ol>
<li>ç”Ÿæˆç©ºé˜´å½±çº¹ç†ï¼Œç„¶åä½¿ç”¨å‘½ä»¤ <code>glCopyTexImage2D()</code> å°†æ´»åŠ¨çš„æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°é˜´å½±çº¹ç†ä¸­ã€‚</li>
<li>åœ¨ç¬¬ä¸€è½®ä¸­æ„å»ºâ€œè‡ªå®šä¹‰å¸§ç¼“å†²åŒºâ€ï¼Œå¹¶ä½¿ç”¨å‘½ä»¤ <code>glFrameBufferTexture2D()</code> å°†é˜´å½±çº¹ç†é™„åŠ åˆ°ä¸Šé¢ã€‚
<ul>
<li>ä½¿ç”¨è¯¥æ–¹æ³•æ— é¡»å°†æ·±åº¦ç¼“å†²åŒºå¤åˆ¶åˆ°çº¹ç†ï¼Œå› ä¸ºç¼“å†²åŒºå·²ç»é™„åŠ äº†çº¹ç†ï¼Œæ·±åº¦ä¿¡æ¯ç”± OpenGL è‡ªåŠ¨æ”¾å…¥çº¹ç†ä¸­ã€‚</li>
</ul>
</li>
</ol>
<h4 id="8-3-3-ç¬¬äºŒè½®-ä»ç›¸æœºä½ç½®ç»˜åˆ¶">8.3.3 ç¬¬äºŒè½®â€”â€”ä»ç›¸æœºä½ç½®ç»˜åˆ¶</h4>
<p>ç¬¬äºŒè½®éœ€è¦æ¸²æŸ“å®Œæ•´çš„åœºæ™¯ã€å…¶ä¸­çš„æ‰€æœ‰ç‰©ä½“ä»¥åŠå…‰ç…§ã€æè´¨å’Œè£…é¥°åœºæ™¯ä¸­ç‰©ä½“çš„çº¹ç†ï¼ŒåŒæ—¶è¿˜ç¡®å®šé˜´å½±ã€‚</p>
<p>ä½¿ç”¨ä¸¤ä¸ª MVP çŸ©é˜µï¼š</p>
<ol>
<li>ä¸€ä¸ªå°†å¯¹è±¡åæ ‡è½¬æ¢ä¸ºå±å¹•åæ ‡çš„æ ‡å‡† MVP çŸ©é˜µï¼ˆåƒä¹‹å‰ä¸€æ ·ï¼‰ï¼›</li>
<li>ä¸€ä¸ªæ˜¯ç¬¬ä¸€è½®ç”Ÿæˆçš„ shadowMVP çŸ©é˜µï¼Œç”¨äºä»å…‰æºçš„è§’åº¦è¿›è¡Œæ¸²æŸ“ï¼Œå³ä»é˜´å½±çº¹ç†ä¸­æŸ¥æ‰¾æ·±åº¦ä¿¡æ¯ã€‚</li>
</ol>
<p>ä»çº¹ç†è´´å›¾æŸ¥æ‰¾åƒç´ æ—¶ï¼Œåº”è¯¥å¤„ç† OpenGL ç›¸æœºç©ºé—´ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-1,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> è€Œçº¹ç†è´´å›¾ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> ç©ºé—´çš„é—®é¢˜ï¼š</p>
<ul>
<li>ä½¿ç”¨é¢å¤–çš„å˜æ¢çŸ©é˜µ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>ã€‚
<ul>
<li>ç”¨äºä»ç›¸æœºç©ºé—´åˆ°çº¹ç†ç©ºé—´çš„è½¬æ¢</li>
</ul>
</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">B = \begin{bmatrix}
0.5 &amp; 0 &amp; 0 &amp; 0.5 \\
0 &amp; 0.5 &amp; 0 &amp; 0.5 \\
0 &amp; 0 &amp; 0.5 &amp; 0.5 \\
0 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80303em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span> å’Œ <code>shadowMVP</code> çŸ©é˜µç›¸ä¹˜ï¼Œå¾—åˆ° <code>shadowMVP2</code> çŸ©é˜µã€‚</p>
<p>ç¬¬äºŒè½®çš„å¤§æ¦‚æ“ä½œï¼š</p>
<ol>
<li>æ„å»ºå˜æ¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>ï¼Œç”¨äºä»å…‰ç…§ç©ºé—´è½¬æ¢åˆ°çº¹ç†ç©ºé—´ã€‚</li>
<li>å¯ç”¨é˜´å½±çº¹ç†ï¼Œè¿›è¡ŒæŸ¥æ‰¾ã€‚</li>
<li>å¯ç”¨é¢œè‰²è¾“å‡ºã€‚</li>
<li>å¯ç”¨ GLSL ç¬¬äºŒè½®æ¸²æŸ“ç¨‹åºã€‚</li>
<li>æ ¹æ®ç›¸æœºæ­£å¸¸ä½ç½®ä¸ºå¯¹è±¡æ„å»º MVP çŸ©é˜µã€‚</li>
<li>æ„å»º shadowMVP2 çŸ©é˜µã€‚ç€è‰²å™¨ç”¨å…¶æŸ¥æ‰¾é˜´å½±çº¹ç†ä¸­çš„åƒç´ åæ ‡ã€‚</li>
<li>å°†ç”Ÿæˆçš„å˜æ¢çŸ©é˜µå‘é€åˆ°ç€è‰²å™¨ç»Ÿä¸€å˜é‡ã€‚</li>
<li>å¯ç”¨åŒ…å«é¡¶ç‚¹ã€æ³•å‘é‡å’Œçº¹ç†åæ ‡çš„ç¼“å†²åŒºã€‚</li>
<li>è°ƒç”¨ <code>glDrawArrays()</code>ã€‚</li>
</ol>
<p>ç€è‰²å™¨çš„å·¥ä½œï¼š</p>
<ul>
<li>é¡¶ç‚¹ç€è‰²å™¨å°†é¡¶ç‚¹ä½ç½®ä»ç›¸æœºç©ºé—´è½¬æ¢ä¸ºå…‰ç…§ç©ºé—´ï¼Œå°†ç»“æœå‘é€åˆ°é¡¶ç‚¹å±æ€§ä¸­çš„ç‰‡æ®µç€è‰²å™¨ã€‚</li>
<li>ç‰‡æ®µç€è‰²å™¨è°ƒç”¨ <code>textureProj()</code> å‡½æ•°æŒ‡ç¤ºåƒç´ æ˜¯å¦å¤„äºå¼•ç”¨ä¸­ï¼ˆè¿”å›0æˆ–1ï¼‰ã€‚å¦‚æœä½äºé˜´å½±ä¸­ï¼Œåˆ™å‰”é™¤æ¼«åå°„å’Œé•œé¢åå°„ã€‚
<ul>
<li>ä½¿ç”¨ç‰¹æ®Šé‡‡æ ·å™¨å˜é‡ç±»å‹ <code>sampler2DShadow</code>ï¼Œå¯ä»¥é™„åŠ åˆ°ç¨‹åºä¸­çš„é˜´å½±çº¹ç†ä¸­ã€‚</li>
</ul>
</li>
</ul>
<p>å…³æ³¨ç»†èŠ‚ï¼šæ­£åœ¨æ¸²æŸ“çš„åƒç´ å’Œé˜´å½±çº¹ç†ä¸­çš„å€¼çš„æ·±åº¦æ¯”è¾ƒ</p>
<ol>
<li>åœ¨æ¨¡å‹ç©ºé—´ä¸­ä½¿ç”¨é¡¶ç‚¹åæ ‡ï¼Œä¸ shadowMVP2 ç›¸ä¹˜ç”Ÿæˆé˜´å½±çº¹ç†åæ ‡ï¼ˆå¯¹åº”äºæŠ•å½±åˆ°å…‰ç…§ç©ºé—´ä¸­çš„é¡¶ç‚¹åæ ‡ï¼Œæ˜¯ä¹‹å‰ä»å…‰æºè§†è§’ç”Ÿæˆçš„ï¼‰ã€‚</li>
<li>ç»è¿‡æ’å€¼åçš„å…‰ç…§ç©ºé—´ï¼ˆ3Dï¼‰åæ ‡ (x, y, z) åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ä½¿ç”¨æƒ…å†µï¼š
<ul>
<li>z åˆ†é‡è¡¨ç¤ºä»å…‰åˆ°åƒç´ çš„è·ç¦»ï¼›</li>
<li>(x, y) åˆ†é‡ç”¨äºæ£€ç´¢å­˜å‚¨åœ¨é˜´å½±çº¹ç†ï¼ˆ2Dï¼‰ä¸­çš„æ·±åº¦ä¿¡æ¯ã€‚</li>
</ul>
</li>
<li>å°†è¯¥æ£€ç´¢çš„å€¼ï¼ˆåˆ°æœ€é è¿‘å…‰çš„ç‰©ä½“çš„è·ç¦»ï¼‰ä¸ z è¿›è¡Œæ¯”è¾ƒã€‚</li>
</ol>
<p>ä¾‹å­æ•ˆæœå±•ç¤ºå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_shadow.jpg" alt="å…‰ä»å·¦å¾€å³å‘å‡º"></p>
<p>ä»£ç ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

const int numVAO = 1, numVBO = 5;
GLuint vao[numVAO], vbo[numVBO];

GLuint renderProgram1, renderProgram2;

int width, height;
float aspect;

GLuint mvLoc, projLoc, nLoc, sLoc;
GLuint textureID;

// å…‰æºå±æ€§
GLuint globalAmbLoc, ambLoc, diffLoc, specLoc, posLoc;
// æè´¨å±æ€§
GLuint mAmbLoc, mDifLoc, mSpecLoc, mShiLoc;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;
glm::vec3 currentLightPos, lightPosV;	// æ¨¡å‹å’Œè§†è§‰ç©ºé—´ä¸­çš„å…‰ç…§ä½ç½®
float lightPos[3];	// å…‰ç…§ä½ç½®çš„æµ®ç‚¹æ•°ç»„

// ç™½å…‰ç‰¹æ€§
float globalAmbient[4] = { 0.7f, 0.7f, 0.7f, 1.0f };
float lightAmbient[4] = { 0.0f, 0.0f, 0.0f, 1.0f };
float lightDiffuse[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightSpecular[4] = { 1.0f, 1.0f, 1.0f, 1.0f };

// æè´¨
struct Material
{
	float *ambient, *diffuse, *specular;
	float shininess;
};

Material gold{ Util::goldAmbient(), Util::goldDiffuse(), Util::goldSpecular(), Util::goldShininess() };
Material silver{ Util::silverAmbient(), Util::silverDiffuse(), Util::silverSpecular(), Util::silverShininess() };

// é˜´å½±ç›¸å…³
int scSizeX, scSizeY;
GLuint shadowTex, shadowBuffer;
glm::mat4 lightVmatrix, lightPmatrix;
glm::mat4 shadowMVP1, shadowMVP2;
glm::mat4 b;

// æ¨¡å‹ç›¸å…³
//Sphere model(48);
Torus model1(48, 0.6f, 0.4f);
// åŠ è½½çš„æ¨¡å‹è¿˜ä¸èƒ½ä½¿ç”¨ç´¢å¼•
ImportedModel model2("model/pyr.obj");

// ä½ç½®ç›¸å…³
glm::vec3 cameraLoc(0.0f, 0.0f, 6.0f);
glm::vec3 lightLoc(-3.8f, 2.2f, 1.1f);
glm::vec3 model1Loc(1.6f, 0.0f, -0.3f);
glm::vec3 model2Loc(-1.0f, 0.1f, 0.3f);

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void installLights(GLuint renderProgram, glm::mat4 vMatrix, Material &amp;m)
{
	// å°†å…‰æºä½ç½®è½¬æ¢ä¸ºè§†å›¾ç©ºé—´åæ ‡ï¼Œå­˜å…¥æµ®ç‚¹æ•°ç»„
	lightPosV = glm::vec3(vMatrix * glm::vec4(currentLightPos, 1.0));
	lightPos[0] = lightPosV.x;
	lightPos[1] = lightPosV.y;
	lightPos[2] = lightPosV.z;

	// åœ¨ç€è‰²å™¨è·å–å…‰æºä½ç½®å’Œæè´¨å±æ€§
	globalAmbLoc = glGetUniformLocation(renderProgram, "globalAmbient");
	ambLoc = glGetUniformLocation(renderProgram, "light.ambient");
	diffLoc = glGetUniformLocation(renderProgram, "light.diffuse");
	specLoc = glGetUniformLocation(renderProgram, "light.specular");
	posLoc = glGetUniformLocation(renderProgram, "light.position");
	mAmbLoc = glGetUniformLocation(renderProgram, "material.ambient");
	mDifLoc = glGetUniformLocation(renderProgram, "material.diffuse");
	mSpecLoc = glGetUniformLocation(renderProgram, "material.specular");
	mShiLoc = glGetUniformLocation(renderProgram, "material.shininess");

	// åœ¨ç€è‰²å™¨ä¸­ä¸ºå…‰æºä¸æè´¨ç»Ÿä¸€å˜é‡èµ‹å€¼
	glProgramUniform4fv(renderProgram, globalAmbLoc, 1, globalAmbient);
	glProgramUniform4fv(renderProgram, ambLoc, 1, lightAmbient);
	glProgramUniform4fv(renderProgram, diffLoc, 1, lightDiffuse);
	glProgramUniform4fv(renderProgram, specLoc, 1, lightSpecular);
	glProgramUniform3fv(renderProgram, posLoc, 1, lightPos);
	glProgramUniform4fv(renderProgram, mAmbLoc, 1, m.ambient);
	glProgramUniform4fv(renderProgram, mDifLoc, 1, m.diffuse);
	glProgramUniform4fv(renderProgram, mSpecLoc, 1, m.specular);
	glProgramUniform1f(renderProgram, mShiLoc, m.shininess);
}

void makeVertexArray()
{
	// model1çš„é¡¶ç‚¹æ„å»º
	std::vector&lt;int&gt; model1Ind = model1.getIndices();
	std::vector&lt;glm::vec3&gt; vert = model1.getVertices();
	std::vector&lt;glm::vec3&gt; norm = model1.getNormals();

	std::vector&lt;float&gt; model1Pvalues;	// é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; model1Nvalues;	// æ³•å‘é‡

	for (int i = 0; i &lt; model1.getNumVertices(); ++ i)
	{
		model1Pvalues.push_back(vert[i].x);
		model1Pvalues.push_back(vert[i].y);
		model1Pvalues.push_back(vert[i].z);
		model1Nvalues.push_back(norm[i].x);
		model1Nvalues.push_back(norm[i].y);
		model1Nvalues.push_back(norm[i].z);
	}

	// model2çš„é¡¶ç‚¹æ„å»º
	vert = model2.getVertices();
	norm = model2.getNormals();

	std::vector&lt;float&gt; model2Pvalues;	// é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; model2Nvalues;	// æ³•å‘é‡

	for (int i = 0; i &lt; model2.getNumVertices(); ++ i)
	{
		model2Pvalues.push_back(vert[i].x);
		model2Pvalues.push_back(vert[i].y);
		model2Pvalues.push_back(vert[i].z);
		model2Nvalues.push_back(norm[i].x);
		model2Nvalues.push_back(norm[i].y);
		model2Nvalues.push_back(norm[i].z);
	}

	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);
	glGenBuffers(numVBO, vbo);

	// model1
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, 4 * model1Pvalues.size(), &amp;model1Pvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, 4 * model1Nvalues.size(), &amp;model1Nvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * model1Ind.size(), &amp;model1Ind[0], GL_STATIC_DRAW);

	// model2
	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glBufferData(GL_ARRAY_BUFFER, 4 * model2Pvalues.size(), &amp;model2Pvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ARRAY_BUFFER, vbo[4]);
	glBufferData(GL_ARRAY_BUFFER, 4 * model2Nvalues.size(), &amp;model2Nvalues[0], GL_STATIC_DRAW);
}

void setupShadowBuffers(GLFWwindow *window)
{
	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	scSizeX = width;
	scSizeY = height;

	// åˆ›å»ºè‡ªå®šä¹‰å¸§ç¼“å†²åŒº
	glGenFramebuffers(1, &amp;shadowBuffer);

	// åˆ›å»ºé˜´å½±çº¹ç†å¹¶è®©å®ƒå­˜å‚¨æ·±åº¦ä¿¡æ¯
	glGenTextures(1, &amp;shadowTex);
	glBindTexture(GL_TEXTURE_2D, shadowTex);
	glTexImage2D(GL_TEXTURE_2D, 0, GL_DEPTH_COMPONENT32,
		scSizeX, scSizeY, 0, GL_DEPTH_COMPONENT, GL_FLOAT, 0);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_COMPARE_MODE, GL_COMPARE_REF_TO_TEXTURE);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_COMPARE_FUNC, GL_LEQUAL);

	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
}

void init(GLFWwindow *window)
{
	renderProgram1 = Util::createShadeProgram("shadows/vertex1.glsl", "shadows/fragment1.glsl");
	renderProgram2 = Util::createShadeProgram("shadows/vertex2.glsl", "shadows/fragment2.glsl");

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();
	setupShadowBuffers(window);

	b = glm::mat4(
		0.5f, 0.0f, 0.0f, 0.0f,
		0.0f, 0.5f, 0.0f, 0.0f,
		0.0f, 0.0f, 0.5f, 0.0f,
		0.5f, 0.5f, 0.5f, 1.0f);
}

void passOne()
{
	glUseProgram(renderProgram1);

	// ç»˜åˆ¶model1
	mMat = glm::translate(glm::mat4(1.0f), model1Loc);
	mMat = glm::rotate(mMat, 25.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));

	shadowMVP1 = lightPmatrix * lightVmatrix * mMat;
	sLoc = glGetUniformLocation(renderProgram1, "shadowMVP");
	glUniformMatrix4fv(sLoc, 1, GL_FALSE, glm::value_ptr(shadowMVP1));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glClear(GL_DEPTH_BUFFER_BIT);
	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[2]);
	glDrawElements(GL_TRIANGLES, model1.getNumIndices(), GL_UNSIGNED_INT, 0);

	// ç»˜åˆ¶model2
	mMat = glm::translate(glm::mat4(1.0f), model2Loc);
	mMat = glm::rotate(mMat, 30.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));
	mMat = glm::rotate(mMat, 40.0f * 3.14159f / 180.0f, glm::vec3(0.0f, 1.0f, 0.0f));

	shadowMVP1 = lightPmatrix * lightVmatrix * mMat;
	glUniformMatrix4fv(sLoc, 1, GL_FALSE, glm::value_ptr(shadowMVP1));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);

	glDrawArrays(GL_TRIANGLES, 0, model2.getNumVertices());
}

void passTwo()
{
	glUseProgram(renderProgram2);

	mvLoc = glGetUniformLocation(renderProgram2, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram2, "proj_matrix");
	nLoc = glGetUniformLocation(renderProgram2, "norm_matrix");
	sLoc = glGetUniformLocation(renderProgram2, "shadowMVP");

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraLoc.x, -cameraLoc.y, -cameraLoc.z));

	// ç»˜åˆ¶model1
	mMat = glm::translate(glm::mat4(1.0f), model1Loc);
	mMat = glm::rotate(mMat, 25.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));

	currentLightPos = glm::vec3(lightLoc);
	installLights(renderProgram2, vMat, gold);
	mvMat = vMat * mMat;
	invTrMat = glm::transpose(glm::inverse(mvMat));
	shadowMVP2 = b * lightPmatrix * lightVmatrix * mMat;

	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
	glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));
	glUniformMatrix4fv(sLoc, 1, GL_FALSE, glm::value_ptr(shadowMVP2));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[1]);
	glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glClear(GL_DEPTH_BUFFER_BIT);
	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[2]);
	glDrawElements(GL_TRIANGLES, model1.getNumIndices(), GL_UNSIGNED_INT, 0);

	// ç»˜åˆ¶model2
	mMat = glm::translate(glm::mat4(1.0f), model2Loc);
	mMat = glm::rotate(mMat, 30.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));
	mMat = glm::rotate(mMat, 40.0f * 3.14159f / 180.0f, glm::vec3(0.0f, 1.0f, 0.0f));

	currentLightPos = glm::vec3(lightLoc);
	installLights(renderProgram2, vMat, silver);

	mvMat = vMat * mMat;
	invTrMat = glm::transpose(glm::inverse(mvMat));
	shadowMVP2 = b * lightPmatrix * lightVmatrix * mMat;

	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
	glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));
	glUniformMatrix4fv(sLoc, 1, GL_FALSE, glm::value_ptr(shadowMVP2));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[4]);
	glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);

	glDrawArrays(GL_TRIANGLES, 0, model2.getNumVertices());
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);

	currentLightPos = glm::vec3(lightLoc);
	lightVmatrix = glm::lookAt(currentLightPos, glm::vec3(0.0f, 0.0f, 0.0f), glm::vec3(0.0f, 1.0f, 0.0f));
	lightPmatrix = glm::perspective(60.0f * 3.14159f / 180.0f, aspect, 0.1f, 1000.0f);

	glBindFramebuffer(GL_FRAMEBUFFER, shadowBuffer);
	glFramebufferTexture(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, shadowTex, 0);

	glDrawBuffer(GL_NONE);
	glEnable(GL_DEPTH_TEST);
	glEnable(GL_POLYGON_OFFSET_FILL);
	glPolygonOffset(2.0f, 4.0f);

	passOne();

	glDisable(GL_POLYGON_OFFSET_FILL);

	glBindFramebuffer(GL_FRAMEBUFFER, 0);
	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, shadowTex);

	glDrawBuffer(GL_FRONT);

	passTwo();
}

int main()
{
	if (!glfwInit())	exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Light", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)	exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>ç¬¬ä¸€è½®çš„ç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex1.glsl
#version 460 core

layout(location = 0) in vec3 vertPos;

uniform mat4 shadowMVP;

void main()
{
	gl_Position = shadowMVP * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment1.glsl
#version 460 core

void main(){}
</code></pre>
</details>
<details><summary>ç¬¬äºŒè½®çš„ç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex2.glsl
#version 460

struct PositionalLight
{
	vec4 ambient, diffuse, specular;
	vec3 position;
};

struct Material
{
	vec4 ambient, diffuse, specular;
	float shininess;
};

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec3 vertNormal;

out vec3 vNormal, vLightDir, vVertPos, vHalfVec;
out vec4 shadowCoord;

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;
uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;
uniform mat4 shadowMVP;

void main()
{
	// è¾“å‡ºé¡¶ç‚¹ä½ç½®
	vVertPos = (mv_matrix * vec4(vertPos, 1.0)).xyz;
	// è·å–ä¸€ä¸ªä»é¡¶ç‚¹åˆ°å…‰çº¿çš„å‘é‡å¹¶è¾“å‡º
	vLightDir = light.position - vVertPos;
	// åœ¨è§†å›¾ç©ºé—´ä¸­è·å¾—ä¸€ä¸ªé¡¶ç‚¹æ³•å‘é‡è¾“å‡º
	vNormal = (norm_matrix * vec4(vertNormal, 0.0)).xyz;
	// è®¡ç®—é¡¶ç‚¹çš„åŠå‘é‡
	vHalfVec = (vLightDir - vVertPos).xyz;

	shadowCoord = shadowMVP * vec4(vertPos, 1.0);

	gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment2.glsl
#version 460 core

struct PositionalLight
{
	vec4 ambient, diffuse, specular;
	vec3 position;
};

struct Material
{
	vec4 ambient, diffuse, specular;
	float shininess;
};

in vec3 vNormal, vLightDir, vVertPos, vHalfVec;
in vec4 shadowCoord;
out vec4 fragColor;

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;
uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;
uniform mat4 shadowMVP;
layout(binding = 0) uniform sampler2DShadow shadowTex;

void main()
{
	vec3 L = normalize(vLightDir);
	vec3 N = normalize(vNormal);
	vec3 V = normalize(-vVertPos);
	vec3 H = normalize(vHalfVec);

	float inShadow = textureProj(shadowTex, shadowCoord);

	fragColor = globalAmbient * material.ambient + light.ambient * material.ambient;

	if (inShadow != 0.0)
	{
		fragColor +=
			light.diffuse * material.diffuse * max(dot(L, N), 0.0) +
			light.specular * material.specular * pow(max(dot(H, N), 0.0), material.shininess * 3);
	}
}
</code></pre>
</details>
<h3 id="8-4-æŸ”å’Œé˜´å½±">8.4 æŸ”å’Œé˜´å½±</h3>
<p>ä½¿ç”¨ç™¾åˆ†æ¯”ä¸´è¿‘æ»¤æ³¢ PCF ç”ŸæˆæŸ”å’Œé˜´å½±ã€‚</p>
<p>ä¸€ç§ç”¨äºå®ç° PCF çš„å¸¸è§ç®—æ³•æ˜¯ï¼š</p>
<ul>
<li>å¯¹æ¯ä¸ªåƒç´ é™„è¿‘çš„ 4 ä¸ªçº¹å…ƒï¼ˆçº¹ç†å›¾åƒåƒç´ ï¼‰è¿›è¡Œé‡‡æ ·ï¼Œå…¶ä¸­æ ·æœ¬é€šè¿‡åƒç´ å¯¹åº”çº¹å…ƒçš„ç‰¹å®šåç§»é‡é€‰æ‹©ã€‚</li>
<li>å¯¹äºæ¯ä¸ªåƒç´ ï¼Œéƒ½éœ€è¦æ”¹å˜åç§»é‡ï¼Œå¹¶ç”¨æ–°çš„åç§»é‡ç¡®å®šé‡‡æ ·çš„ 4 ä¸ªçº¹å…ƒã€‚</li>
<li>ä½¿ç”¨äº¤é”™çš„æ–¹å¼æ”¹å˜åç§»é‡çš„æ–¹æ³•è¢«ç§°ä¸ºæŠ–åŠ¨ï¼Œå®ƒæ—¨åœ¨ä½¿æŸ”å’Œé˜´å½±çš„è¾¹ç•Œä¸ä¼šç”±äºé‡‡æ ·ç‚¹ä¸è¶³è€Œçœ‹èµ·æ¥â€œç»“å—â€ã€‚</li>
</ul>
<p>å‡è®¾æœ‰4ç§åç§»æ¨¡å¼ï¼Œæ¯æ¬¡å–ä¸€ç§è®¡ç®—åƒç´  <code>glFragCorrd mod 2</code> å€¼é€‰æ‹©å½“å‰åç§»ï¼Œç»“æœå¯èƒ½ä¸ºï¼š(0,0)ã€(1,0)ã€(0,1)ã€(1,1)ã€‚</p>
<p>åç§»æ¨¡å¼é€šå¸¸åœ¨ x å’Œ y æ–¹å‘ä¸ŠæŒ‡å®šï¼Œå…·æœ‰-1.5ã€-0.5ã€+0.5å’Œ+1.5ä¸åŒç»„åˆï¼š</p>
<p>4ç§è®¡ç®—ç»“æœå¯¹åº”çš„åç§»æ¨¡å¼é‡‡æ ·ç‚¹å¦‚ä¸‹è¡¨</p>
<table>
<thead>
<tr>
<th style="text-align:center">è®¡ç®—ç»“æœ</th>
<th style="text-align:center">(0,0)</th>
<th style="text-align:center">(0,1)</th>
<th style="text-align:center">(1,0)</th>
<th style="text-align:center">(1,1)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-1.5,s_y+1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-1.5,s_y+0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-0.5,s_y+1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-0.5,s_y+0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-1.5,s_y-0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-1.5,s_y-1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-0.5,s_y-0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x-0.5,s_y-1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+0.5,s_y+1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+0.5,s_y+0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+1.5,s_y+1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>+</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+1.5,s_y+0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+0.5,s_y-0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>0.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+0.5,s_y-1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+1.5,s_y-0.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>x</mi></msub><mo>+</mo><mn>1.5</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>1.5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_x+1.5,s_y-1.5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></td>
</tr>
</tbody>
</table>
<p>å‡è®¾éšä¾¿ä¸€ç»„ï¼Œå¯¹å…¶4ä¸ªé‡‡æ ·ç‚¹åˆ†åˆ«è°ƒç”¨ <code>textureProj()</code>ï¼Œå°†å¾—åˆ°çš„4ä¸ªç»“æœç›¸åŠ æ±‚å¹³å‡ï¼Œç¡®å®šé˜´å½±ä¸­é‡‡æ ·ç‚¹çš„ç™¾åˆ†æ¯”ï¼Œä»¥æ­¤ç™¾åˆ†æ¯”ä½œç³»æ•°ï¼Œç¡®å®šæ¸²æŸ“å½“å‰åƒç´ æ—¶è¦åº”ç”¨çš„æ¼«åå°„å’Œé•œé¢åå°„åˆ†é‡ã€‚</p>
<p>é‡‡æ ·ç‚¹å¯ä»¥æœ‰å¤šä¸ªï¼Œä½†æ¸²æŸ“é€Ÿåº¦ä¹Ÿä¼šéšä¹‹ä¸‹é™ã€‚</p>
<p>64ä¸ªé‡‡æ ·ç‚¹æŸ”å’Œé˜´å½±æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_softShadows.jpg" alt="æŸ”å’Œé˜´å½±"></p>
<p>ä»…éœ€ä¿®æ”¹ç¬¬äºŒè½®çš„ç‰‡æ®µç€è‰²å™¨ï¼š</p>
<details><summary>fragment2.glsl</summary>
<pre><code class="language-glsl">#version 460 core

struct PositionalLight
{
	vec4 ambient, diffuse, specular;
	vec3 position;
};

struct Material
{
	vec4 ambient, diffuse, specular;
	float shininess;
};

in vec3 vNormal, vLightDir, vVertPos, vHalfVec;
in vec4 shadowCoord;
out vec4 fragColor;

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;
uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;
uniform mat4 shadowMVP;
layout(binding = 0) uniform sampler2DShadow shadowTex;

float lookup(float ox, float oy)
{
	float t = textureProj(shadowTex,
		shadowCoord + vec4(ox * 0.001 * shadowCoord.w, oy * 0.001 * shadowCoord.w,
			-0.01, 0.0));
	return t;
}

void main()
{
	float shadowFactor = 0.0;
	vec3 L = normalize(vLightDir);
	vec3 N = normalize(vNormal);
	vec3 V = normalize(-vVertPos);
	vec3 H = normalize(vHalfVec);

	float swidth = 2.5;	// å¯è°ƒæ•´çš„é˜´å½±æ‰©æ•£é‡
	// 64 ä¸ªé‡‡æ ·ç‚¹
	float endp = swidth * 3.0 + swidth / 2.0;
	for (float m = -endp; m &lt;= endp; m += swidth)
		for (float n = -endp; n &lt;= endp; n += swidth)
			shadowFactor += lookup(m, n);

	shadowFactor /= 64.0;

	vec4 shadowColor = globalAmbient * material.ambient + light.ambient * material.ambient;
	vec4 lightedColor = light.diffuse * material.diffuse * max(dot(L, N), 0.0) +
		light.specular * material.specular *
		pow(max(dot(H, N), 0.0), material.shininess * 3.0);

	fragColor = vec4((shadowColor.xyz + shadowFactor * (lightedColor.xyz)), 1.0);
}
</code></pre>
</details>
<p>æœ‰äº›æ—¶å€™ï¼Œåœ¨åœºæ™¯ä¸­çš„æŸäº›å¯¹è±¡æ‹¥æœ‰çº¹ç†æ—¶ï¼Œæ·»åŠ é˜´å½±æ—¶å¿…é¡»ç¡®ä¿ç‰‡æ®µç€è‰²å™¨æ­£ç¡®åŒºåˆ†é˜´å½±çº¹ç†å’Œå…¶ä»–çº¹ç†ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯å°†å®ƒä»¬ç»‘å®šåˆ°ä¸åŒçš„çº¹ç†å•å…ƒï¼š</p>
<pre><code class="language-glsl">layout(binding = 0) uniform sampler2DShadow shadowTex;
layout(binding = 1) uniform sampler2D tex;
</code></pre>
<p>ç„¶åé€šè¿‡ç»‘å®šå€¼å¼•ç”¨ä¸¤ä¸ªé‡‡æ ·å™¨ã€‚</p>
<p>å½“åœºæ™¯ä½¿ç”¨å¤šä¸ªç¯å…‰æ—¶ï¼Œåˆ™éœ€è¦å¤šä¸ªé˜´å½±çº¹ç†ï¼Œå³æ¯ä¸ªå…‰æºéœ€è¦ä¸€ä¸ªé˜´å½±çº¹ç†ã€‚</p>
<ul>
<li>æ¯ä¸ªå…‰æºéƒ½éœ€è¦å•ç‹¬æ‰§è¡Œç¬¬ 1 è½®æ¸²æŸ“ï¼Œå¹¶åœ¨ç¬¬ 2 è½®æ¸²æŸ“ä¸­åˆå¹¶ç»“æœã€‚</li>
</ul>
<h2 id="ä¹-å¤©ç©ºå’ŒèƒŒæ™¯">ä¹ã€å¤©ç©ºå’ŒèƒŒæ™¯</h2>
<h3 id="9-1-å¤©ç©ºç›’">9.1 å¤©ç©ºç›’</h3>
<p>å¤©ç©ºç›’ï¼š</p>
<ol>
<li>å®ä¾‹åŒ–ä¸€ä¸ªç«‹æ–¹ä½“å¯¹è±¡</li>
<li>å°†ç«‹æ–¹ä½“çš„çº¹ç†è®¾ç½®ä¸ºæ‰€éœ€çš„ç¯å¢ƒ</li>
<li>å°†ç«‹æ–¹ä½“å›´ç»•ç›¸æœºè®¾ç½®</li>
</ol>
<p>å¦‚ä½•ä¸ºåœ°å¹³çº¿åˆ¶ä½œçº¹ç†ï¼š</p>
<ul>
<li>ä½¿ç”¨ä¸€ä¸ªåŒ…å«6ä¸ªé¢çš„çº¹ç†å›¾åƒã€‚</li>
<li>å¯ä½¿ç”¨ Terragenã€Blenderã€PSç­‰è½¯ä»¶å·¥å…·è¾…åŠ©æ„å»ºè´´å›¾å›¾åƒã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_cubeTexCoord.png" alt="ç«‹æ–¹ä½“è´´å›¾çº¹ç†åæ ‡"></p>
<p>å¦‚ä½•è®©å¤©ç©ºç›’çœ‹èµ·æ¥è·ç¦»å¾ˆè¿œï¼š</p>
<ul>
<li>ç¡®ä¿çº¹ç†è¡¨ç°çœ‹èµ·æ¥åƒè¿œå¤„çš„åœ°å¹³çº¿ã€‚</li>
<li>ç¦ç”¨æ·±åº¦æµ‹è¯•å¹¶å…ˆæ¸²æŸ“å¤©ç©ºç›’ï¼Œç„¶åå¯ç”¨æ·±åº¦æµ‹è¯•å†æ¸²æŸ“å…¶ä»–å¯¹è±¡ã€‚
<ul>
<li>æ·±åº¦ç¼“å†²åŒºçš„å€¼ä»å…¨è®¾ä¸º1.0ï¼ˆæœ€è¿œè·ç¦»ï¼‰ã€‚</li>
</ul>
</li>
<li>ä½¿å¤©ç©ºç›’éšç€ç›¸æœºç§»åŠ¨ã€‚</li>
</ul>
<h3 id="9-2-ç©¹é¡¶">9.2 ç©¹é¡¶</h3>
<p>ä¸å¤©ç©ºç›’ç±»ä¼¼ï¼Œä¸è¿‡ä½¿ç”¨å¸¦çº¹ç†çš„çƒä½“æˆ–åŠçƒä½“ä»£æ›¿å¸¦çº¹ç†çš„ç«‹æ–¹ä½“ã€‚</p>
<p>ä¸€æ ·éœ€è¦å…ˆç¦ç”¨æ·±åº¦æµ‹è¯•æ¸²æŸ“ç©¹é¡¶ï¼Œå†å°†ç›¸æœºç½®äºç©¹é¡¶çš„ä¸­å¿ƒä½ç½®ã€‚</p>
<p>ç©¹é¡¶ç›¸æ¯”å¤©ç©ºç›’ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šä¸æ˜“å—åˆ°ç•¸å˜å’Œæ¥ç¼çš„å½±å“ï¼ˆå°½ç®¡åœ¨çº¹ç†å›¾åƒ<br>
ä¸­å¿…é¡»è€ƒè™‘æç‚¹å¤„çš„çƒå½¢ç•¸å˜ï¼‰ã€‚</li>
<li>ç¼ºç‚¹ï¼šçƒä½“æˆ–ç©¹é¡¶æ¨¡å‹æ¯”ç«‹æ–¹ä½“æ¨¡å‹æ›´å¤æ‚ï¼Œç©¹é¡¶æœ‰æ›´å¤šçš„é¡¶ç‚¹ï¼Œå…¶æ•°é‡å–å†³äºæœŸæœ›çš„ç²¾åº¦ã€‚</li>
</ul>
<h3 id="9-3-å®ç°å¤©ç©ºç›’">9.3 å®ç°å¤©ç©ºç›’</h3>
<h4 id="9-3-1-ä»å¤´å¼€å§‹æ„å»ºå¤©ç©ºç›’">9.3.1 ä»å¤´å¼€å§‹æ„å»ºå¤©ç©ºç›’</h4>
<p>æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_skybox.jpg" alt="å¤©ç©ºç›’"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

const int numVAO = 1, numVBO = 5;
GLuint vao[numVAO], vbo[numVBO];

GLuint renderProgram;

int width, height;
float aspect;

GLuint mvLoc, projLoc;
GLuint textureID, skyboxTex;

glm::mat4 pMat, vMat, mMat, mvMat;

// æ¨¡å‹ç›¸å…³
//Sphere model(48);
Torus model(48, 0.5f, 0.2f);
// åŠ è½½çš„æ¨¡å‹è¿˜ä¸èƒ½ä½¿ç”¨ç´¢å¼•
//ImportedModel model2("model/pyr.obj");

// ä½ç½®ç›¸å…³
glm::vec3 cameraLoc(0.0f, 0.0f, 5.0f);
glm::vec3 modelLoc(0.0f, -0.75, 0.0f);

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
	// ç«‹æ–¹ä½“å¤©ç©ºç›’
	float cubeVertexPositions[108] =
	{
		-1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
		-1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
		 1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
	};
	float cubeTextureCoord[72] =
	{
		1.00f, 0.666666f, 1.00f, 0.333333f, 0.75f, 0.333333f,
		0.75f, 0.333333f, 0.75f, 0.666666f, 1.00f, 0.666666f,
		0.75f, 0.333333f, 0.50f, 0.333333f, 0.75f, 0.666666f,
		0.50f, 0.333333f, 0.50f, 0.666666f, 0.75f, 0.666666f,
		0.50f, 0.333333f, 0.25f, 0.333333f, 0.50f, 0.666666f,
		0.25f, 0.333333f, 0.25f, 0.666666f, 0.50f, 0.666666f,
		0.25f, 0.333333f, 0.00f, 0.333333f, 0.25f, 0.666666f,
		0.00f, 0.333333f, 0.00f, 0.666666f, 0.25f, 0.666666f,
		0.25f, 0.333333f, 0.50f, 0.333333f, 0.50f, 0.000000f,
		0.50f, 0.000000f, 0.25f, 0.000000f, 0.25f, 0.333333f,
		0.25f, 1.000000f, 0.50f, 1.000000f, 0.50f, 0.666666f,
		0.50f, 0.666666f, 0.25f, 0.666666f, 0.25f, 1.000000f,
	};

	std::vector&lt;int&gt; modelInd = model.getIndices();
	std::vector&lt;glm::vec3&gt; vert = model.getVertices();
	std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
	std::vector&lt;glm::vec3&gt; norm = model.getNormals();

	std::vector&lt;float&gt; modelPvalues;	// é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; modelTvalues;	// çº¹ç†åæ ‡
	std::vector&lt;float&gt; modelNvalues;	// æ³•å‘é‡

	for (int i = 0; i &lt; model.getNumVertices(); ++ i)
	{
		modelPvalues.push_back(vert[i].x);
		modelPvalues.push_back(vert[i].y);
		modelPvalues.push_back(vert[i].z);
		modelTvalues.push_back(tex[i].s);
		modelTvalues.push_back(tex[i].t);
		modelNvalues.push_back(norm[i].x);
		modelNvalues.push_back(norm[i].y);
		modelNvalues.push_back(norm[i].z);
	}
	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);
	glGenBuffers(numVBO, vbo);

	// å¤©ç©ºç›’
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, sizeof(cubeVertexPositions), cubeVertexPositions, GL_STATIC_DRAW);
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, sizeof(cubeTextureCoord), cubeTextureCoord, GL_STATIC_DRAW);
	// model
	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ARRAY_BUFFER, 4 * modelPvalues.size(), &amp;modelPvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glBufferData(GL_ARRAY_BUFFER, 4 * modelTvalues.size(), &amp;modelTvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[4]);
	glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * modelInd.size(), &amp;modelInd[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
	renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();
	textureID = Util::loadTexture("textureImg/brick1.jpg");
	skyboxTex = Util::loadTexture("textureImg/alien.jpg");

	glBindTexture(GL_TEXTURE_2D, textureID);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraLoc.x, -cameraLoc.y, -cameraLoc.z));

	// å¤©ç©ºç›’
	glUseProgram(renderProgram);
	// å‡†å¤‡ç»˜åˆ¶å¤©ç©ºç›’ã€‚æ¨¡å‹çŸ©é˜µå°†å¤©ç©ºç›’æ”¾ç½®åœ¨ç›¸æœºä½ç½®
	mMat = glm::translate(glm::mat4(1.0f), cameraLoc);
	mvMat = vMat * mMat;

	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, skyboxTex);

	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);    // è§‚å¯Ÿç«‹æ–¹ä½“å†…éƒ¨ï¼Œåè½¬æ–¹å‘
	glDisable(GL_DEPTH_TEST);
	// æ— æ·±åº¦æµ‹è¯•ä¸‹ç»˜åˆ¶å¤©ç©ºç›’
	glDrawArrays(GL_TRIANGLES, 0, 36);
	glEnable(GL_DEPTH_TEST);

	// ç»˜åˆ¶åœºæ™¯å¯¹è±¡
	glUseProgram(renderProgram);
	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

	mMat = glm::translate(glm::mat4(1.0f), modelLoc);
	mMat = glm::rotate(mMat, glm::radians(15.0f), glm::vec3(1.0f, 0.0f, 0.0f));
	mvMat = vMat * mMat;

	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, textureID);

	glClear(GL_DEPTH_BUFFER_BIT);
	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glDepthFunc(GL_LEQUAL);
	glDrawArrays(GL_TRIANGLES, 0, 36);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[4]);
	glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
	if (!glfwInit())	exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Skybox", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)	exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec2 texCoord;
out vec2 tc;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

void main()
{
	tc = texCoord;
	gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment.glsl
#version 460 core

in vec2 tc;
out vec4 fragColor;

layout(binding = 0) uniform sampler2D s;

void main()
{
	fragColor = texture(s, tc);
}
</code></pre>
</details>
<h4 id="9-3-2-ä½¿ç”¨openglç«‹æ–¹ä½“è´´å›¾">9.3.2 ä½¿ç”¨OpenGLç«‹æ–¹ä½“è´´å›¾</h4>
<p>OpenGL çº¹ç†ç«‹æ–¹ä½“è´´å›¾ä½¿ç”¨å¸¦æœ‰ 3 ä¸ªå˜é‡çš„çº¹ç†åæ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s, t, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> è®¿é—®ã€‚</p>
<p>ç«‹æ–¹ä½“è´´å›¾çš„å¦ä¸€ä¸ªç‰¹æ€§æ˜¯ï¼Œå…¶ä¸­çš„å›¾åƒä»¥çº¹ç†å›¾åƒçš„å·¦ä¸Šè§’ä½œä¸ºçº¹ç†åæ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ã€‚</p>
<p>å¦å¤–å®šä¹‰å‡½æ•° <code>loadCubeMap()</code> å‡½æ•°è¯»å…¥6ä¸ªå•ç‹¬çš„ç«‹æ–¹ä½“é¢å›¾åƒæ–‡ä»¶ï¼Œä»¥è¿™ç§å½¢å¼å†è°ƒç”¨ <code>SOIL_load_OGL_cubemap()</code> è¿›è¡Œæ„å»ºçº¹ç†ã€‚è¯¥å‡½æ•°ç½®äº <code>Util</code> ç±»ä¸­ã€‚</p>
<p>æ•ˆæœæˆªå›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_skybox2.jpg" alt="å¤©ç©ºç›’"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>æ–°å¢å‡½æ•°</summary>
<pre><code class="language-cpp">GLuint Util::loadCubeMap(const std::string &amp;mapDirPath)
{
	GLuint textureRef;
	std::string xp = mapDirPath + "/xp.jpg";
	std::string xn = mapDirPath + "/xn.jpg";
	std::string yp = mapDirPath + "/yp.jpg";
	std::string yn = mapDirPath + "/yn.jpg";
	std::string zp = mapDirPath + "/zp.jpg";
	std::string zn = mapDirPath + "/zn.jpg";
	textureRef = SOIL_load_OGL_cubemap(xp.c_str(), xn.c_str(), yp.c_str(), yn.c_str(), zp.c_str(), zn.c_str(), SOIL_LOAD_AUTO, SOIL_CREATE_NEW_ID, SOIL_FLAG_MIPMAPS);
	if (textureRef == 0)	std::cout &lt;&lt; "Failed to load texture: " &lt;&lt; mapDirPath &lt;&lt; "\n";
	return textureRef;
}
</code></pre>
</details>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

GLuint renderProgram, renderProgramCubeMap;

int width, height;
float aspect;

GLuint mvLoc, projLoc, vLoc;
GLuint textureID, skyboxTex;

glm::mat4 pMat, vMat, mMat, mvMat;

// æ¨¡å‹ç›¸å…³
//Sphere model(48);
Torus model(48, 0.8f, 0.4f);
// åŠ è½½çš„æ¨¡å‹è¿˜ä¸èƒ½ä½¿ç”¨ç´¢å¼•
//ImportedModel model2("model/pyr.obj");

// ä½ç½®ç›¸å…³
glm::vec3 cameraLoc(0.0f, 0.0f, 5.0f);
glm::vec3 modelLoc(0.0f, 0.0f, 0.0f);

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
	// ç«‹æ–¹ä½“å¤©ç©ºç›’
	float cubeVertexPositions[108] =
	{
		-1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
		-1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
		 1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
	};

	std::vector&lt;int&gt; modelInd = model.getIndices();
	std::vector&lt;glm::vec3&gt; vert = model.getVertices();
	std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
	std::vector&lt;glm::vec3&gt; norm = model.getNormals();

	std::vector&lt;float&gt; modelPvalues;	// é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; modelTvalues;	// çº¹ç†åæ ‡
	std::vector&lt;float&gt; modelNvalues;	// æ³•å‘é‡

	for (int i = 0; i &lt; model.getNumVertices(); ++ i)
	{
		modelPvalues.push_back(vert[i].x);
		modelPvalues.push_back(vert[i].y);
		modelPvalues.push_back(vert[i].z);
		modelTvalues.push_back(tex[i].s);
		modelTvalues.push_back(tex[i].t);
		modelNvalues.push_back(norm[i].x);
		modelNvalues.push_back(norm[i].y);
		modelNvalues.push_back(norm[i].z);
	}
	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);
	glGenBuffers(numVBO, vbo);

	// å¤©ç©ºç›’
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, sizeof(cubeVertexPositions), cubeVertexPositions, GL_STATIC_DRAW);
	// model
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, 4 * modelPvalues.size(), &amp;modelPvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ARRAY_BUFFER, 4 * modelTvalues.size(), &amp;modelTvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
	glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * modelInd.size(), &amp;modelInd[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
	renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
	renderProgramCubeMap = Util::createShadeProgram("vertexCubeMap.glsl", "fragmentCubeMap.glsl");

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();
	textureID = Util::loadTexture("textureImg/brick1.jpg");
	skyboxTex = Util::loadCubeMap("textureImg/cubeMap");
    // å°è¯•æ··åˆç«‹æ–¹ä½“ç›¸é‚»çš„è¾¹ä»¥å‡å°‘æˆ–æ¶ˆé™¤æ¥ç¼
	glEnable(GL_TEXTURE_CUBE_MAP_SEAMLESS);

	glBindTexture(GL_TEXTURE_2D, textureID);
	glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraLoc.x, -cameraLoc.y, -cameraLoc.z));

	// å¤©ç©ºç›’
	glUseProgram(renderProgramCubeMap);
	// å‡†å¤‡ç»˜åˆ¶å¤©ç©ºç›’ã€‚æ¨¡å‹çŸ©é˜µå°†å¤©ç©ºç›’æ”¾ç½®åœ¨ç›¸æœºä½ç½®

	vLoc = glGetUniformLocation(renderProgramCubeMap, "v_matrix");
	glUniformMatrix4fv(vLoc, 1, GL_FALSE, glm::value_ptr(vMat));

	projLoc = glGetUniformLocation(renderProgramCubeMap, "p_matrix");
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_CUBE_MAP, skyboxTex);

	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glDisable(GL_DEPTH_TEST);
	// æ— æ·±åº¦æµ‹è¯•ä¸‹ç»˜åˆ¶å¤©ç©ºç›’
	glDrawArrays(GL_TRIANGLES, 0, 36);
	glEnable(GL_DEPTH_TEST);

	// ç»˜åˆ¶åœºæ™¯å¯¹è±¡
	glUseProgram(renderProgram);
	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");

	mMat = glm::translate(glm::mat4(1.0f), modelLoc);
	mMat = glm::rotate(mMat, glm::radians(35.0f), glm::vec3(1.0f, 0.0f, 0.0f));
	mvMat = vMat * mMat;

	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, textureID);

	glClear(GL_DEPTH_BUFFER_BIT);
	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glDepthFunc(GL_LEQUAL);
	glDrawArrays(GL_TRIANGLES, 0, 36);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
	glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
	if (!glfwInit())	exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Skybox", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)	exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>ç«‹æ–¹ä½“è´´å›¾ç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertexCubeMap.glsl
#version 460 core

layout(location = 0) in vec3 vertPos;
out vec3 tc;

uniform mat4 v_matrix;
uniform mat4 p_matrix;

void main()
{
	tc = vertPos;
	mat4 v3_matrix = mat4(mat3(v_matrix));
    // å¤§å°è½¬æ¢ä¸º 3Ã—3ï¼Œç„¶åè½¬æ¢å› 4Ã—4ã€‚ç§»é™¤äº†å¹³ç§»åˆ†é‡ï¼ŒåŒæ—¶ä¿ç•™äº†æ—‹è½¬ï¼ˆå¹³ç§»å€¼åœ¨è½¬æ¢çŸ©é˜µçš„ç¬¬å››åˆ—ä¸­ï¼‰
	gl_Position = p_matrix * v3_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragmentCubeMap.glsl
#version 460 core

in vec3 tc;
out vec4 fragColor;

layout(binding = 0) uniform samplerCube samp;

void main()
{
	fragColor = texture(samp, tc);
}
</code></pre>
</details>
<details><summary>æç»˜åœºæ™¯çš„ç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec2 texCoord;
out vec2 tc;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

void main()
{
	tc = texCoord;
	gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment.glsl
#version 460 core

in vec2 tc;
out vec4 fragColor;

layout(binding = 0) uniform sampler2D s;

void main()
{
	fragColor = texture(s, tc);
}
</code></pre>
</details>
<h3 id="9-4-ç¯å¢ƒè´´å›¾">9.4 ç¯å¢ƒè´´å›¾</h3>
<p>ç¯å¢ƒè´´å›¾ï¼šä½¿ç”¨ç«‹æ–¹ä½“è´´å›¾æ¥æ„é€ åå°„å¯¹è±¡æœ¬èº«ã€‚</p>
<ul>
<li>åœ¨å…‰ç…§æ—¶è®¡ç®—è¿‡åå°„å‘é‡ï¼Œç°åœ¨ä½¿ç”¨åå°„å‘é‡ä»çº¹ç†è´´å›¾ä¸­æŸ¥æ‰¾å€¼ã€‚</li>
</ul>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_envmap.gif" alt="ç¯å¢ƒè´´å›¾ä¾‹å­"></p>
<p>ä»ç„¶éœ€è¦ä¸¤ç»„ç€è‰²å™¨ï¼Œä¸€ç»„ç”¨äºç«‹æ–¹ä½“è´´å›¾ï¼Œä¸€ç»„ç”¨äºåœºæ™¯ç‰©ä½“ï¼ˆç¯é¢ï¼‰ã€‚</p>
<p>ç¨‹åºä¸Šï¼š</p>
<ul>
<li><code>makeVertexArray()</code> å‡½æ•°ä¸­ï¼š
<ul>
<li>æ„å»ºç¯é¢çš„æ³•å‘é‡ç¼“å†²åŒº</li>
<li>å»æ‰ç¯é¢çš„çº¹ç†åæ ‡ç¼“å†²åŒº</li>
</ul>
</li>
<li><code>display()</code> å‡½æ•°ä¸­ï¼š
<ul>
<li>åˆ›å»ºå˜æ¢æ³•å‘é‡çš„çŸ©é˜µå¹¶å…³è”åˆ°ç»Ÿä¸€å˜é‡</li>
<li>æ¿€æ´»ç¯é¢æ³•å‘é‡ç¼“å†²åŒº</li>
<li>æ¿€æ´»ç«‹æ–¹ä½“è´´å›¾ä¸ºç¯é¢çš„çº¹ç†</li>
</ul>
</li>
<li>é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼š
<ul>
<li>è¾“å‡ºå˜æ¢çš„é¡¶ç‚¹å’Œæ³•å‘é‡ï¼Œç”¨äºè®¡ç®—åå°„å‘é‡</li>
</ul>
</li>
<li>ç‰‡æ®µç€è‰²å™¨ä¸­ï¼š
<ul>
<li>è®¡ç®—åå°„å‘é‡</li>
<li>ä»ç«‹æ–¹ä½“è´´å›¾ä½¿ç”¨åå°„å‘é‡æ£€ç´¢è¾“å‡ºé¢œè‰²</li>
</ul>
</li>
</ul>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

GLuint renderProgram, renderProgramCubeMap;

int width, height;
float aspect;

GLuint mvLoc, projLoc, vLoc, nLoc;
GLuint skyboxTex;

float rotAmt;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;

// æ¨¡å‹ç›¸å…³
//Sphere model(48);
Torus model(48, 0.8f, 0.4f);
// åŠ è½½çš„æ¨¡å‹è¿˜ä¸èƒ½ä½¿ç”¨ç´¢å¼•
//ImportedModel model2("model/pyr.obj");

// ä½ç½®ç›¸å…³
glm::vec3 cameraLoc(0.0f, 0.0f, 5.0f);
glm::vec3 modelLoc(0.0f, 0.0f, 0.0f);

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void makeVertexArray()
{
	// ç«‹æ–¹ä½“å¤©ç©ºç›’
	float cubeVertexPositions[108] =
	{
		-1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f, -1.0f,
		 1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f, -1.0f, -1.0f,  1.0f, -1.0f, -1.0f,  1.0f,  1.0f,
		-1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f, -1.0f,
		 1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f, -1.0f,  1.0f,
		-1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f,  1.0f,
		 1.0f,  1.0f,  1.0f, -1.0f,  1.0f,  1.0f, -1.0f,  1.0f, -1.0f
	};

	std::vector&lt;int&gt; modelInd = model.getIndices();
	std::vector&lt;glm::vec3&gt; vert = model.getVertices();
	std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
	std::vector&lt;glm::vec3&gt; norm = model.getNormals();

	std::vector&lt;float&gt; modelPvalues;	// é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; modelTvalues;	// çº¹ç†åæ ‡
	std::vector&lt;float&gt; modelNvalues;	// æ³•å‘é‡

	for (int i = 0; i &lt; model.getNumVertices(); ++ i)
	{
		modelPvalues.push_back(vert[i].x);
		modelPvalues.push_back(vert[i].y);
		modelPvalues.push_back(vert[i].z);
		modelTvalues.push_back(tex[i].s);
		modelTvalues.push_back(tex[i].t);
		modelNvalues.push_back(norm[i].x);
		modelNvalues.push_back(norm[i].y);
		modelNvalues.push_back(norm[i].z);
	}
	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);
	glGenBuffers(numVBO, vbo);

	// å¤©ç©ºç›’
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, sizeof(cubeVertexPositions), cubeVertexPositions, GL_STATIC_DRAW);
	// model
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, 4 * modelPvalues.size(), &amp;modelPvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ARRAY_BUFFER, 4 * modelTvalues.size(), &amp;modelTvalues[0], GL_STATIC_DRAW);
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
	glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * modelInd.size(), &amp;modelInd[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
	renderProgram = Util::createShadeProgram("vertex.glsl", "fragment.glsl");
	renderProgramCubeMap = Util::createShadeProgram("vertexCubeMap.glsl", "fragmentCubeMap.glsl");

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();
	skyboxTex = Util::loadCubeMap("textureImg/lakeCubeMap");
	glEnable(GL_TEXTURE_CUBE_MAP_SEAMLESS);
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraLoc.x, -cameraLoc.y, -cameraLoc.z));

	// å¤©ç©ºç›’
	glUseProgram(renderProgramCubeMap);
	// å‡†å¤‡ç»˜åˆ¶å¤©ç©ºç›’ã€‚æ¨¡å‹çŸ©é˜µå°†å¤©ç©ºç›’æ”¾ç½®åœ¨ç›¸æœºä½ç½®

	vLoc = glGetUniformLocation(renderProgramCubeMap, "v_matrix");
	glUniformMatrix4fv(vLoc, 1, GL_FALSE, glm::value_ptr(vMat));

	projLoc = glGetUniformLocation(renderProgramCubeMap, "p_matrix");
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_CUBE_MAP, skyboxTex);

	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glDisable(GL_DEPTH_TEST);
	// æ— æ·±åº¦æµ‹è¯•ä¸‹ç»˜åˆ¶å¤©ç©ºç›’
	glDrawArrays(GL_TRIANGLES, 0, 36);
	glEnable(GL_DEPTH_TEST);

	// ç»˜åˆ¶åœºæ™¯å¯¹è±¡
	glUseProgram(renderProgram);
	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
	nLoc = glGetUniformLocation(renderProgram, "norm_matrix");

	rotAmt = currentTime * 0.5f;
	mMat = glm::translate(glm::mat4(1.0f), modelLoc);
	mMat = glm::rotate(mMat, rotAmt, glm::vec3(1.0f, 0.0f, 0.0f));
	mvMat = vMat * mMat;
	invTrMat = glm::transpose(glm::inverse(mvMat));

	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
	glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	// ç¯é¢çº¹ç†ç°åœ¨æ˜¯ç«‹æ–¹ä½“è´´å›¾
	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_CUBE_MAP, skyboxTex);

	glClear(GL_DEPTH_BUFFER_BIT);
	glEnable(GL_CULL_FACE);
	glFrontFace(GL_CCW);
	glDepthFunc(GL_LEQUAL);

	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
	glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
	if (!glfwInit())	exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Skybox", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)	exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>æç»˜åœºæ™¯çš„ç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex.glsl
#version 460 core

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec3 normal;
out vec3 vNormal;
out vec3 vVertPos;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;

void main()
{
	vVertPos = (mv_matrix * vec4(vertPos, 1.0)).xyz;
	vNormal = (norm_matrix * vec4(normal, 0.0)).xyz;
	gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment.glsl
#version 460 core

in vec3 vVertPos;
in vec3 vNormal;
out vec4 fragColor;

layout(binding = 0) uniform samplerCube t;

void main()
{
	vec3 r = -reflect(normalize(-vVertPos), normalize(vNormal));
	fragColor = texture(t, r);
}
</code></pre>
</details>
<p>ç¯å¢ƒè´´å›¾çš„ä¸»è¦é™åˆ¶ä¹‹ä¸€æ˜¯å®ƒåªèƒ½æ„å»ºåå°„ç«‹æ–¹ä½“è´´å›¾å†…å®¹çš„å¯¹è±¡ã€‚</p>
<ul>
<li>åœ¨åœºæ™¯ä¸­æ¸²æŸ“çš„å…¶ä»–å¯¹è±¡å¹¶ä¸ä¼šå‡ºç°åœ¨ä½¿ç”¨è´´å›¾æ¨¡æ‹Ÿåå°„çš„å¯¹è±¡ä¸­ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨æ¨¡æ¿ç¼“å†²åŒºæˆ–å…¶ä»–æ•™ç¨‹å®ç°åå°„å‡ºå¤šä¸ªç‰©ä½“çš„æ•ˆæœã€‚</li>
</ul>
<hr>
<p>ä½¿ç”¨ SOIL2 å¯ä»¥å¾ˆæ–¹ä¾¿åŠ è½½çº¹ç†è´´å›¾ï¼Œä½†ä¹Ÿæœ‰å…¶ä»–æ–¹æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>stb_image.h</code>ï¼š
<ul>
<li>åŒ…å«å¤´æ–‡ä»¶</li>
<li>ä½¿ç”¨ <code>glGenTextures()</code> ä¸ºç«‹æ–¹ä½“è´´å›¾åˆ›å»ºçº¹ç†åŠå…¶ ID</li>
<li>ä½¿ç”¨ <code>glBindTexture()</code> æŒ‡å®šçº¹ç† ID å’Œ <code>GL_TEXTURE_CUBE_MAP</code></li>
<li>ä½¿ç”¨ <code>stbi_load()</code> åŠ è½½çº¹ç†æ–‡ä»¶</li>
<li>ä½¿ç”¨ <code>glTexImage2D()</code> å°†å›¾åƒåˆ†é…ç»™ç«‹æ–¹ä½“çš„å„ä¸ªé¢</li>
</ul>
</li>
</ul>
<p><em>SOIL2 ä»¥åŠåŒ…å«æ–‡ä»¶ stb_image.h</em></p>
<p><em>ä¹Ÿè®¸Terragenå¯¹äºåˆ¶ä½œè´´å›¾ä¸é”™ã€‚</em></p>
<hr>
<h2 id="å-å¢å¼ºè¡¨é¢ç»†èŠ‚">åã€å¢å¼ºè¡¨é¢ç»†èŠ‚</h2>
<h3 id="10-1-å‡¹å‡¸è´´å›¾">10.1 å‡¹å‡¸è´´å›¾</h3>
<p>å¦‚æœæƒ³è®©ä¸€ä¸ªç‰©ä½“çœ‹èµ·æ¥å¥½åƒæœ‰å‡¹å‡¸ï¼Œä¸€ç§æ–¹æ³•æ˜¯è®¡ç®—è¡¨é¢ç¡®å®å‡¹å‡¸ä¸å¹³æ—¶å…¶ä¸Šçš„æ³•å‘é‡ï¼Œç„¶åæ¨¡æ‹Ÿæ³•å‘é‡ã€‚</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_disturbNorm.png" alt="æ‰°åŠ¨æ³•å‘é‡"></p>
<p>ä½¿ç”¨æ­£å¼¦å‡½æ•°ç”Ÿæˆå‡¹å‡¸ä¸å¹³çš„æ³•å‘é‡ã€‚</p>
<ul>
<li>é¡¶ç‚¹ç€è‰²å™¨éœ€è¦å°†æœªç»å˜æ¢çš„é¡¶ç‚¹ä¼ é€’ç»™ç‰‡æ®µç€è‰²å™¨</li>
</ul>
<p>æ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_bumps.jpg" alt="è¿‡ç¨‹å¼å‡¹å‡¸è´´å›¾"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 4;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint mvLoc, projLoc, nLoc;

// å…‰æºå±æ€§
GLuint globalAmbLoc, ambLoc, diffLoc, specLoc, posLoc;
// æè´¨å±æ€§
GLuint mAmbLoc, mDifLoc, mSpecLoc, mShiLoc;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;
glm::vec3 currentLightPos, lightPosV;    // æ¨¡å‹å’Œè§†è§‰ç©ºé—´ä¸­çš„å…‰ç…§ä½ç½®
float lightPos[3];    // å…‰ç…§ä½ç½®çš„æµ®ç‚¹æ•°ç»„

// åˆå§‹åŒ–å…‰ç…§ä½ç½®
glm::vec3 initialLightLoc = glm::vec3(5.0f, 2.0f, 2.0f);

// ç™½å…‰ç‰¹æ€§
float globalAmbient[4] = { 0.7f, 0.7f, 0.7f, 1.0f };
float lightAmbient[4] = { 0.0f, 0.0f, 0.0f, 1.0f };
float lightDiffuse[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightSpecular[4] = { 1.0f, 1.0f, 1.0f, 1.0f };

float *matAmb = Util::silverAmbient();
float *matDif = Util::silverDiffuse();
float *matSpe = Util::silverSpecular();
float matShi = Util::silverShininess();

//Sphere model(48);
Torus model(48, 0.5f, 0.2f);
//ImportedModel model("unicorn.obj");

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void installLights(glm::mat4 vMatrix)
{
	// å°†å…‰æºä½ç½®è½¬æ¢ä¸ºè§†å›¾ç©ºé—´åæ ‡ï¼Œå­˜å…¥æµ®ç‚¹æ•°ç»„
	lightPosV = glm::vec3(vMatrix * glm::vec4(currentLightPos, 1.0));
	lightPos[0] = lightPosV.x;
	lightPos[1] = lightPosV.y;
	lightPos[2] = lightPosV.z;

	// åœ¨ç€è‰²å™¨è·å–å…‰æºä½ç½®å’Œæè´¨å±æ€§
	globalAmbLoc = glGetUniformLocation(renderProgram, "globalAmbient");
	ambLoc = glGetUniformLocation(renderProgram, "light.ambient");
	diffLoc = glGetUniformLocation(renderProgram, "light.diffuse");
	specLoc = glGetUniformLocation(renderProgram, "light.specular");
	posLoc = glGetUniformLocation(renderProgram, "light.position");
	mAmbLoc = glGetUniformLocation(renderProgram, "material.ambient");
	mDifLoc = glGetUniformLocation(renderProgram, "material.diffuse");
	mSpecLoc = glGetUniformLocation(renderProgram, "material.specular");
	mShiLoc = glGetUniformLocation(renderProgram, "material.shininess");

	// åœ¨ç€è‰²å™¨ä¸­ä¸ºå…‰æºä¸æè´¨ç»Ÿä¸€å˜é‡èµ‹å€¼
	glProgramUniform4fv(renderProgram, globalAmbLoc, 1, globalAmbient);
	glProgramUniform4fv(renderProgram, ambLoc, 1, lightAmbient);
	glProgramUniform4fv(renderProgram, diffLoc, 1, lightDiffuse);
	glProgramUniform4fv(renderProgram, specLoc, 1, lightSpecular);
	glProgramUniform3fv(renderProgram, posLoc, 1, lightPos);
	glProgramUniform4fv(renderProgram, mAmbLoc, 1, matAmb);
	glProgramUniform4fv(renderProgram, mDifLoc, 1, matDif);
	glProgramUniform4fv(renderProgram, mSpecLoc, 1, matSpe);
	glProgramUniform1f(renderProgram, mShiLoc, matShi);
}

void makeVertexArray()
{
	std::vector&lt;int&gt; ind = model.getIndices();
	std::vector&lt;glm::vec3&gt; vert = model.getVertices();
	std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
	std::vector&lt;glm::vec3&gt; norm = model.getNormals();

	std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
	std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

	for (int i = 0; i &lt; model.getNumVertices(); ++ i)
	{
		pvalues.push_back(vert[i].x);
		pvalues.push_back(vert[i].y);
		pvalues.push_back(vert[i].z);
		tvalues.push_back(tex[i].s);
		tvalues.push_back(tex[i].t);
		nvalues.push_back(norm[i].x);
		nvalues.push_back(norm[i].y);
		nvalues.push_back(norm[i].z);
	}

	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);

	glGenBuffers(numVBO, vbo);
	// é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
	// çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
	// æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
	// é¡¶ç‚¹ç´¢å¼•æ”¾å…¥ç¼“å†²åŒº3
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
	glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * ind.size(), &amp;ind[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
	renderProgram = Util::createShadeProgram("bumpMap/vertex.glsl", "bumpMap/fragment.glsl");
	cameraX = 0.0f, cameraY = 0.0f, cameraZ = 4.0f;

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);
	glUseProgram(renderProgram);

	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
	nLoc = glGetUniformLocation(renderProgram, "norm_matrix");

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
	mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, 0.0f));
	mMat = glm::rotate(mMat, 35.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));

	// åŸºäºå½“å‰å…‰æºä½ç½®ï¼Œåˆå§‹åŒ–å…‰ç…§
	currentLightPos = glm::vec3(initialLightLoc.x, initialLightLoc.y, initialLightLoc.z);
	installLights(vMat);

	mvMat = vMat * mMat;
	// æ„å»º MV çŸ©é˜µçš„é€†è½¬ç½®çŸ©é˜µï¼Œç”¨äºå˜æ¢æ³•å‘é‡
	invTrMat = glm::transpose(glm::inverse(mvMat));

	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);
	//glDrawArrays(GL_TRIANGLES, 0, model.getNumVertices());
	// åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[3]);
	glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
	if (!glfwInit())    exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Bumps", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex.glsl
#version 460 core

struct PositionalLight
{
	vec4 ambient;
	vec4 diffuse;
	vec4 specular;
	vec3 position;
};

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec3 vertNormal;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;
uniform PositionalLight light;

out vec3 varyingNormal;
out vec3 varyingLightDir;
out vec3 varyingVertPos;
out vec3 originalVertex;

void main()
{
	varyingVertPos = (mv_matrix * vec4(vertPos, 1.0)).xyz;
	varyingLightDir = light.position - varyingVertPos;
	varyingNormal = (norm_matrix * vec4(vertNormal, 0.0)).xyz;
	originalVertex = vertPos;

	gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment.glsl
#version 460 core

struct PositionalLight
{
	vec4 ambient;
	vec4 diffuse;
	vec4 specular;
	vec3 position;
};

struct Material
{
	vec4 ambient;
	vec4 diffuse;
	vec4 specular;
	float shininess;
};

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;

in vec3 varyingNormal;
in vec3 varyingLightDir;
in vec3 varyingVertPos;
in vec3 originalVertex;

out vec4 fragColor;

void main()
{
	vec3 L = normalize(varyingLightDir);
	vec3 N = normalize(varyingNormal);
	vec3 V = normalize(-varyingVertPos);

	float a = 0.25;		// å‡¸èµ·æ·±åº¦
	float b = 100.0;	// å‡¸èµ·å®½åº¦
	float x = originalVertex.x;
	float y = originalVertex.y;
	float z = originalVertex.z;
	N.x = varyingNormal.x + a * sin(b * x);
	N.y = varyingNormal.y + a * sin(b * y);
	N.z = varyingNormal.z + a * sin(b * z);
	N = normalize(N);

	vec3 R = normalize(reflect(-L, N));

	// è®¡ç®—å…‰ç…§ä¸å¹³é¢æ³•å‘é‡é—´çš„è§’åº¦
	float cosTheta = dot(L, N);
	// è®¡ç®—æ³•å‘é‡ N ä¸è§’å¹³åˆ†çº¿å‘é‡ H ä¹‹é—´çš„è§’åº¦
	float cosPhi = dot(V, R);

	fragColor = globalAmbient * material.ambient +
		light.ambient * material.diffuse +
		light.diffuse * material.diffuse * max(cosTheta, 0.0) +
		light.specular * material.specular * pow(max(cosPhi, 0.0), material.shininess);
}
</code></pre>
</details>
<h3 id="10-2-æ³•çº¿è´´å›¾">10.2 æ³•çº¿è´´å›¾</h3>
<p>å‡¹å‡¸è´´å›¾å¯ä»¥ä½¿ç”¨æŸ¥æ‰¾è¡¨æ¥æ›¿æ¢æ³•å‘é‡çš„å½¢å¼æ›¿ä»£ã€‚</p>
<p>ä»¥æŸ¥æ‰¾è¡¨çš„æ–¹æ³•å®ç°å‡¹å‡¸ç»†èŠ‚å«ä½œæ³•çº¿è´´å›¾ã€‚</p>
<p>å¯ä»¥å°†æ³•å‘é‡å­˜å‚¨åœ¨å½©è‰²å›¾åƒæ–‡ä»¶ä¸­ï¼Œæ°å¥½ RGB ä¸‰é€šé“å¯¹åº”å‘é‡çš„ xyzã€‚</p>
<ul>
<li>RGB å€¼ä»¥å­—èŠ‚å½¢å¼å­˜å‚¨ï¼Œé€šå¸¸ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ã€‚</li>
<li>å‘é‡é™åˆ¶åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-1,+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ã€‚</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>N</mi><mi>x</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>N</mi><mi>y</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>N</mi><mi>z</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
R=(N_x+1)/2 \\
G=(N_y+1)/2 \\
B=(N_z+1)/2
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>æ³•çº¿è´´å›¾ä½¿ç”¨ä¸€ä¸ªå›¾åƒï¼ˆç§°ä¸ºæ³•çº¿å›¾ï¼‰æ–‡ä»¶ï¼Œè¯¥å›¾åƒæ–‡ä»¶åŒ…å«åœ¨å…‰ç…§ä¸‹æ‰€æœŸæœ›è¡¨é¢å¤–è§‚çš„æ³•å‘é‡ã€‚</p>
<ul>
<li>æ³•å‘é‡çš„ x å’Œ y åˆ†é‡è¡¨ç¤ºå…¶è¢«æ‰°åŠ¨åä¸â€œå‚ç›´â€æ–¹å‘çš„åå·®ï¼Œz åˆ†é‡è®¾ç½®ä¸º 1ã€‚</li>
<li>ä¸¥æ ¼å‚ç›´çš„å‘é‡ï¼ˆå³æ²¡æœ‰åå·®ï¼‰å°†è¡¨ç¤ºä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ã€‚</li>
</ul>
<p>ä½†å‘ç°å›¾æŸ¥æ‰¾åˆ°çš„æ³•å‘é‡ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºå¹¶æ²¡æœ‰è€ƒè™‘æ³•å‘é‡åœ¨ç‰©ä½“ä¸Šçš„ä½ç½®ä»¥åŠåœ¨ç›¸æœºç©ºé—´ç§çš„æ–¹å‘ã€‚</p>
<ul>
<li>å»ºç«‹è½¬æ¢çŸ©é˜µï¼Œå°†æ³•å‘é‡è½¬æ¢åˆ°ç›¸æœºç©ºé—´ã€‚</li>
</ul>
<p>åœ¨å¯¹è±¡é¡¶ç‚¹å‡ºï¼Œè€ƒè™‘å¯¹è±¡çš„åˆ‡å¹³é¢ï¼Œå–åˆ‡å¹³é¢ä¸¤ä¸ªç›¸äº’å‚ç›´çš„å‘é‡ï¼ˆåˆ‡å‘é‡å’Œå‰¯åˆ‡å‘é‡ï¼‰ï¼Œå¯ä»¥é€šè¿‡è®¡ç®—åˆ‡å‘é‡å’Œæ³•å‘é‡çš„å‰ç§¯æ„å»ºå‰¯åˆ‡å‘é‡ã€‚</p>
<ul>
<li>å¦‚æœæ¨¡å‹æ²¡æœ‰å®šä¹‰åˆ‡å‘é‡ï¼Œè¿˜éœ€è®¡ç®—åˆ‡å‘é‡ã€‚</li>
<li>å¯¹äºé‚£äº›è¡¨é¢æ— æ³•æ±‚å¯¼ã€æ— æ³•ç²¾ç¡®æ±‚è§£åˆ‡å‘é‡çš„æ¨¡å‹ï¼Œå…¶åˆ‡å‘é‡å¯ä»¥é€šè¿‡è¿‘ä¼¼å¾—åˆ°ã€‚</li>
</ul>
<p>åˆ‡å‘é‡ä¸€æ ·é€šè¿‡ VBO ä¼ é€’åˆ°é¡¶ç‚¹ç€è‰²å™¨ä¸­ã€‚</p>
<p>ä¸€æ—¦åœ¨ç›¸æœºç©ºé—´ä¸­å¾—åˆ°æ³•å‘é‡ã€åˆ‡å‘é‡å’Œå‰¯åˆ‡å‘é‡ï¼Œå°±å¯ä»¥æ„é€ çŸ©é˜µï¼ˆç§°ä¸º TBN çŸ©é˜µï¼‰ã€‚</p>
<ul>
<li>è¯¥çŸ©é˜µç”¨äºå°†ä»æ³•çº¿è´´å›¾ä¸­æ£€ç´¢åˆ°çš„æ³•å‘é‡è½¬æ¢ä¸ºåœ¨ç›¸æœºç©ºé—´ä¸­ç›¸å¯¹äºç‰©ä½“è¡¨é¢çš„æ³•å‘é‡ã€‚</li>
<li>åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ï¼Œæ–°æ³•å‘é‡çš„è®¡ç®—åœ¨ <code>calcNewNormal()</code> å‡½æ•°ä¸­å®Œæˆã€‚
<ul>
<li>è¯¥å‡½æ•°åŒ…å« <code>dot(tangent, normal)</code> çš„è®¡ç®—ç¡®ä¿åˆ‡å‘é‡å‚ç›´äºæ³•å‘é‡ã€‚æ–°çš„åˆ‡å‘é‡å’Œæ³•å‘é‡çš„å‰ç§¯å°±æ˜¯å‰¯åˆ‡å‘é‡ã€‚</li>
</ul>
</li>
</ul>
<p>åˆ¶ä½œæ³•çº¿å›¾å¯ä»¥é€šè¿‡ GIMP å’Œ PS ç­‰å·¥å…·å®Œæˆã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ³•çº¿è´´å›¾ä¾‹å­</th>
<th style="text-align:center">æ³•çº¿å›¾</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_normMap.jpg"></td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_normalMapping.jpg"></td>
</tr>
</tbody>
</table>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 5;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint mvLoc, projLoc, nLoc;

// å…‰æºå±æ€§
GLuint globalAmbLoc, ambLoc, diffLoc, specLoc, posLoc;
// æè´¨å±æ€§
GLuint mAmbLoc, mDifLoc, mSpecLoc, mShiLoc;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;
glm::vec3 currentLightPos, lightPosV;    // æ¨¡å‹å’Œè§†è§‰ç©ºé—´ä¸­çš„å…‰ç…§ä½ç½®
float lightPos[3];    // å…‰ç…§ä½ç½®çš„æµ®ç‚¹æ•°ç»„

// åˆå§‹åŒ–å…‰ç…§ä½ç½®
glm::vec3 initialLightLoc = glm::vec3(-5.0f, 2.0f, 5.0f);

// ç™½å…‰ç‰¹æ€§
float globalAmbient[4] = { 0.7f, 0.7f, 0.7f, 1.0f };
float lightAmbient[4] = { 0.0f, 0.0f, 0.0f, 1.0f };
float lightDiffuse[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightSpecular[4] = { 1.0f, 1.0f, 1.0f, 1.0f };

float *matAmb = Util::goldAmbient();
float *matDif = Util::goldDiffuse();
float *matSpe = Util::goldSpecular();
float matShi = Util::goldShininess();

Sphere model(48);
//Torus model(48, 0.5f, 0.2f);
//ImportedModel model("unicorn.obj");

GLuint texture;

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void installLights(glm::mat4 vMatrix)
{
	// å°†å…‰æºä½ç½®è½¬æ¢ä¸ºè§†å›¾ç©ºé—´åæ ‡ï¼Œå­˜å…¥æµ®ç‚¹æ•°ç»„
	lightPosV = glm::vec3(vMatrix * glm::vec4(currentLightPos, 1.0));
	lightPos[0] = lightPosV.x;
	lightPos[1] = lightPosV.y;
	lightPos[2] = lightPosV.z;

	// åœ¨ç€è‰²å™¨è·å–å…‰æºä½ç½®å’Œæè´¨å±æ€§
	globalAmbLoc = glGetUniformLocation(renderProgram, "globalAmbient");
	ambLoc = glGetUniformLocation(renderProgram, "light.ambient");
	diffLoc = glGetUniformLocation(renderProgram, "light.diffuse");
	specLoc = glGetUniformLocation(renderProgram, "light.specular");
	posLoc = glGetUniformLocation(renderProgram, "light.position");
	mAmbLoc = glGetUniformLocation(renderProgram, "material.ambient");
	mDifLoc = glGetUniformLocation(renderProgram, "material.diffuse");
	mSpecLoc = glGetUniformLocation(renderProgram, "material.specular");
	mShiLoc = glGetUniformLocation(renderProgram, "material.shininess");

	// åœ¨ç€è‰²å™¨ä¸­ä¸ºå…‰æºä¸æè´¨ç»Ÿä¸€å˜é‡èµ‹å€¼
	glProgramUniform4fv(renderProgram, globalAmbLoc, 1, globalAmbient);
	glProgramUniform4fv(renderProgram, ambLoc, 1, lightAmbient);
	glProgramUniform4fv(renderProgram, diffLoc, 1, lightDiffuse);
	glProgramUniform4fv(renderProgram, specLoc, 1, lightSpecular);
	glProgramUniform3fv(renderProgram, posLoc, 1, lightPos);
	glProgramUniform4fv(renderProgram, mAmbLoc, 1, matAmb);
	glProgramUniform4fv(renderProgram, mDifLoc, 1, matDif);
	glProgramUniform4fv(renderProgram, mSpecLoc, 1, matSpe);
	glProgramUniform1f(renderProgram, mShiLoc, matShi);
}

void makeVertexArray()
{
	std::vector&lt;int&gt; ind = model.getIndices();
	std::vector&lt;glm::vec3&gt; vert = model.getVertices();
	std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
	std::vector&lt;glm::vec3&gt; norm = model.getNormals();
	std::vector&lt;glm::vec3&gt; tang = model.getTangents();

	std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
	std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡
	std::vector&lt;float&gt; tanvalues;  // åˆ‡çº¿

	for (int i = 0; i &lt; model.getNumVertices(); ++ i)
	{
		pvalues.push_back(vert[i].x);
		pvalues.push_back(vert[i].y);
		pvalues.push_back(vert[i].z);
		tvalues.push_back(tex[i].s);
		tvalues.push_back(tex[i].t);
		nvalues.push_back(norm[i].x);
		nvalues.push_back(norm[i].y);
		nvalues.push_back(norm[i].z);
		tanvalues.push_back(tang[i].x);
		tanvalues.push_back(tang[i].y);
		tanvalues.push_back(tang[i].z);
	}

	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);

	glGenBuffers(numVBO, vbo);
	// é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
	// çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
	// æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
	// åˆ‡å‘é‡æ”¾å…¥ç¼“å†²åŒº3
	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glBufferData(GL_ARRAY_BUFFER, 4 * tanvalues.size(), &amp;tanvalues[0], GL_STATIC_DRAW);
	// é¡¶ç‚¹ç´¢å¼•æ”¾å…¥ç¼“å†²åŒº4
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[4]);
	glBufferData(GL_ELEMENT_ARRAY_BUFFER, 4 * ind.size(), &amp;ind[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
	renderProgram = Util::createShadeProgram("normalMap/vertex.glsl", "normalMap/fragment.glsl");
	cameraX = 0.0f, cameraY = 0.0f, cameraZ = 4.0f;

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();

	texture = Util::loadTexture("normalMap/castleroofNORMAL.jpg");
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);
	glUseProgram(renderProgram);

	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
	nLoc = glGetUniformLocation(renderProgram, "norm_matrix");

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
	mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, -1.0f));
	mMat = glm::rotate(mMat, 35.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));

	// åŸºäºå½“å‰å…‰æºä½ç½®ï¼Œåˆå§‹åŒ–å…‰ç…§
	currentLightPos = glm::vec3(initialLightLoc.x, initialLightLoc.y, initialLightLoc.z);
	installLights(vMat);

	mvMat = vMat * mMat;
	// æ„å»º MV çŸ©é˜µçš„é€†è½¬ç½®çŸ©é˜µï¼Œç”¨äºå˜æ¢æ³•å‘é‡
	invTrMat = glm::transpose(glm::inverse(mvMat));

	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(2);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[3]);
	glVertexAttribPointer(3, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(3);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, texture);

	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);
	//glDrawArrays(GL_TRIANGLES, 0, model.getNumVertices());
	// åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
	glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[4]);
	glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
	if (!glfwInit())    exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Bumps", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>çƒä½“ç±»æ–°å¢</summary>
<pre><code class="language-cpp">// Sphere.cpp
void Sphere::init(int _prec)
{
	numVertices = (_prec + 1) * (_prec + 1);
	numIndices = _prec * _prec * 6;
	for (int i = 0; i &lt; numVertices; ++ i)
	{
		vertices.push_back(glm::vec3());
		texCoords.push_back(glm::vec2());
		normals.push_back(glm::vec3());
		tangents.push_back(glm::vec3());
	}

	for (int i = 0; i &lt; numIndices; ++ i)
		indices.push_back(0);

	// è®¡ç®—ä¸‰è§’å½¢é¡¶ç‚¹
	for (int i = 0; i &lt;= _prec; ++ i)
		for (int j = 0; j &lt;= _prec; ++ j)
		{
			float y = static_cast&lt;float&gt;(cos(toRadians(180.0f - i * 180.0f / _prec)));
			float x = - static_cast&lt;float&gt;(cos(toRadians(j * 360.0f / _prec)) * fabs(cos(asin(y))));
			float z = static_cast&lt;float&gt;(sin(toRadians(j * 360.0f / _prec)) * fabs(cos(asin(y))));
			vertices[i * (_prec + 1) + j] = glm::vec3(x, y, z);
			// è®¡ç®—åˆ‡å‘é‡ï¼ˆæ–°å¢ï¼‰
			if (((x == 0) and (y == 1) and (z == 0)) or ((x == 0) and (y == -1) and (z == 0)))
				tangents[i * (_prec + 1) + j] = glm::vec3(0.0f, 0.0f, -1.0f);
			else
				tangents[i * (_prec + 1) + j] = glm::cross(glm::vec3(0.0f, 1.0f, 0.0f), glm::vec3(x, y, z));
            // æ–°å¢ä¸Šè¿°è®¡ç®—åˆ‡å‘é‡
			texCoords[i * (_prec + 1) + j] = glm::vec2(j * 1.0f / _prec, i * 1.0f / _prec);
			normals[i * (_prec + 1) + j] = glm::vec3(x, y, z);
		}
        // ...
}

std::vector&lt;glm::vec3&gt; Sphere::getTangents()
{
	return tangents;
}
</code></pre>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex.glsl
#version 460 core

struct PositionalLight
{
	vec4 ambient;
	vec4 diffuse;
	vec4 specular;
	vec3 position;
};

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec2 texCoord;
layout(location = 2) in vec3 vertNormal;
layout(location = 3) in vec3 vertTangent;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;
uniform mat4 norm_matrix;	// ç”¨äºå˜æ¢æ³•å‘é‡
uniform PositionalLight light;

out vec3 varyingLightDir;
out vec3 varyingVertPos;
out vec3 varyingNormal;
out vec3 varyingTangent;
out vec3 originalVertex;
out vec2 tc;
out vec3 varyingHalfVector;

void main()
{
	varyingVertPos = (mv_matrix * vec4(vertPos, 1.0)).xyz;
	varyingLightDir = light.position - varyingVertPos;
	tc = texCoord;

	originalVertex = vertPos;

	varyingNormal = (norm_matrix * vec4(vertNormal, 0.0)).xyz;
	varyingTangent = (norm_matrix * vec4(vertTangent, 0.0)).xyz;

	varyingHalfVector = normalize(normalize(varyingLightDir) + normalize(-varyingVertPos)).xyz;

	gl_Position = proj_matrix * mv_matrix * vec4(vertPos, 1.0);
}
</code></pre>
<pre><code class="language-glsl">// fragment.glsl
#version 460 core

struct PositionalLight
{
	vec4 ambient;
	vec4 diffuse;
	vec4 specular;
	vec3 position;
};

struct Material
{
	vec4 ambient;
	vec4 diffuse;
	vec4 specular;
	float shininess;
};

layout(binding = 0) uniform sampler2D nromsamp;

uniform vec4 globalAmbient;
uniform PositionalLight light;
uniform Material material;

in vec3 varyingLightDir;
in vec3 varyingNormal;
in vec3 varyingVertPos;
in vec3 varyingTangent;
in vec3 originalVertPos;
in vec2 tc;
in vec3 varyingHalfVector;

out vec4 fragColor;

vec3 calcNewNormal()
{
	vec3 normal = normalize(varyingNormal);
	vec3 tangent = normalize(varyingTangent);
	tangent = normalize(tangent - dot(tangent, normal) * normal);
	vec3 bitangent = cross(normal, tangent);
	mat3 tbn = mat3(tangent, bitangent, normal);
	vec3 retrievedNormal = texture(nromsamp, tc).xyz;
	vec3 newNormal = tbn * retrievedNormal;
	newNormal = normalize(newNormal);
	return newNormal;
}

void main()
{
	vec3 L = normalize(varyingLightDir);
	vec3 N = calcNewNormal();
	vec3 R = normalize(reflect(-L, N));
	vec3 H = normalize(varyingHalfVector);

	// è®¡ç®—å…‰ç…§ä¸å¹³é¢æ³•å‘é‡é—´çš„è§’åº¦
	float cosTheta = dot(L, N);
	// è®¡ç®—æ³•å‘é‡ N ä¸è§’å¹³åˆ†çº¿å‘é‡ H ä¹‹é—´çš„è§’åº¦
	float cosPhi = dot(H, N);

	fragColor = globalAmbient * material.ambient +
		light.ambient * material.ambient +
		light.diffuse * material.diffuse * max(0.0, cosTheta) +
		light.specular * material.specular * pow(max(0.0, cosPhi), material.shininess);
}
</code></pre>
</details>
<p>å¯ä»¥ä½¿ç”¨çº¹ç†åŠ æ³•çº¿è´´å›¾ï¼Œä½¿å¾—æ¨¡å‹æ›´é€¼çœŸã€‚</p>
<ul>
<li>æ³•çº¿è´´å›¾ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šçº§æ¸è¿œçº¹ç†è´´å›¾æ”¹å–„æ•ˆæœã€‚</li>
<li>æ³•çº¿è´´å›¾çš„å„å‘å¼‚æ€§è¿‡æ»¤æ›´æœ‰æ•ˆï¼Œå®ƒä¸ä½†å‡å°‘äº†é—ªçƒçš„ä¼ªå½±ï¼ŒåŒæ—¶è¿˜ä¿ç•™äº†ç»†èŠ‚ã€‚</li>
</ul>
<h3 id="10-3-é«˜åº¦è´´å›¾">10.3 é«˜åº¦è´´å›¾</h3>
<p>ä½¿ç”¨çº¹ç†å›¾åƒæ¥å­˜å‚¨é«˜åº¦å€¼ï¼Œç„¶åä½¿ç”¨è¯¥é«˜åº¦å€¼æ¥æå‡ï¼ˆæˆ–é™ä½ï¼‰é¡¶ç‚¹ä½ç½®ã€‚</p>
<ul>
<li>å«æœ‰é«˜åº¦ä¿¡æ¯çš„å›¾åƒç§°ä¸ºé«˜åº¦å›¾ã€‚</li>
</ul>
<p>ä½¿ç”¨é«˜åº¦å›¾æ›´æ”¹å¯¹è±¡çš„é¡¶ç‚¹çš„æ–¹æ³•ç§°ä¸ºé«˜åº¦è´´å›¾ã€‚</p>
<ul>
<li>é»‘è‰²ä¸ºé«˜åº¦ä½ï¼Œç™½è‰²ä¸ºé«˜åº¦é«˜ã€‚</li>
</ul>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_heightMap.jpg" alt="é«˜åº¦è´´å›¾"></p>
<p>ç”¨äºå±•ç¤ºçš„é«˜åº¦å›¾å’Œçº¹ç†å›¾å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">é«˜åº¦å›¾</th>
<th style="text-align:center">çº¹ç†å›¾</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_height.jpg"></td>
<td style="text-align:center"><img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/OpenGL_ice.jpg"></td>
</tr>
</tbody>
</table>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<details><summary>main.cpp</summary>
<pre><code class="language-cpp">#include &lt;iostream&gt;
// å¯¼å…¥ GLEW åº“
#include &lt;GL/glew.h&gt;
// å¯¼å…¥ GLFW åº“
#include &lt;GLFW/glfw3.h&gt;
// å¯¼å…¥ GLM åº“
#include &lt;glm/glm.hpp&gt;

#include "Util.h"
#include &lt;stack&gt;
#include "Sphere.h"
#include "Torus.h"
#include "ImportedModel.h"

GLuint renderProgram;

const int numVAO = 1, numVBO = 3;
GLuint vao[numVAO], vbo[numVBO];

int width, height;
float aspect;

double cameraX, cameraY, cameraZ;
GLuint mvLoc, projLoc, nLoc;

// å…‰æºå±æ€§
GLuint globalAmbLoc, ambLoc, diffLoc, specLoc, posLoc;
// æè´¨å±æ€§
GLuint mAmbLoc, mDifLoc, mSpecLoc, mShiLoc;

glm::mat4 pMat, vMat, mMat, mvMat, invTrMat;
glm::vec3 currentLightPos, lightPosV;    // æ¨¡å‹å’Œè§†è§‰ç©ºé—´ä¸­çš„å…‰ç…§ä½ç½®
float lightPos[3];    // å…‰ç…§ä½ç½®çš„æµ®ç‚¹æ•°ç»„

// åˆå§‹åŒ–å…‰ç…§ä½ç½®
glm::vec3 initialLightLoc = glm::vec3(-5.0f, 2.0f, 5.0f);

// ç™½å…‰ç‰¹æ€§
float globalAmbient[4] = { 0.7f, 0.7f, 0.7f, 1.0f };
float lightAmbient[4] = { 0.0f, 0.0f, 0.0f, 1.0f };
float lightDiffuse[4] = { 1.0f, 1.0f, 1.0f, 1.0f };
float lightSpecular[4] = { 1.0f, 1.0f, 1.0f, 1.0f };

float *matAmb = Util::goldAmbient();
float *matDif = Util::goldDiffuse();
float *matSpe = Util::goldSpecular();
float matShi = Util::goldShininess();

//Sphere model(48);
//Torus model(48, 0.5f, 0.2f);
ImportedModel model("heightMap/grid.obj");

GLuint heightMap;
GLuint texture;

static void windowSizeCallback(GLFWwindow *window, int width, int height)
{
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	glViewport(0, 0, width, height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);
}

void installLights(glm::mat4 vMatrix)
{
	// å°†å…‰æºä½ç½®è½¬æ¢ä¸ºè§†å›¾ç©ºé—´åæ ‡ï¼Œå­˜å…¥æµ®ç‚¹æ•°ç»„
	lightPosV = glm::vec3(vMatrix * glm::vec4(currentLightPos, 1.0));
	lightPos[0] = lightPosV.x;
	lightPos[1] = lightPosV.y;
	lightPos[2] = lightPosV.z;

	// åœ¨ç€è‰²å™¨è·å–å…‰æºä½ç½®å’Œæè´¨å±æ€§
	globalAmbLoc = glGetUniformLocation(renderProgram, "globalAmbient");
	ambLoc = glGetUniformLocation(renderProgram, "light.ambient");
	diffLoc = glGetUniformLocation(renderProgram, "light.diffuse");
	specLoc = glGetUniformLocation(renderProgram, "light.specular");
	posLoc = glGetUniformLocation(renderProgram, "light.position");
	mAmbLoc = glGetUniformLocation(renderProgram, "material.ambient");
	mDifLoc = glGetUniformLocation(renderProgram, "material.diffuse");
	mSpecLoc = glGetUniformLocation(renderProgram, "material.specular");
	mShiLoc = glGetUniformLocation(renderProgram, "material.shininess");

	// åœ¨ç€è‰²å™¨ä¸­ä¸ºå…‰æºä¸æè´¨ç»Ÿä¸€å˜é‡èµ‹å€¼
	glProgramUniform4fv(renderProgram, globalAmbLoc, 1, globalAmbient);
	glProgramUniform4fv(renderProgram, ambLoc, 1, lightAmbient);
	glProgramUniform4fv(renderProgram, diffLoc, 1, lightDiffuse);
	glProgramUniform4fv(renderProgram, specLoc, 1, lightSpecular);
	glProgramUniform3fv(renderProgram, posLoc, 1, lightPos);
	glProgramUniform4fv(renderProgram, mAmbLoc, 1, matAmb);
	glProgramUniform4fv(renderProgram, mDifLoc, 1, matDif);
	glProgramUniform4fv(renderProgram, mSpecLoc, 1, matSpe);
	glProgramUniform1f(renderProgram, mShiLoc, matShi);
}

void makeVertexArray()
{
	std::vector&lt;glm::vec3&gt; vert = model.getVertices();
	std::vector&lt;glm::vec2&gt; tex = model.getTexCoords();
	std::vector&lt;glm::vec3&gt; norm = model.getNormals();

	std::vector&lt;float&gt; pvalues;    // é¡¶ç‚¹ä½ç½®
	std::vector&lt;float&gt; tvalues;    // çº¹ç†åæ ‡
	std::vector&lt;float&gt; nvalues;    // æ³•å‘é‡

	for (int i = 0; i &lt; model.getNumVertices(); ++ i)
	{
		pvalues.push_back(vert[i].x);
		pvalues.push_back(vert[i].y);
		pvalues.push_back(vert[i].z);
		tvalues.push_back(tex[i].s);
		tvalues.push_back(tex[i].t);
		nvalues.push_back(norm[i].x);
		nvalues.push_back(norm[i].y);
		nvalues.push_back(norm[i].z);
	}

	glGenVertexArrays(numVAO, vao);
	glBindVertexArray(vao[0]);

	glGenBuffers(numVBO, vbo);
	// é¡¶ç‚¹åæ ‡æ”¾å…¥ç¼“å†²åŒº0
	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glBufferData(GL_ARRAY_BUFFER, 4 * pvalues.size(), &amp;pvalues[0], GL_STATIC_DRAW);
	// çº¹ç†åæ ‡æ”¾å…¥ç¼“å†²åŒº1
	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glBufferData(GL_ARRAY_BUFFER, 4 * tvalues.size(), &amp;tvalues[0], GL_STATIC_DRAW);
	// æ³•å‘é‡æ”¾å…¥ç¼“å†²åŒº2
	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glBufferData(GL_ARRAY_BUFFER, 4 * nvalues.size(), &amp;nvalues[0], GL_STATIC_DRAW);
}

void init(GLFWwindow *window)
{
	renderProgram = Util::createShadeProgram("heightMap/vertex.glsl", "heightMap/fragment.glsl");
	cameraX = 0.03f; cameraY = 0.03f; cameraZ = 0.8f;

	glfwGetFramebufferSize(window, &amp;width, &amp;height);
	aspect = static_cast&lt;float&gt;(width) / static_cast&lt;float&gt;(height);
	pMat = glm::perspective(1.0472f, aspect, 0.1f, 1000.0f);

	makeVertexArray();

	texture = Util::loadTexture("textureImg/ice.jpg");
	heightMap = Util::loadTexture("heightMap/height.jpg");
}

void display(GLFWwindow *window, double currentTime)
{
	glClear(GL_DEPTH_BUFFER_BIT);
	glClear(GL_COLOR_BUFFER_BIT);
	glUseProgram(renderProgram);

	mvLoc = glGetUniformLocation(renderProgram, "mv_matrix");
	projLoc = glGetUniformLocation(renderProgram, "proj_matrix");
	nLoc = glGetUniformLocation(renderProgram, "norm_matrix");

	vMat = glm::translate(glm::mat4(1.0f), glm::vec3(-cameraX, -cameraY, -cameraZ));
	mMat = glm::translate(glm::mat4(1.0f), glm::vec3(0.0f, 0.0f, 0.0f));
	mMat = glm::rotate(mMat, 15.0f * 3.14159f / 180.0f, glm::vec3(1.0f, 0.0f, 0.0f));

	// åŸºäºå½“å‰å…‰æºä½ç½®ï¼Œåˆå§‹åŒ–å…‰ç…§
	currentLightPos = glm::vec3(initialLightLoc.x, initialLightLoc.y, initialLightLoc.z);
	installLights(vMat);

	mvMat = vMat * mMat;
	// æ„å»º MV çŸ©é˜µçš„é€†è½¬ç½®çŸ©é˜µï¼Œç”¨äºå˜æ¢æ³•å‘é‡
	invTrMat = glm::transpose(glm::inverse(mvMat));

	glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(pMat));
	glUniformMatrix4fv(mvLoc, 1, GL_FALSE, glm::value_ptr(mvMat));
	glUniformMatrix4fv(nLoc, 1, GL_FALSE, glm::value_ptr(invTrMat));

	glBindBuffer(GL_ARRAY_BUFFER, vbo[0]);
	glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(0);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[1]);
	glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(1);

	glBindBuffer(GL_ARRAY_BUFFER, vbo[2]);
	glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE, 0, 0);
	glEnableVertexAttribArray(2);

	glActiveTexture(GL_TEXTURE0);
	glBindTexture(GL_TEXTURE_2D, texture);

	glActiveTexture(GL_TEXTURE1);
	glBindTexture(GL_TEXTURE_2D, heightMap);

	glEnable(GL_DEPTH_TEST);
	glDepthFunc(GL_LEQUAL);
	glDrawArrays(GL_TRIANGLES, 0, model.getNumVertices());
	// åˆ©ç”¨ç´¢å¼• vbo3 æ¥æŸ¥æ‰¾è¦ç»˜åˆ¶çš„é¡¶ç‚¹
	//glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbo[4]);
	//glDrawElements(GL_TRIANGLES, model.getNumIndices(), GL_UNSIGNED_INT, 0);
}

int main()
{
	if (!glfwInit())    exit(EXIT_FAILURE);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 4);
	glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 6);
	GLFWwindow *window = glfwCreateWindow(800, 600, "Bumps", NULL, NULL);
	glfwMakeContextCurrent(window);
	if (glewInit() != GLEW_OK)    exit(EXIT_FAILURE);
	glfwSwapInterval(1);

	glfwSetWindowSizeCallback(window, windowSizeCallback);

	init(window);

	while (!glfwWindowShouldClose(window))
	{
		display(window, glfwGetTime());
		glfwSwapBuffers(window);
		glfwPollEvents();
	}
	glfwDestroyWindow(window);
	glfwTerminate();

	return 0;
}
</code></pre>
</details>
<details><summary>é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨</summary>
<pre><code class="language-glsl">// vertex.glsl
#version 430

layout(location = 0) in vec3 vertPos;
layout(location = 1) in vec2 texCoord;
layout(location = 2) in vec3 vertNormal;

layout(binding = 1) uniform sampler2D h; // é«˜åº¦å›¾

out vec2 tc;

uniform mat4 mv_matrix;
uniform mat4 proj_matrix;

void main()
{
	vec4 p = vec4(vertPos, 1.0) + vec4((vertNormal * ((texture(h, texCoord).r) / 5.0f)), 1.0f);
	tc = texCoord;
	gl_Position = proj_matrix * mv_matrix * p;
}
</code></pre>
<pre><code class="language-glsl">// fragment.glsl
#version 460 core

in vec2 tc;
out vec4 fragColor;

layout(binding = 0)  uniform sampler2D t;	// çº¹ç†

void main()
{
	fragColor = texture(t, tc);
}
</code></pre>
</details>
<p>å‡¹å‡¸è´´å›¾æˆ–æ³•çº¿è´´å›¾çš„ä¸€ä¸ªåŸºæœ¬é™åˆ¶æ˜¯ï¼š</p>
<ul>
<li>è™½ç„¶èƒ½å¤Ÿåœ¨æ‰€æ¸²æŸ“å¯¹è±¡çš„å†…éƒ¨æä¾›è¡¨é¢ç»†èŠ‚ï¼Œ</li>
<li>ä½†æ˜¯ç‰©ä½“è½®å»“ï¼ˆå¤–è¾¹ç•Œï¼‰æ— æ³•æ˜¾ç¤ºè¿™äº›ç»†èŠ‚ï¼ˆä»ä¿æŒå¹³æ»‘ï¼‰ã€‚</li>
</ul>
<p>é«˜åº¦è´´å›¾åœ¨ç”¨äºå®é™…ä¿®æ”¹é¡¶ç‚¹ä½ç½®æ—¶ä¿®å¤äº†è¿™ä¸ªç¼ºé™·ï¼Œä½†å®ƒä¹Ÿæœ‰å…¶è‡ªèº«çš„å±€é™æ€§ã€‚</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-01-09</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Fingsinz</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/C/'>
                            C++
                        </a>
                    
                        <a href='/tags/OpenGL/'>
                            OpenGL
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E7%AC%94%E8%AE%B0/'>
                            ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            Â©2023-2024 

            
                

            
                
                    / <a href="/"> Fingsinz&#39;s Space </a>
                

            
                
                    / <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/fingsinz"> çŸ¥ä¹ </a>
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆã€‚</span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    
    
    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>


    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>


</html>