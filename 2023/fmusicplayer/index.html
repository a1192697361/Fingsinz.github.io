<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="åŸºäºQtçš„éŸ³é¢‘æ’­æ”¾å™¨ç¨‹åºè®¾è®¡è®°å½•" />
    <meta name="hexo-theme-A4" content="v1.8.3" />
    <link rel="alternate icon" type="image/webp" href="/images/icon1.webp">
    <title>Fingsinz&#39;s space | é£ä¿¡æ¢“</title>

    
        
<link rel="stylesheet" href="/css/a11y-dark.min.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    
    

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
    
    <style>
        :root {
            --waline-theme-color: #000000; 
            --waline-color: #000000; 
            --waline-border-color: #000000; 
            --waline-white: #000000; 
            --waline-bgcolor-light: white;  
        }
        body {
            color: #000000;
            background: #bed2bb;
        }
        .post-md code {
            background: #e7f7f3;
            color: #7f688d; 
        }
        .year-font-color {
            color: #000000 !important;
        }
        .wl-card span.wl-nick {
            color: #000000; 
        }
        .wl-card .wl-badge {
            border: 1px solid #000000;
            color: #000000; 
        }
        .wl-btn {
            border: 1px solid #000000; 
            color:  #000000;  
        }
        .wl-btn.primary {
            color: white; 
        }
        .wl-header label {
            color: #000000;
        }
        a {
            color: #6b798e;
        }

        .post-md a {
            color: #6b798e;
        }

        .nav li a {
            color: #6b798e;
        }

        .archive-main a:link {
            color: #6b798e;
        }
        .archive-main a:visited {
            color: #6b798e; 
        }

        .archive li span {
            color: #000000;
        }

        .post-main-title {
            color: #000000;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #000000;
        }

        [data-waline] p {
            color: #000000;
        }
        [data-waline] a {
            color: #000000;
        } 
        .wl-sort li.active {
            color: #000000;
        }

        .wl-card .wl-meta>span {
            background: white;
        }

        .paper {
            background: #bed2bb;
        }

        .index-main {
            background: white;
        }

        .paper-main {
            background: white;
        }

        .wl-panel {
            background: white;
        }

        .archive li:nth-child(odd) {
            background: white;
            ;
        }

        .archive li:nth-child(even) {
            background: white;
        }

        .post-md>table tr:nth-child(odd) td {
            background: white;
        }

        .post-md>table tr:nth-child(even) td {
            background: white;
        }

    
        .progress-wrap::after {
            color: #000000; /* ç®­å¤´çš„é¢œè‰² */
        }
        .progress-wrap svg.progress-circle path {
	        stroke: #000000; /* è¾¹æ¡†çš„é¢œè‰² */
        }
        .progress-wrap::before {
	        background-image: linear-gradient(298deg, #6b798e, #6b798e); /* é¼ æ ‡æ»‘è¿‡çš„ç®­å¤´é¢œè‰² */
         }

         .left-toc-container::-webkit-scrollbar-thumb {
            background-color: #000000; /* è®¾ç½®æ»šåŠ¨æ¡æ‹–åŠ¨å—çš„é¢œè‰² */
        }

        .bs-docs-sidebar .nav>.active>a,
        .bs-docs-sidebar .nav>li>a:hover,
        .bs-docs-sidebar .nav>li>a:focus {
            color: #6b798e;
            border-left-color: #6b798e;
        }
        .bs-docs-sidebar .nav>li>a {
            color:  #000000;
        }
    </style>

    
    <body>
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Fingsinz&#39;s space</a> 
            <span class="description">ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆ</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µğŸšï¸</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« ğŸ“„</a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»ğŸ—‚ï¸</a></li>
            
        
            
                <li><a href="/about/">å…³äºğŸ§‘</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            åŸºäºQtçš„éŸ³é¢‘æ’­æ”¾å™¨ç¨‹åºè®¾è®¡è®°å½•
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link"><span class="post-toc-text">ä¸€ã€å‰è¨€</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link"><span class="post-toc-text">äºŒã€æ¨¡å—æ„æ€</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link"><span class="post-toc-text">ä¸‰ã€æ¨¡å—å®ç°</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-1-%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1"><span class="post-toc-text">3.1 ç•Œé¢è®¾è®¡</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-1-%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B7%A5%E7%A8%8B"><span class="post-toc-text">3.1 åˆå§‹åŒ–å·¥ç¨‹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-3-%E6%92%AD%E6%94%BE-%E6%9A%82%E5%81%9C%E6%A8%A1%E5%9D%97"><span class="post-toc-text">3.3 æ’­æ”¾&#x2F;æš‚åœæ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-4-%E5%81%9C%E6%AD%A2%E6%A8%A1%E5%9D%97"><span class="post-toc-text">3.4 åœæ­¢æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-5-%E6%8E%A7%E5%88%B6%E9%9F%B3%E9%A2%91%E8%BF%9B%E5%BA%A6%E6%A8%A1%E5%9D%97"><span class="post-toc-text">3.5 æ§åˆ¶éŸ³é¢‘è¿›åº¦æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-6-%E7%AE%A1%E7%90%86%E9%9F%B3%E4%B9%90%E5%88%97%E8%A1%A8%E6%A8%A1%E5%9D%97"><span class="post-toc-text">3.6 ç®¡ç†éŸ³ä¹åˆ—è¡¨æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-7-%E9%9F%B3%E9%87%8F%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9D%97"><span class="post-toc-text">3.7 éŸ³é‡æ§åˆ¶æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-8-%E4%BF%A1%E6%81%AF%E6%98%BE%E7%A4%BA%E4%B8%8E%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%9D%97"><span class="post-toc-text">3.8 ä¿¡æ¯æ˜¾ç¤ºä¸åŒæ­¥æ¨¡å—</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link"><span class="post-toc-text">å››ã€æ€»ç»“</span></a></li></ol>
            
        
        <p>ä½¿ç”¨Qtçš„å·¥å…·å®Œæˆä¸€ä¸ªéŸ³é¢‘æ’­æ”¾å™¨â€”â€”FMusicPlayer</p>
<p>å…³é”®è¯ï¼šQtã€C++</p>
<span id="more"></span>
<hr>
<h1>ä¸€ã€å‰è¨€</h1>
<p>åˆ©ç”¨Qtçš„å·¥å…·å¼€å‘ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨ï¼Œç•Œé¢å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://fblog-img.oss-cn-hangzhou.aliyuncs.com/blog/fmusicplayer_ui.jpg" alt="ç•Œé¢æˆªå›¾"></p>
<p>Qtç‰ˆæœ¬5.12.12ã€‚è¯¥é¡¹ç›®ååˆ†ç®€å•ï¼Œé€‚åˆç”¨äºç»ƒæ‰‹ã€‚</p>
<h1>äºŒã€æ¨¡å—æ„æ€</h1>
<p>æ ¹æ®å¸‚åœºä¸Šç°æœ‰çš„éŸ³ä¹æ’­æ”¾å™¨æ€è€ƒï¼Œä¸€ä¸ªåŸºæœ¬çš„éŸ³ä¹æ’­æ”¾å™¨åº”è¯¥å…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>
<p>æ’­æ”¾/æš‚åœ</p>
</li>
<li>
<p>åœæ­¢</p>
</li>
<li>
<p>æ§åˆ¶éŸ³é¢‘æ’­æ”¾è¿›åº¦</p>
</li>
<li>
<p>ç®¡ç†éŸ³ä¹åˆ—è¡¨</p>
</li>
<li>
<p>éŸ³é‡æ§åˆ¶</p>
</li>
<li>
<p>ä¿¡æ¯æ˜¾ç¤º</p>
</li>
<li>
<p>â€¦â€¦</p>
</li>
</ul>
<p>æ­¤è½¯ä»¶ä»…å®ç°äº†ä¸Šè¿°åŠŸèƒ½ã€‚</p>
<h1>ä¸‰ã€æ¨¡å—å®ç°</h1>
<p>æ­¤éŸ³ä¹æ’­æ”¾å™¨ä¸»è¦ä½¿ç”¨Qtç°æˆçš„QMediaPlayerç±»å’ŒQMediaPlaylistç±»è¿›è¡Œç»´æŠ¤ã€‚</p>
<h2 id="3-1-ç•Œé¢è®¾è®¡">3.1 ç•Œé¢è®¾è®¡</h2>
<p>æ•´ä½“ç•Œé¢è®¾è®¡å¦‚å›¾ï¼š</p>
<p><img src="https://fblog-img.oss-cn-hangzhou.aliyuncs.com/blog/fmusicplayer_uidesign.jpg" alt="ç•Œé¢è®¾è®¡"></p>
<ul>
<li>
<p>9ä¸ªæŒ‰é’®QPushButtonï¼Œå¯¹åº”å„ç§åŠŸèƒ½ï¼›</p>
</li>
<li>
<p>3ä¸ªæ ‡ç­¾æ–‡å­—QLabelï¼Œç”¨äºè¯´æ˜ï¼›</p>
</li>
<li>
<p>2ä¸ªæ–‡æœ¬æ¡†QLineEditï¼Œç”¨äºæ˜¾ç¤ºä¿¡æ¯ï¼›</p>
</li>
<li>
<p>1ä¸ªåˆ—è¡¨QListWidgetï¼Œç”¨äºå­˜æ”¾æ’­æ”¾åˆ—è¡¨ï¼›</p>
</li>
<li>
<p>2ä¸ªæ»‘æ¡QSliderï¼Œä¸€ä¸ªç”¨äºæ§åˆ¶å’Œæ˜¾ç¤ºè¿›åº¦ï¼Œä¸€ä¸ªç”¨äºæ§åˆ¶å’Œæ˜¾ç¤ºéŸ³é‡ã€‚</p>
</li>
<li>
<p>è‹¥å¹²ä¸ªå¼¹ç°§ç”¨äºè°ƒæ•´å¸ƒå±€ã€‚</p>
</li>
</ul>
<p>å®Œæˆåçš„ç¨‹åºç•Œé¢ï¼š</p>
<p><img src="https://fblog-img.oss-cn-hangzhou.aliyuncs.com/blog/fmusicplayer_ui2.jpg" alt="æœŸæœ›çš„UI"></p>
<h2 id="3-1-åˆå§‹åŒ–å·¥ç¨‹">3.1 åˆå§‹åŒ–å·¥ç¨‹</h2>
<p>æ­¤ç¨‹åºä½¿ç”¨äº†Qtçš„multimediaéƒ¨ä»¶ï¼Œæ‰€ä»¥é¦–å…ˆåœ¨Qtçš„.proå·¥ç¨‹æ–‡ä»¶ä¸­åŒ…å«multimediaã€‚</p>
<pre><code>â€¦â€¦
QT  += multimedia
â€¦â€¦
</code></pre>
<p>æ¥ç€é¡¹ç›®ä¸­åº”è¯¥æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<blockquote>
<p>mainwindow.h<br>
mainwindow.cpp<br>
mainwindow.ui<br>
main.cpp</p>
</blockquote>
<ul>
<li>
<p>mainwindow.hï¼šä¸»è¦å­˜æ”¾ä¸»çª—å£çš„ä¸€äº›å£°æ˜</p>
</li>
<li>
<p>mainwindow.cppï¼šè®°å½•ä¸»çª—å£çš„å®ç°</p>
</li>
<li>
<p>mainwindow.uiï¼šç•Œé¢çš„è®¾è®¡æ–‡ä»¶</p>
</li>
<li>
<p>main.cppï¼šç¨‹åºå…¥å£</p>
</li>
</ul>
<p>é¦–å…ˆåœ¨mainwindow.hä¸­å°†æˆ‘ä»¬å®ç°çš„æ¨¡å—æ·»åŠ æ§½å‡½æ•°å£°æ˜å’Œæˆå‘˜å˜é‡çš„å£°æ˜ï¼š</p>
<pre><code class="language-cpp">QMediaPlayer *musicplayer; // æ’­æ”¾å™¨
QMediaPlaylist *musicplayList; // æ’­æ”¾åˆ—è¡¨

QString durationTime;// éŸ³é¢‘æ€»é•¿åº¦
QString  positionTime;// å½“å‰æ’­æ”¾åˆ°ä½ç½®
// æ§½å‡½æ•°å£°æ˜ç•¥ï¼Œè§æºä»£ç 
</code></pre>
<p>æ¥ç€åœ¨ä¸»çª—å£æ„é€ å‡½æ•°ä¸­åšä¸€äº›åˆå§‹åŒ–ï¼š</p>
<pre><code class="language-cpp">// åˆ›å»ºå®ä¾‹
musicplayer = new QMediaPlayer(this);
musicplayList = new QMediaPlaylist(this);

// å¾ªç¯æ’­æ”¾
musicplayList-&gt;setPlaybackMode(QMediaPlaylist::Loop);
musicplayer-&gt;setPlaylist(musicplayList);

// é»˜è®¤éŸ³é‡ï¼ŒåŒæ­¥éŸ³é‡æ˜¾ç¤º
ui-&gt;volume-&gt;setValue(50);	
changedVolume(50);			
</code></pre>
<h2 id="3-3-æ’­æ”¾-æš‚åœæ¨¡å—">3.3 æ’­æ”¾/æš‚åœæ¨¡å—</h2>
<p>å½“ç‚¹å‡»æ’­æ”¾é”®æ—¶æ’­æ”¾éŸ³ä¹ï¼Œä¸ºæ’­æ”¾æŒ‰é’®playç»‘å®šå•å‡»äº‹ä»¶ï¼Œè§¦å‘playMusic()å‡½æ•°ï¼š</p>
<pre><code class="language-cpp">// æ’­æ”¾éŸ³ä¹
connect(ui-&gt;play, SIGNAL(clicked()), this, SLOT(playMusic()));
</code></pre>
<pre><code class="language-cpp">void MainWindow::playMusic()//æ’­æ”¾
{
    // ç»´æŠ¤æ’­æ”¾åˆ—è¡¨ï¼Œä½¿å…¶ç´¢å¼•æ­£å¸¸ï¼Œæ­£å¸¸æ’­æ”¾
    if(musicplayList-&gt;currentIndex()&lt;0)
        musicplayList-&gt;setCurrentIndex(0);
    musicplayer-&gt;play();
}
</code></pre>
<p>å½“ç‚¹å‡»æš‚åœé”®æ—¶æš‚åœéŸ³ä¹ï¼Œæ”¯æŒè®°å½•ä½ç½®ï¼Œä»ä¸Šæ¬¡æš‚åœçš„ä½ç½®æ’­æ”¾ã€‚ä¸ºæš‚åœæŒ‰é’®ç»‘å®šå•å‡»äº‹ä»¶ï¼Œè§¦å‘pauseMusic()å‡½æ•°ï¼š</p>
<pre><code class="language-cpp">// æš‚åœéŸ³ä¹
connect(ui-&gt;pause, SIGNAL(clicked()), this, SLOT(pauseMusic()));
</code></pre>
<pre><code class="language-cpp">void MainWindow::pauseMusic()//æš‚åœæ’­æ”¾
{
    musicplayer-&gt;pause();
}
</code></pre>
<h2 id="3-4-åœæ­¢æ¨¡å—">3.4 åœæ­¢æ¨¡å—</h2>
<p>å½“ç‚¹å‡»åœæ­¢é”®æ—¶ï¼Œåœæ­¢éŸ³ä¹ï¼ŒéŸ³ä¹æ’­æ”¾ä½ç½®å½’é›¶ã€‚ä¸ºåœæ­¢æŒ‰é’®ç»‘å®šå•å‡»äº‹ä»¶ï¼Œè§¦å‘stopMusic()å‡½æ•°ï¼š</p>
<pre><code class="language-cpp">// åœæ­¢éŸ³ä¹
connect(ui-&gt;stop, SIGNAL(clicked()), this, SLOT(stopMusic()));
</code></pre>
<pre><code class="language-cpp">void MainWindow::stopMusic()//åœæ­¢æ’­æ”¾
{
    musicplayer-&gt;stop();
}
</code></pre>
<h2 id="3-5-æ§åˆ¶éŸ³é¢‘è¿›åº¦æ¨¡å—">3.5 æ§åˆ¶éŸ³é¢‘è¿›åº¦æ¨¡å—</h2>
<p>æ’­æ”¾æ—¶ï¼ŒéŸ³é¢‘è¿›åº¦æ¡åº”å½“å¯ä»¥è¢«æ‹–åŠ¨ï¼Œå¹¶ä¸”æ›´æ–°æ’­æ”¾çš„ä½ç½®ã€‚ä¸ºè¿›åº¦æ¡ç»‘å®šå€¼ä¿®æ”¹äº‹ä»¶ï¼Œè§¦å‘changedPosition()å‡½æ•°ï¼Œå‡½æ•°å‚æ•°ä¸ºè¿›åº¦æ¡ä¼ å…¥çš„ä½ç½®å‚æ•°ã€‚</p>
<pre><code class="language-cpp">// è¿›åº¦æ¡æ§åˆ¶
connect(ui-&gt;timebar, SIGNAL(valueChanged(int)), this, SLOT(changedPosition(int)));
</code></pre>
<pre><code class="language-cpp">void MainWindow::changedPosition(int pos)   // ä¿®æ”¹æ’­æ”¾ä½ç½®
{
    musicplayer-&gt;setPosition(pos);
}
</code></pre>
<h2 id="3-6-ç®¡ç†éŸ³ä¹åˆ—è¡¨æ¨¡å—">3.6 ç®¡ç†éŸ³ä¹åˆ—è¡¨æ¨¡å—</h2>
<p>æ’­æ”¾å™¨åº”è¯¥å¯ä»¥è¾“å…¥å¤šä¸ªæ–‡ä»¶ï¼Œæ¥ç€é¡ºåºæ’­æ”¾ï¼Œæ‰€ä»¥éœ€è¦ç»´æŠ¤ä¸€ä¸ªéŸ³ä¹åˆ—è¡¨ã€‚</p>
<p>é¦–å…ˆå¯ä»¥å‘éŸ³ä¹åˆ—è¡¨æ·»åŠ éŸ³ä¹ï¼Œä¸ºæ·»åŠ éŸ³ä¹æŒ‰é’®ç»‘å®šå•å‡»äº‹ä»¶ï¼Œç»‘å®šaddMusic()å‡½æ•°ã€‚</p>
<pre><code class="language-cpp">// æ·»åŠ æ–‡ä»¶
connect(ui-&gt;addMusic, SIGNAL(clicked()), this, SLOT(addMusictoList()));
</code></pre>
<p>è¯»å–æ–‡ä»¶æ—¶ï¼Œwavæ–‡ä»¶æ˜¯æ”¯æŒçš„ï¼Œè€Œmp3æ–‡ä»¶éœ€è¦å¤–ç½®è§£ç å™¨çš„æ”¯æŒï¼Œå¤„ç†mp3æ–‡ä»¶æ–¹æ³•è§æ–‡ç« æœ€åã€‚</p>
<pre><code class="language-cpp">void MainWindow::addMusictoList()
{
    QString curPath = QDir::currentPath();
    QString title = "é€‰æ‹©éŸ³é¢‘æ–‡ä»¶";
    QString filter = "éŸ³é¢‘æ–‡ä»¶(*.wav *.mp3)";
    QStringList fileList = QFileDialog::getOpenFileNames(this, title, curPath, filter);

	// æ·»åŠ æ–‡ä»¶å°‘äº1ä¸ªæ—¶é€€å‡ºå‡½æ•°
    if(filter.count() &lt; 1)  return;
	// å°†è¯»å–çš„æ–‡ä»¶æ”¾å…¥musicplayListé‡Œ
    for(int i = 0; i &lt; fileList.count(); ++ i)
    {
        QString aFile = fileList.at(i);
        musicplayList-&gt;addMedia(QUrl::fromLocalFile(aFile));

        QFileInfo fileinfo(aFile);
        ui-&gt;playList-&gt;addItem(fileinfo.fileName());
    }
	// å°†éŸ³ä¹åˆ—è¡¨çš„ç¬¬ä¸€é¦–éŸ³é¢‘ä½œä¸ºå¾…æ’­æ”¾éŸ³é¢‘
    if(musicplayer-&gt;state() != QMediaPlayer::PlayingState)
        musicplayList-&gt;setCurrentIndex(0);
}
</code></pre>
<p>åŒæ ·è¿˜åº”æ”¯æŒç§»é™¤éŸ³é¢‘æ–‡ä»¶ï¼š</p>
<pre><code class="language-cpp">// ç§»é™¤æ–‡ä»¶
connect(ui-&gt;delMusic, SIGNAL(clicked()), this, SLOT(delMusic()));
</code></pre>
<p>ç§»é™¤æ–‡ä»¶æ—¶è¿˜åº”åˆ¤æ–­ç§»é™¤çš„æ˜¯å¦ä¸ºå½“å‰æ’­æ”¾éŸ³ä¹ï¼Œè¿›è¡Œç›¸åº”å¤„ç†ã€‚</p>
<pre><code class="language-cpp">void MainWindow::delMusic()
{
    int pos = ui-&gt;playList-&gt;currentRow(); // è·å–é€‰ä¸­è¡Œ
    QListWidgetItem *item = ui-&gt;playList-&gt;takeItem(pos);
    delete  item;


    if(musicplayList-&gt;currentIndex() == pos)// åˆ é™¤æ˜¯å½“å‰æ’­æ”¾çš„éŸ³ä¹æ—¶
    {
        int nextPos = 0;
        if(pos &gt;= 1)    nextPos = pos - 1;
        musicplayList-&gt;removeMedia(pos);
        if(ui-&gt;playList-&gt;count() &gt; 0)
        {
            musicplayList-&gt;setCurrentIndex(nextPos);
            onPlayListChanged(nextPos);
        }
        else
        {
            musicplayer-&gt;stop();
            ui-&gt;playmusic-&gt;setText("æ— æ–‡ä»¶");
        }
    }
    else
        musicplayList-&gt;removeMedia(pos);
}
</code></pre>
<p>æ¸…ç©ºæ–‡ä»¶åˆ™æ˜¯ç§»é™¤æ–‡ä»¶çš„ç®€åŒ–ç‰ˆï¼Œç›´æ¥å°†æ’­æ”¾åˆ—è¡¨æ¸…ç©ºå³å¯ã€‚</p>
<pre><code class="language-cpp">// æ¸…ç©ºæ–‡ä»¶åˆ—è¡¨
connect(ui-&gt;clearList, SIGNAL(clicked()), this, SLOT(clearList()));
</code></pre>
<pre><code class="language-cpp">void MainWindow::clearList()
{
    musicplayList-&gt;clear();	// æ¸…ç©ºåˆ—è¡¨
    ui-&gt;playList-&gt;clear();	// æ›´æ–°UI
    ui-&gt;playmusic-&gt;clear();
    ui-&gt;time-&gt;clear();
    ui-&gt;timebar-&gt;setValue(0);
    musicplayer-&gt;stop();	// åœæ­¢æ’­æ”¾
}
</code></pre>
<p>æœ€åè¿˜å¯ä»¥æ·»åŠ ä¸Šä¸€é¦–å’Œä¸‹ä¸€é¦–çš„åŠŸèƒ½ï¼Œåªéœ€ç®€å•ç»‘å®šä¸€ä¸‹ç‚¹å‡»äº‹ä»¶å’Œè°ƒç”¨musicplayListçš„å‡½æ•°å³å¯ã€‚</p>
<pre><code class="language-cpp">musicplayList-&gt;previous();	// ä¸Šä¸€é¦–
musicplayList-&gt;next();		// ä¸‹ä¸€é¦–
</code></pre>
<h2 id="3-7-éŸ³é‡æ§åˆ¶æ¨¡å—">3.7 éŸ³é‡æ§åˆ¶æ¨¡å—</h2>
<p>ä¸€ä¸ªæ’­æ”¾å™¨è¿˜åº”è¯¥æ”¯æŒéŸ³é‡çš„è°ƒèŠ‚ï¼Œè€ŒQMediaPlayeræ”¯æŒéŸ³é‡è°ƒèŠ‚ï¼Œæ‰€ä»¥ç»‘å®šæ»‘æ¡å€¼æ”¹å˜äº‹ä»¶ä¸”è°ƒç”¨å‡½æ•°å³å¯ï¼Œäº‹ä»¶è¿”å›ä¸€ä¸ªæ»‘æ¡çš„ä½ç½®å‚æ•°ã€‚</p>
<pre><code class="language-cpp">// æ§åˆ¶éŸ³é‡
connect(ui-&gt;volume, SIGNAL(valueChanged(int)), this, SLOT(changedVolume(int)));
</code></pre>
<pre><code class="language-cpp">void MainWindow::changedVolume(int value)
{
    musicplayer-&gt;setVolume(value);
}
</code></pre>
<h2 id="3-8-ä¿¡æ¯æ˜¾ç¤ºä¸åŒæ­¥æ¨¡å—">3.8 ä¿¡æ¯æ˜¾ç¤ºä¸åŒæ­¥æ¨¡å—</h2>
<p>æ ¹æ®UIçš„è®¾è®¡ï¼Œæ˜¾ç¤ºçš„ä¿¡æ¯æœ‰ï¼šå½“å‰æ’­æ”¾çš„éŸ³é¢‘åå­—ã€æ’­æ”¾æ—¶é—´/å®Œæ•´æ—¶é—´ã€‚å½“æ’­æ”¾éŸ³é¢‘è¿›è¡Œåˆ‡æ¢æ—¶ï¼Œéœ€è¦æ›´æ–°éŸ³é¢‘åå­—ã€æ’­æ”¾æ—¶é—´å’ŒéŸ³é¢‘å®Œæ•´æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>
<p>ä¸ºæ’­æ”¾åˆ—è¡¨musicplayListçš„å½“å‰ç´¢å¼•å˜åŒ–äº‹ä»¶ç»‘å®šonPlayListChanged()å‡½æ•°ï¼Œäº‹ä»¶è¿”å›æ–°çš„ç´¢å¼•å·ï¼Œç”¨æ­¤æ›´æ–°æ’­æ”¾çš„éŸ³é¢‘åå­—ã€‚</p>
<pre><code class="language-cpp">// æ’­æ”¾éŸ³ä¹å˜åŒ–
connect(musicplayList, SIGNAL(currentIndexChanged(int)), this, SLOT(onPlayListChanged(int)));
</code></pre>
<pre><code class="language-cpp">void MainWindow::onPlayListChanged(int pos)
{
    ui-&gt;playList-&gt;setCurrentRow(pos);
    // ä½¿ç”¨QListWidgetItemç±»å–å‡ºQListWidgetçš„æŸä¸€è¡Œ
    QListWidgetItem *item = ui-&gt;playList-&gt;currentItem();
    if(item)
    {
		// æ›´æ–°UIçš„éŸ³é¢‘åå­—
        ui-&gt;playmusic-&gt;setText(item-&gt;text());
    }
}
</code></pre>
<p>åˆ‡æ¢éŸ³é¢‘æ—¶ï¼Œå…¶æ€»æ—¶é•¿ä¹Ÿåº”è¯¥å˜åŒ–ï¼Œéœ€è¦ä¸ºæ’­æ”¾å™¨musicplayerçš„æ’­æ”¾ä½ç½®å˜åŒ–durationChangedäº‹ä»¶ç»‘å®šonDurationChanged()å‡½æ•°ã€‚å‡½æ•°ä¸ºè®¡ç®—éŸ³é¢‘æ€»çš„æ—¶é—´ã€‚</p>
<pre><code class="language-cpp">// æ—¶é•¿å˜åŒ–
connect(musicplayer, SIGNAL(durationChanged(qint64)), this, SLOT(onDurationChanged(qint64)));
</code></pre>
<pre><code class="language-cpp">void MainWindow::onDurationChanged(qint64 dur)
{
    ui-&gt;timebar-&gt;setMaximum(dur);	// è®¾ç½®è¿›åº¦æ¡çš„æœ€å¤§å€¼

    int secs = int(dur / 1000);
    int mins = secs / 60;
    secs %= 60;
    durationTime = QString::asprintf(" %d : %d ", mins, secs);
    // UIåˆ·æ–°æ—¶é—´
    ui-&gt;time-&gt;setText(positionTime + " / " + durationTime);
}
</code></pre>
<p>è‡³äºéŸ³é¢‘éšç€æ’­æ”¾è€Œä½ç½®å’Œè¿›åº¦çš„åˆ·æ–°ï¼Œåˆ™éœ€è¦ä¸ºæ’­æ”¾å™¨musicplayerçš„æ’­æ”¾ä½ç½®å˜åŒ–positionChangedäº‹ä»¶ç»‘å®šonPositionChanged()å‡½æ•°ã€‚å‡½æ•°ä¸ºè®¡ç®—æ’­æ”¾çš„æ—¶é—´ã€‚</p>
<pre><code class="language-cpp">// æ’­æ”¾ä½ç½®å˜åŒ–
connect(musicplayer, SIGNAL(positionChanged(qint64)), this, SLOT(onPositionChanged(qint64)));
</code></pre>
<pre><code class="language-cpp">void MainWindow::onPositionChanged(qint64 pos)
{
	// è¿›åº¦æ¡æ»‘åŠ¨åˆ°å°½å¤´ï¼Œé€€å‡ºå‡½æ•°
    if(ui-&gt;timebar-&gt;isSliderDown()) return;

    ui-&gt;timebar-&gt;setSliderPosition(pos);
    // è®¡ç®—åˆ†å’Œç§’
    int secs = int (pos / 1000);
    int mins = secs / 60;
    secs %= 60;
    positionTime = QString::asprintf(" %d : %d ", mins, secs);
    // UIåˆ·æ–°æ—¶é—´
    ui-&gt;time-&gt;setText(positionTime + " / " + durationTime);
}
</code></pre>
<h1>å››ã€æ€»ç»“</h1>
<p>è¯¥ç¨‹åºæºä»£ç æ”¾åœ¨<a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/fmusicplayer/">Gitee - https://gitee.com/fingsinz/fmusicplayer/</a></p>
<p>è¯¥é¡¹ç›®åªæ˜¯ä¸€ä¸ªç®€å•çš„æ’­æ”¾å™¨å®ç°ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©èŒæ–°è®¤è¯†Qtï¼Œæé«˜è‡ªå·±çš„èƒ½åŠ›ã€‚</p>
<p>ä¸æ”¯æŒç›´æ¥åŠ è½½mp3æ–‡ä»¶ï¼Œéœ€è¦å…ˆä¸‹è½½ç›¸å…³è§£ç å™¨ã€‚æ­¤å¤„é™„ä¸Šè§£ç å™¨é“¾æ¥ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.codecguide.com/download_kl.htm">K-lite_codec_pack</a></p>
<p><a target="_blank" rel="noopener" href="https://www.codecguide.com/download_k-lite_codec_pack_basic.htm">K-lite_codec_pack_basicï¼ˆåŸºç¡€ç‰ˆï¼‰</a></p>
<p><a target="_blank" rel="noopener" href="https://www.codecguide.com/download_k-lite_codec_pack_standard.htm">K-lite_codec_pack_standardï¼ˆæ ‡å‡†ç‰ˆï¼‰</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-08-03</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Fingsinz</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/C/'>
                            C++
                        </a>
                    
                        <a href='/tags/Qt/'>
                            Qt
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E7%AC%94%E8%AE%B0/'>
                            ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            Â©2023-2024 

            
                

            
                
                    / <a href="/"> Fingsinz&#39;s Space </a>
                

            
                
                    / <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/fingsinz"> çŸ¥ä¹ </a>
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆã€‚</span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    
    
    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>


    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>


</html>